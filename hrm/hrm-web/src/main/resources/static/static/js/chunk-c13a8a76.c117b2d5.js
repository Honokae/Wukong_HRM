(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c13a8a76"],{"05b4":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container",staticStyle:{padding:"12px 12px 0"}},e._l(e.assessmentDimensionList,(function(t,i){return a("el-form",{key:t.key,ref:"form",refInFor:!0,attrs:{"validate-on-rule-change":!1,"hide-required-asterisk":"",model:e.tableForm,"label-width":"80px"}},[a("el-table",{key:+new Date,staticStyle:{"margin-top":"20px"},attrs:{data:e.tableForm["table"+t.key],stripe:"",border:""}},[a("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(n){return[a("div",{staticClass:"table-header"},[a("div",[a("span",{staticClass:"table-header-title"},[e._v(e._s(t.dimensionName))]),e._v(" "),a("span",{staticClass:"table-header-title"},[e._v(e._s(1==t.quotaType?"业绩指标":"行为态度指标"))]),e._v(" "),a("span",{staticClass:"table-header-title"},[e._v("维度权重"),a("span",{staticStyle:{color:"#ffb55f"}},[e._v(e._s(t.dimensionWeight)+"%")])])]),e._v(" "),e.operation?e._e():a("div",[a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(t){e.editAssess(i)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(a){e.deleteAssess(i,t.key)}}},[e._v("删除")])],1)])]}}])},[e._l(e.fieldList,(function(i,n){return a("el-table-column",{key:n,attrs:{prop:i.fieldName,label:i.name},scopedSlots:e._u([{key:"header",fn:function(t){return["quotaName"==i.fieldName||"standard"==i.fieldName||"quotaWeight"==i.fieldName?a("span",{staticStyle:{color:"#ff7330"}},[e._v("*")]):e._e(),e._v(e._s(i.name)+"\n          ")]}},{key:"default",fn:function(n){var l=n.row,s=n.$index;return[e.tableForm["table"+t.key]&&e.tableForm["table"+t.key].length==s+1&&"quotaName"==i.fieldName?a("el-button",{attrs:{type:"text",disabled:e.combinedWeights(t.key)>99||e.disabled||!t.isAllowEdit&&e.operation},on:{click:function(a){e.handlerCreate(t.key)}}},[e._v("+新建指标项")]):e._e(),e._v(" "),e.tableForm["table"+t.key]&&e.tableForm["table"+t.key].length==s+1&&"quotaWeight"==i.fieldName?a("span",{style:e.combinedWeights(t.key)>100?"color:red":"color:#ffb55f"},[e._v("\n              "+e._s(e.combinedWeights(t.key)||"")),e.combinedWeights(t.key)?a("span",[e._v("%")]):e._e()]):e._e(),e._v(" "),"text"==i.formType&&e.tableForm["table"+t.key]&&e.tableForm["table"+t.key].length!=s+1?a("el-form-item",{attrs:{prop:"table"+t.key+"["+s+"]."+i.fieldName,rules:i.rules||{}}},[a("el-input",{attrs:{disabled:e.disabled||l.preset,type:"quotaName"!=i.fieldName?"textarea":"",autosize:"quotaName"!=i.fieldName,maxlength:i.max,resize:"none"},model:{value:l[i.fieldName],callback:function(t){e.$set(l,i.fieldName,t)},expression:"row[child.fieldName]"}})],1):e._e(),e._v(" "),"percent"==i.formType&&e.tableForm["table"+t.key]&&e.tableForm["table"+t.key].length!=s+1?a("el-form-item",{attrs:{prop:"table"+t.key+"["+s+"]."+i.fieldName,rules:{required:!0,message:"请输入",trigger:"blur"}}},[a("wk-percent-input",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled||l.preset,max:i.max,min:i.min,controls:!1},model:{value:l[i.fieldName],callback:function(t){e.$set(l,i.fieldName,t)},expression:"row[child.fieldName]"}})],1):"select"==i.formType&&e.tableForm["table"+t.key]&&e.tableForm["table"+t.key].length!=s+1?a("el-form-item",{attrs:{prop:"table"+t.key+"["+s+"]."+i.fieldName}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disabled||l.preset},model:{value:l[i.fieldName],callback:function(t){e.$set(l,i.fieldName,t)},expression:"row[child.fieldName]"}},e._l(i.setting,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})))],1):e._e()]}}])})})),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(i){var n=i.row,l=i.scope,s=i.$index;return[e.tableForm["table"+t.key].length!=s+1?a("el-button",{attrs:{type:"text",disabled:e.disabled||n.preset},on:{click:function(a){e.handlerDel(l,s,t.key)}}},[e._v("删除")]):e._e()]}}])})],2)],1),e._v(" "),a("el-form")],1)})))},n=[],l=(a("d3b7"),a("159b"),a("b64b"),a("a434"),a("371f")),s={name:"AssessmentDimension",components:{WkPercentInput:l["a"]},inject:{disabled:{default:!1}},props:{assessmentDimensionList:Array,quotaItem:Object,operation:Boolean},data:function(){return{fieldList:[{fieldName:"quotaName",name:"指标名称",formType:"text",max:50,rules:{required:!0,message:"请输入",trigger:"blur"}},{fieldName:"quotaIllustrate",name:"指标说明",formType:"text",max:200,rules:{max:200,message:"最多输入200个字符",trigger:"blur"}},{fieldName:"standard",name:"考核标准",formType:"text",max:200,rules:[{required:!0,message:"请输入",trigger:"blur"},{max:200,message:"最多输入200个字符",trigger:"blur"}]},{fieldName:"quotaWeight",name:"指标权重",formType:"percent",max:100,min:0},{fieldName:"scoreType",name:"评分方式",formType:"select",setting:[{label:"直接输入",value:1}],value:1}],tableForm:{}}},computed:{combinedWeights:function(){return function(e){var t=0;return this.tableForm["table"+e]&&this.tableForm["table"+e].forEach((function(e){e.quotaWeight&&(t+=e.quotaWeight)})),t}}},watch:{assessmentDimensionList:{handler:function(){var e=this;this.assessmentDimensionList.forEach((function(t){"update"!=t.type&&"new"!=t.type&&(e.tableForm["table"+t.key]=[{}],t.type="new")}))},immediate:!0,deep:!0},quotaItem:{handler:function(){Object.keys(this.quotaItem).length&&(this.tableForm=this.quotaItem)},deep:!0,immediate:!0}},mounted:function(){},methods:{handlerCreate:function(e){var t=this.tableForm["table"+e],a={quotaName:"",quotaIllustrate:"",standard:"",quotaWeight:void 0,scoreType:1};t.splice(t.length?t.length-1:0,0,a)},handlerDel:function(e,t,a){this.tableForm["table"+a].splice(t,1)},deleteAssess:function(e,t){var a=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var i in a.assessmentDimensionList.splice(e,1),a.quotaItem)i=="table"+t&&delete a.quotaItem[i]})).catch((function(){}))},editAssess:function(e){this.$emit("editAssess",e)}}},o=s,r=(a("918a"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,null,null);t["a"]=c.exports},"0972":function(e,t,a){"use strict";a("e790")},"5cc0":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"employee-index",attrs:{id:"employee-main-container"}},[a("xr-header",{attrs:{"ft-top":"0",placeholder:"请输入模板名称",label:"考核指标模板","show-search":""},on:{search:e.searchClick}},[a("template",{slot:"ft"},[e.saveTemplateAuth?a("el-button",{attrs:{type:"primary"},on:{click:e.createTemplate}},[e._v("新建模板")]):e._e()],1)],2),e._v(" "),a("div",{directives:[{name:"empty",rawName:"v-empty",value:!e.queryPageListAuth,expression:"!queryPageListAuth"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"crm-container",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[e.selectionList.length>0?a("xr-table-header",{attrs:{handles:e.tabelHandles(),selects:e.selectionList},on:{command:e.handleCommand}}):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"n-table--border el-table-header--white",class:e.WKConfig.tableStyle.class,staticStyle:{width:"100%"},attrs:{id:"crm-table","row-height":40,data:e.list,height:e.tableHeight,stripe:e.WKConfig.tableStyle.stripe,"use-virtual":"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"55"}}),e._v(" "),e._l(e.fieldList,(function(t,i){return a("el-table-column",{key:i,attrs:{prop:t.fieldName,label:t.name,"min-width":t.width,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return["employeeName"===t.column.property?[a("span",{staticClass:"can-visit--underline"},[e._v(e._s(e.fieldFormatter(t.row,t.column)))]),1==t.row.isDel?a("span",{staticStyle:{color:"#6b778c"}},[e._v("（已删除）")]):e._e()]:[e._v("\n            "+e._s(e.fieldFormatter(t.row,t.column))+"\n          ")]]}}])})})),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.updateTemplateAuth?a("el-button",{staticStyle:{color:"#0052cc"},attrs:{type:"text"},on:{click:function(a){e.editKpiTemplate(t.row.templateId)}}},[e._v("编辑")]):e._e(),e._v(" "),e.delTemplateAuth?a("el-button",{staticStyle:{color:"#0052cc"},attrs:{type:"text"},on:{click:function(a){e.deleteKpiTemplate(t.row.templateId)}}},[e._v("删除")]):e._e()]}}])})],2),e._v(" "),a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),e.isCreate?a("kpi-template-create",{attrs:{"indicator-template":e.indicatorTemplate},on:{createEditSuccess:e.createEditSuccess,close:function(t){e.isCreate=!1}}}):e._e()],1)],1)},n=[],l=a("5530"),s=(a("ac1f"),a("841c"),a("14d9"),a("d81d"),a("e2cc")),o=a("5057"),r=a("0677"),c=a("8e93"),m=a("2f62"),d=a("6bfe"),u=a("8b13"),h={name:"EmployeeIndex",components:{XrHeader:o["a"],KpiTemplateCreate:r["a"],XrTableHeader:c["a"]},data:function(){return{loading:!1,isCreate:!1,tableHeight:document.documentElement.clientHeight-260,list:[],fieldList:[{fieldName:"templateName",name:"模板名称",width:140},{fieldName:"templateIllustrate",name:"描述",width:120},{fieldName:"dimensionNum",name:"考核维度",width:80},{fieldName:"quotaNum",name:"考核指标",width:80},{fieldName:"upperLimitScore",name:"总分",width:80},{fieldName:"createUserName",name:"创建人",width:80},{fieldName:"updateTime",name:"最近更新时间",width:80}],currentPage:1,pageSize:15,pageSizes:[15,30,60,100],total:0,search:"",popoverFilterWidth:150,rowID:"",detailShow:!1,indicatorTemplate:{},selectionList:[]}},computed:Object(l["a"])(Object(l["a"])({},Object(m["b"])(["collapse","hrm"])),{},{assessmentTemplateAuth:function(){return this.hrm.appraisalSetting},queryPageListAuth:function(){return this.assessmentTemplateAuth&&this.assessmentTemplateAuth.queryPageList},saveTemplateAuth:function(){return this.assessmentTemplateAuth&&this.assessmentTemplateAuth.saveTemplate},updateTemplateAuth:function(){return this.assessmentTemplateAuth&&this.assessmentTemplateAuth.updateTemplate},delTemplateAuth:function(){return this.assessmentTemplateAuth&&this.assessmentTemplateAuth.delTemplate}}),watch:{collapse:{handler:function(e){this.popoverFilterWidth=document.documentElement.clientWidth-(e?89:225)},immediate:!0}},created:function(){var e=this;window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-260},this.refreshList()},methods:{createTemplate:function(){this.indicatorTemplate={},this.isCreate=!0},searchClick:function(e){this.search=e,this.refreshList()},refreshList:function(){this.handleCurrentChange(1)},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getList:function(){var e=this;this.loading=!0;var t={page:this.currentPage,limit:this.pageSize,templateName:this.search};Object(s["c"])(t).then((function(t){e.list=t.data.list,e.total=t.data.totalRow,e.loading=!1})).catch((function(){e.loading=!1}))},tabelHandles:function(){var e=[];return this.delTemplateAuth&&e.push({label:"删除",command:"delete",icon:"wk wk-delete"}),e},handleCommand:function(e){var t=this;if("delete"===e){var a={ids:this.selectionList.map((function(e){return e.templateId}))};this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["b"])(a).then((function(e){t.$message({type:"success",message:"删除成功"}),t.refreshList()})).catch((function(){}))})).catch((function(){}))}},handleSelectionChange:function(e){this.selectionList=e,this.tableHeight=document.documentElement.clientHeight-(this.selectionList.length>0?395:345)},editKpiTemplate:function(e){var t=this;Object(s["d"])(e).then((function(e){t.indicatorTemplate=e.data,t.isCreate=!0}))},deleteKpiTemplate:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["b"])({ids:[e]}).then((function(e){t.$message.success("删除成功"),t.getList()}))})).catch((function(){}))},fieldFormatter:function(e,t){if("employeeStatus"==t.property)return u["d"].statusValue[e.employeeStatus]||"--";var a=e[t.property];return Object(d["c"])(a)?"--":a},createEditSuccess:function(){this.getList()},handleRowClick:function(e,t,a){"employeeName"==t.property&&(this.rowID=e.employeeId,this.detailShow=!0)}}},p=h,f=(a("0972"),a("2877")),b=Object(f["a"])(p,i,n,!1,null,"424142ba",null);t["default"]=b.exports},"5e26":function(e,t,a){e.exports={colorPrimary:"#0052cc",colorBlack:"#172b4d",colorSuccess:"#36b37e",colorWarning:"#ffab00",colorDanger:"#ff5630",colorN40:"#dfe1e6",axisLineColor:"#dfe1e6",axisLabelFontWeight:"500"}},"918a":function(e,t,a){"use strict";a("5e26")},e790:function(e,t,a){}}]);