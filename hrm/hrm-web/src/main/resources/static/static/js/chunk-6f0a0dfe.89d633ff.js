(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f0a0dfe"],{"0fe0":function(e,t,a){"use strict";a("ff8d")},"20f1":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"performance-self",attrs:{id:"employee-main-container"}},[a("xr-header",{attrs:{"ft-top":"0",label:"KPI考核"}}),e._v(" "),a("div",{staticClass:"crm-container"},[a("wk-table-header",{staticStyle:{"margin-top":"30px"},attrs:{search:e.search,props:e.wkHeaderProps,"filter-header-props":e.wkHeaderProps.filterHeaderProps},on:{"update:search":function(t){e.search=t}},scopedSlots:e._u([{key:"custom",fn:function(t){return[a("div",{staticClass:"custom-scene"},[a("span",[e._v("显示：")]),e._v(" "),e._l(e.tabList,(function(t,i){return a("el-button",{key:i,attrs:{title:t.label,type:t.value===e.activeTab?"selected":null,icon:t.icon},on:{click:function(a){e.tabsClick(t)}}},[e._v("\n            "+e._s(t.label)+"\n            "),t.num&&"0"!=t.num?a("span",{staticClass:"values-span",class:{selected:t.value===e.activeTab}},[e._v("\n              "+e._s(t.num)+"\n            ")]):e._e()])}))],2)]}}])}),e._v(" "),a("xr-table-header",[a("el-tabs",{staticStyle:{width:"100%","margin-bottom":"-8px"},on:{"tab-click":e.subTabClick},model:{value:e.subTabType,callback:function(t){e.subTabType=t},expression:"subTabType"}},e._l(e.evaluatoSubTabList,(function(t){return a("el-tab-pane",{key:t.name,attrs:{name:t.name}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.label)),t.num>0?a("span",{staticClass:"tab-pane-num",staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.num))]):e._e()])])})))],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"n-table--border el-table-header--white",class:e.WKConfig.tableStyle.class,staticStyle:{width:"100%"},attrs:{id:"crm-table","row-height":40,data:e.list,height:e.tableHeight,stripe:e.WKConfig.tableStyle.stripe,"use-virtual":"","highlight-current-row":""}},[e._l(e.fieldList,(function(t,i){return a("el-table-column",{key:i,attrs:{prop:t.fieldName,label:t.name,"min-width":t.width,formatter:e.fieldFormatter,"show-overflow-tooltip":""}})})),e._v(" "),a("el-table-column"),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:function(a){e.handleClick(t.row,t.$index)}}},[e._v(e._s(e.handlerOperate(t.row)))])]}}])})],2),e._v(" "),a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),e.detailShow?a("employee-details",{attrs:{id:e.id,"active-tab":e.activeTab,"appraisal-plan-name":e.appraisalPlanName,"sub-tab-type":e.subTabType},on:{"hide-view":function(t){e.detailShow=!1},success:e.success}}):e._e()],1)},s=[],l=(a("ac1f"),a("841c"),a("d3b7"),a("159b"),a("f48e")),n=a("f468"),r=a("8e93"),o=a("7a17"),c=a("5d2e"),u={name:"PerformanceSelf",components:{XrHeader:n["a"],XrTableHeader:r["a"],EmployeeDetails:o["a"],WkTableHeader:c["a"]},beforeRouteUpdate:function(e,t,a){this.handleTab(e),a()},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-305,list:[],currentPage:1,pageSize:15,pageSizes:[15,30,60,100],total:0,search:"",popoverFilterWidth:document.documentElement.clientWidth-80,activeTab:"1",tabList:[{label:"指标填写",value:"1",type:"FILL",num:0},{label:"指标确认",value:"2",type:"TARGET_CONFIRMATION",num:0},{label:"指标评分",value:"4",type:"SCORE",num:0},{label:"结果审核",value:"5",type:"RESULT_AUDIT",num:0},{label:"结果确认",value:"6",type:"RESULT_CONFIRMATION",num:0},{label:"申诉确认",value:"7",type:"APPEAL_CONFIRMATION",num:0}],wkHeaderProps:{showFilterView:!1,filterHeaderProps:{searchPlaceholder:"请输入考核指标名称",tabSetShow:!1},filterFormProps:{showSaveScene:!1}},subTabType:"2",detailShow:!1,id:"",appraisalCycleType:{1:"月度",2:"季度",3:"上半年",4:"下半年",5:"全年"},appraisalPlanName:""}},computed:{fieldList:function(){return this.getTableFileList()},evaluatoSubTabList:function(){return 1==this.activeTab?[{label:"待填写",name:"2"},{label:"已填写",name:"1"}]:2==this.activeTab?[{label:"待确认",name:"2"},{label:"已确认",name:"1"}]:4==this.activeTab?[{label:"待评分",name:"2"},{label:"已评分",name:"1"}]:5==this.activeTab?[{label:"待审核",name:"2"},{label:"已审核",name:"1"}]:6==this.activeTab?[{label:"待确认结果",name:"2"},{label:"已确认",name:"1"},{label:"已申诉",name:"5"}]:7==this.activeTab?[{label:"待确认",name:"2"},{label:"已确认",name:"1"}]:[]}},watch:{},created:function(){var e=this;window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-305},this.handleTab(this.$route)},methods:{handleTab:function(e){this.activeTab=e.query.tabType?e.query.tabType:"1",this.subTabType=e.query.subTabType?e.query.subTabType:"2",this.refreshList()},subTabClick:function(){this.refreshList()},searchClick:function(e){this.search=e,this.refreshList()},refreshList:function(){this.getTabsNum(),this.handleCurrentChange(1)},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getTabsNum:function(){var e=this;Object(l["e"])().then((function(t){var a=t.data||{};e.tabList.forEach((function(e){e.num=a[e.type]}))}))},getList:function(){var e=this;this.loading=!0;var t={page:this.currentPage,limit:this.pageSize};t.search=this.search,t.stage=this.activeTab,t.status=this.subTabType,Object(l["n"])(t).then((function(t){e.list=t.data.list,e.total=t.data.totalRow,e.loading=!1})).catch((function(){e.loading=!1}))},getTableFileList:function(){return[{fieldName:"appraisalPlanName",name:"考核方案名称"},{fieldName:"employeeName",name:"姓名",width:80},{fieldName:"appraisalCycleType",name:"考核周期类型",width:80},{fieldName:"appraisalCycle",name:"考核周期",width:80},{fieldName:"score",name:"评分",width:80},{fieldName:"level",name:"考核结果",width:80}]},success:function(){this.refreshList(this.currentPage)},fieldFormatter:function(e,t){return"appraisalCycleType"==t.property?this.appraisalCycleType[e[t.property]]?this.appraisalCycleType[e[t.property]]:e[t.property]:"appraisalCycle"==t.property?e["quarter"]?e[t.property]+e["quarter"]:e[t.property]:e[t.property]?e[t.property]:"--"},handlerOperate:function(e){return 1==e.stageType&&1==this.activeTab&&2==this.subTabType?"填写":1==e.stageType&&1==this.activeTab&&1==this.subTabType?"查看详情":2==e.stageType&&2==this.activeTab&&2==this.subTabType?"确认":2==e.stageType&&2==this.activeTab&&1==this.subTabType?"查看详情":3==e.stageType&&4==this.activeTab&&2==this.subTabType?"自评":4==e.stageType&&4==this.activeTab&&2==this.subTabType?"评分":4!=e.stageType&&3!=e.stageType||4!=this.activeTab||1!=this.subTabType?5==e.stageType&&5==this.activeTab&&2==this.subTabType?"审核":5==e.stageType&&5==this.activeTab&&1==this.subTabType?"查看详情":6==e.stageType&&6==this.activeTab&&2==this.subTabType?"确认":6!=e.stageType||6!=this.activeTab||1!=this.subTabType&&5!=this.subTabType?7==e.stageType&&7==this.activeTab&&2==this.subTabType?"确认":7==e.stageType&&7==this.activeTab&&1==this.subTabType?"查看详情":"":"查看详情":"查看详情"},handleClick:function(e,t){this.appraisalPlanName=e.appraisalPlanName,this.detailShow=!0,this.id=e.appraisalEmployeeId},tabsClick:function(e){this.activeTab=e.value,this.refreshList()}}},f=u,d=(a("844b"),a("2877")),p=Object(d["a"])(f,i,s,!1,null,"26b35234",null);t["default"]=p.exports},3627:function(e,t,a){},"3ee3":function(e,t,a){},"5d2e":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wk-table-header"},[a("wk-filter-header",e._g(e._b({attrs:{props:e.filterHeaderConfig},on:{"event-change":e.filterHeaderHandle}},"wk-filter-header",e.$attrs,!1),e.$listeners),[a("template",{slot:"left-start"},[e._t("custom")],2),e._v(" "),a("template",{slot:"right"},[e.exportFields.length>0?a("el-button",{staticClass:"collapse-button",attrs:{type:e.exportFieldsShow?"selected":"text"},on:{click:function(t){e.collapseHandle()}}},[e._v("\n        "+e._s(e.exportFieldsShow?"收起筛选":"展开筛选")+"\n        "),a("i",{class:["el-icon-arrow-up",{"is-reverse":!e.exportFieldsShow}]})]):e._e(),e._v(" "),e.config.showFilterView?a("el-button",{staticClass:"filter-button",class:{"has-values":e.filterValidCount>0},attrs:{type:"subtle",icon:"wk wk-screening"},on:{click:e.showFilterClick}},[e._v("高级筛选"),e.filterValidCount>0?a("span",{staticClass:"values-span",attrs:{closable:"",type:"info"}},[e._v("\n          "+e._s(e.filterValidCount)),a("i",{staticClass:"el-icon-close",on:{click:function(t){t.stopPropagation(),e.clearFilterVal(e.filterObj.form)}}})]):e._e()]):e._e(),e._v(" "),e._t("default")],2)],2),e._v(" "),e.exportFields.length>0&&e.exportFieldsShow?a("filter-export-fields",{attrs:{"condition-type-fun":e.conditionTypeFun,form:e.exportFields,"field-list":e.fieldList,props:e.filterFormProps?e.filterFormProps.filterFieldsProps:null},on:{filter:e.exportFilter,clear:e.clearFilterVal}}):e._e(),e._v(" "),a("scene-set",{attrs:{"dialog-visible":e.sceneSetShow,props:e.sceneSetProps,"create-props":e.sceneCreateProps,"filter-fields-props":e.filterFormProps?e.filterFormProps.filterFieldsProps:null,"condition-type-fun":e.conditionTypeFun},on:{"update:dialogVisible":function(t){e.sceneSetShow=t},"save-success":e.updateSceneList}}),e._v(" "),e.config.showFilterView?a("filter-form",{attrs:{"field-list":e.fieldList,"dialog-visible":e.filterShow,obj:e.filterObj,"condition-type-fun":e.conditionTypeFun,props:e.filterFormProps},on:{"update:dialogVisible":function(t){e.filterShow=t},filter:e.handleFilter}}):e._e()],1)},s=[],l=a("c7eb"),n=a("1da1"),r=a("5530"),o=(a("4de4"),a("d3b7"),a("ddb0"),a("caad"),a("159b"),a("14d9"),a("e9c4"),a("1bfc")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"filter-export-fields"},[a("div",{staticClass:"title"},[e._v("筛选条件")]),e._v(" "),a("filter-fields",{attrs:{"condition-type-fun":e.conditionTypeFun,form:e.form,"field-list":e.fieldList,props:e.props,"is-export":""}}),e._v(" "),a("div",{staticClass:"filter-export-fields__handle"},[a("el-button",{attrs:{type:"primary"},on:{click:e.filterClick}},[e._v("筛选")]),e._v(" "),a("el-button",{on:{click:e.clearClick}},[e._v("清空外露筛选值")])],1)],1)},u=[],f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"filterFieldsForm",staticClass:"filter-fields"},e._l(e.form,(function(t,i){return a("el-row",{key:i,attrs:{type:"flex"}},[a("el-col",{attrs:{span:6}},[a("wk-search-select",{attrs:{disabled:e.isExport,placeholder:"请选择要筛选的字段名",options:e.fieldListOptions},on:{change:function(a){e.fieldChange(t)},focus:e.fieldFocus},model:{value:t.fieldName,callback:function(a){e.$set(t,"fieldName",a)},expression:"formItem.fieldName"}})],1),e._v(" "),e.showCalCondition(t.formType,t.fieldName,t)?[a("el-col",{staticClass:"interval-base",attrs:{span:1}}),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-select",{attrs:{placeholder:"请选择范围"},on:{change:function(a){e.selectChange(a,t)}},model:{value:t.condition,callback:function(a){e.$set(t,"condition",a)},expression:"formItem.condition"}},e._l(e.getAdvancedFilterOptions(e.conditionTypeFun?e.conditionTypeFun(t):t.formType,t),(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1)]:e._e(),e._v(" "),"business_cause"==t.formType?a("el-col",{staticClass:"interval-base",attrs:{span:1}}):e._e(),e._v(" "),"business_cause"==t.formType?a("el-col",{attrs:{span:4}},[a("el-select",{on:{change:function(a){e.typeOptionsChange(t)}},model:{value:t.flowName,callback:function(a){e.$set(t,"flowName",a)},expression:"formItem.flowName"}},e._l(t.typeOption,(function(t){return a("el-option",{key:t.flowId,attrs:{label:t.flowName,value:t[e.config.businessCauseValueKey]}})})))],1):e._e(),e._v(" "),a("el-col",{staticClass:"interval-base",attrs:{span:1}}),e._v(" "),a("el-col",{staticStyle:{position:"relative"},attrs:{span:e.getValueSpan(t.formType,t.fieldName,t)?e.isExport||!e.showExport?11:9:e.isExport?16:14}},["isNull"===t.condition||"isNotNull"===t.condition?void 0:e.updateFlag?["checkStatus"===t.formType||"dealStatus"===t.formType||"invoiceStatus"===t.formType||"receivedStatus"===t.formType||"status"===t.formType||"select"===t.formType&&"string"!=e.getSettingValueType(t.setting)?a("wk-search-select",{attrs:{placeholder:"请选择筛选条件",options:t.setting},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}}):"checkbox"===t.formType&&"string"!=e.getSettingValueType(t.setting)?a("wk-search-select",{attrs:{multiple:"field_tag"!==t.formType,placeholder:"请选择筛选条件",options:t.setting},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}},e._l(t.setting,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name||e.label,value:e.value}})}))):["select","checkbox"].includes(t.formType)?a("wk-search-select",{attrs:{multiple:"field_tag"!==t.formType,placeholder:"请选择筛选条件",options:e.getObjOptions(t.setting)},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}}):["field_tag"].includes(t.formType)?a("el-select",{attrs:{filterable:"",multiple:"",placeholder:"请选择筛选条件","popper-class":"select-popper-class"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}},e._l(t.groupList,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.labelList,(function(e){return a("el-option",{key:""+(t.label+e),attrs:{label:e,value:e}})})))}))):"field_attention"===t.formType?a("el-select",{attrs:{multiple:"",placeholder:"请选择筛选条件"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}},e._l(t.setting,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))):"number"==t.formType||"floatnumber"==t.formType||"percent"==t.formType?[14===t.type?a("div",{staticClass:"date-range-value"},[a("el-input-number",{staticClass:"small",attrs:{controls:!1},model:{value:t.min,callback:function(a){e.$set(t,"min",a)},expression:"formItem.min"}}),e._v(" "),a("span",[e._v("-")]),e._v(" "),a("el-input-number",{staticClass:"small",attrs:{controls:!1},model:{value:t.max,callback:function(a){e.$set(t,"max",a)},expression:"formItem.max"}})],1):a("el-input-number",{staticClass:"small",staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}})]:"date"===t.formType||"datetime"===t.formType?[a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:14===t.type,expression:"formItem.type === 14"}],ref:"wkDatePicker"+i,refInFor:!0,attrs:{"picker-options":e.getPickerOptions(t,i),type:"date"===t.formType?"daterange":"datetimerange","value-format":"date"===t.formType?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},on:{change:function(a){e.datePickerChange(t)}},model:{value:t.range,callback:function(a){e.$set(t,"range",a)},expression:"formItem.range"}}),e._v(" "),t.timeType?a("div",{staticClass:"date-range-content",on:{click:function(a){e.dateRangeSelect(t,i)}}},[e._v(e._s(t.timeTypeName))]):e._e(),e._v(" "),a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:14!==t.type,expression:"formItem.type !== 14"}],attrs:{"value-format":"date"===t.formType?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",type:t.formType,placeholder:"选择日期"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}})]:"business_cause"===t.formType?a("el-select",{model:{value:t.settingName,callback:function(a){e.$set(t,"settingName",a)},expression:"formItem.settingName"}},e._l(t.settingList,(function(e){return a("el-option",{key:e.settingId,attrs:{label:e.settingName,value:e.settingName}})}))):"user"===t.formType||"single_user"===t.formType?a("wk-user-dialog-select",{staticStyle:{width:"100%"},attrs:{radio:!1},on:{change:function(a){e.userDepChange(t,arguments[0],arguments[1])}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}}):"structure"===t.formType?a("wk-dept-dialog-select",{staticStyle:{width:"100%"},attrs:{radio:!1},on:{change:function(a){e.userDepChange(t,arguments[0],arguments[1])}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}}):"boolean_value"==t.formType?a("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}}):"productTypeId"===t.fieldName?a("wk-product-category",{attrs:{item:t,value:t.value,type:"jxc"},on:{change:e.arrayValueChange}}):"category"===t.formType?a("xh-prouct-cate",{attrs:{item:t,value:t.value},on:{"value-change":e.arrayValueChange}}):"map_address"===t.formType?a("v-distpicker",{attrs:{province:t.address.state,city:t.address.city,area:t.address.area},on:{province:function(a){e.selectProvince(a,t)},city:function(a){e.selectCity(a,t)},area:function(a){e.selectArea(a,t)}}}):"position"==t.formType?a("wk-position",{attrs:{"show-detail":!1,props:{checkStrictly:!0}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}}):a("el-input",{attrs:{placeholder:"多个条件请用；隔开"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"formItem.value"}})]:e._e()],2),e._v(" "),e.isExport?e._e():a("el-col",{staticClass:"delete",attrs:{span:1}},[a("i",{staticClass:"el-icon-error delete-btn",on:{click:function(t){e.handleDelete(i)}}})]),e._v(" "),!e.isExport&&e.showExport?a("el-col",{attrs:{span:2}},[a("el-checkbox",{attrs:{"true-label":1,"false-label":0},on:{change:e.exportChange},model:{value:t.isOut,callback:function(a){e.$set(t,"isOut",a)},expression:"formItem.isOut"}},[e._v("外露")])],1):e._e()],2)})))},d=[],p=a("b85c"),h=a("2909"),m=a("53ca"),v=(a("d81d"),a("b0c0"),a("7db0"),a("a630"),a("3ca3"),a("6062"),a("f068")),y=a("8f81"),b=a("bfba"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-cascader",e._b({ref:"elCascader",staticStyle:{width:"100%"},attrs:{options:e.options,"show-all-levels":!1,props:e.defaultProps},on:{change:e.valueChange},model:{value:e.dataValue,callback:function(t){e.dataValue=t},expression:"dataValue"}},"el-cascader",e.$attrs,!1))},T=[],k=(a("a9e3"),a("2532"),a("ea20")),C=a("6bfe"),x={name:"ProductType",components:{},props:{item:Object,value:{type:[String,Number,Object,Array],default:null},type:{type:String,default:"jxc"}},data:function(){return{options:[],dataValue:null,defaultProps:{},request:null}},watch:{value:{handler:function(){this.value?this.dataValue&&this.dataValue.includes(this.value)||(this.dataValue=this.value):this.dataValue=null},deep:!0,immediate:!0}},mounted:function(){this.setConfig(),this.getProductCategoryIndex()},methods:{setConfig:function(){"crm"===this.type&&(this.defaultProps={children:"children",label:"label",value:"categoryId",checkStrictly:!0},this.request=k["o"])},getProductCategoryIndex:function(){var e=this;this.request({type:"tree"}).then((function(t){e.options=e.formatOptions(t.data,e.defaultProps.children)})).catch((function(){}))},formatOptions:function(e,t){var a=this;return e.forEach((function(e){e.hasOwnProperty(t)&&(Object(C["c"])(e[t])?delete e[t]:e[t]=a.formatOptions(e[t],t))})),e},valueChange:function(e){this.$emit("input",e[e.length-1]||""),this.$emit("change",{valArr:e,value:e,item:this.item,valueContent:e.length>0?this.$refs.elCascader.getCheckedNodes()[0].label:""})}}},_=x,w=a("2877"),N=Object(w["a"])(_,g,T,!1,null,"527cc426",null),O=N.exports,S=a("5a8c"),I=a("0a3e"),F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",e._g(e._b({key:e.refreshKey,attrs:{filterable:"",remote:"","remote-method":e.remoteMethod},on:{change:e.valueChange,focus:e.selectFocus},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},"el-select",e.$attrs,!1),e.$listeners),e._l(e.filterOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name||e.label,value:e.value}})})))},j=[],L=(a("ac1f"),a("841c"),a("466d"),a("d22a")),$={name:"WkSearchSelect",inheritAttrs:!1,props:{value:{required:!0},options:Array},data:function(){return{selectedValue:null,search:"",refreshKey:Date.now()}},computed:{filterOptions:function(){var e=this;return this.search?this.options.filter((function(t){return L["a"].match(e.isEmptyValue(t.value)?t:t.label||t.name,e.search)})):this.options}},watch:{value:{handler:function(){this.selectedValue!==this.value&&(this.selectedValue=this.value)},immediate:!0}},methods:{remoteMethod:function(e){this.search=e},isEmptyValue:function(e){return null===e||void 0==e},valueChange:function(e){var t=this;this.$emit("input",e),this.$nextTick((function(){t.refreshKey=Date.now()}))},selectFocus:function(){this.search=""}}},P=$,E=Object(w["a"])(P,F,j,!1,null,"094f3408",null),D=E.exports,V=a("2b0e"),A={methods:{getAdvancedFilterOptionName:function(e,t){var a="date"===t||"datetime"===t;return{1:"等于",2:"不等于",3:"包含",4:"不包含",5:"为空",6:"不为空",7:a?"晚于":"大于",8:a?"不早于":"大于等于",9:a?"早于":"小于",10:a?"不晚于":"小于等于",12:"开始于",13:"结束于",14:a?"等于（时间段）":"等于（范围）"}[e]||""},getAdvancedFilterOptions:function(e,t){return"text"==e||"textarea"==e||"website"==e||"mobile"==e||"email"==e||"module"==e||"serial_number"==e?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"contains",label:"包含",disabled:!1,type:3},{value:"notContains",label:"不包含",disabled:!1,type:4},{value:"startWith",label:"开始于",disabled:!1,type:12},{value:"endWith",label:"结束于",disabled:!1,type:13},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"invoiceStatus"===e||"checkStatus"==e||"dealStatus"==e||"receivedStatus"==e||"status"==e?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2}]:"select"==e||"field_attention"==e?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"boolean_value"==e?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2}]:"checkbox"==e||"location"==e?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"contains",label:"包含",disabled:!1,type:3},{value:"notContains",label:"不包含",disabled:!1,type:4},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"number"==e||"floatnumber"==e||"percent"==e?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"gt",label:"大于",disabled:!1,type:7},{value:"egt",label:"大于等于",disabled:!1,type:8},{value:"lt",label:"小于",disabled:!1,type:9},{value:"elt",label:"小于等于",disabled:!1,type:10},{value:"range",label:"等于（范围）",disabled:!1,type:14},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"date"==e||"datetime"==e?[{value:"is",label:"等于",disabled:!1,type:1},{value:"isNot",label:"不等于",disabled:!1,type:2},{value:"lt",label:"早于",disabled:!1,type:9},{value:"gt",label:"晚于",disabled:!1,type:7},{value:"egt",label:"不早于",disabled:!1,type:8},{value:"elt",label:"不晚于",disabled:!1,type:10},{value:"range",label:"等于（时间段）",disabled:!1,type:14},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:"date_interval"==e||"position"==e?[]:"user"==e||"structure"==e||"single_user"==e||"field_tag"==e?[{value:"contains",label:"包含",disabled:!1,type:3},{value:"notContains",label:"不包含",disabled:!1,type:4},{value:"isNull",label:"为空",disabled:!1,type:5},{value:"isNotNull",label:"不为空",disabled:!1,type:6}]:[]},getAdvancedFilterDefaultItemByFormType:function(e,t,a){t||(t=e),"business_cause"==e.formType?(e.typeOption=t.setting,e.settingList=[],V["default"].set(e,"flowName",""),V["default"].set(e,"settingName",""),e.value=""):"checkStatus"==e.formType||"dealStatus"==e.formType||"invoiceStatus"==e.formType||"receivedStatus"==e.formType||"status"==e.formType?(e.setting=t.setting||[],e.value=""):"map_address"==e.formType?e.address={state:"",city:"",area:""}:"user"===e.formType||"single_user"===e.formType||"structure"===e.formType||"category"===e.formType||"position"===e.formType?e.value=[]:"date"===e.formType||"datetime"===e.formType?(e.value="",V["default"].set(e,"timeType",""),V["default"].set(e,"timeTypeName",""),V["default"].set(e,"range",[])):"select"==e.formType||"checkbox"===e.formType||"field_attention"===e.formType?(e.setting=t.setting||[],e.value=[]):"number"==e.formType||"floatnumber"==e.formType||"percent"==e.formType?(e.min="",e.max="",e.value=""):"field_tag"===e.formType?(e.setting=t.setting||[],e.value=""):e.value="";var i=this.getAdvancedFilterOptions(a?a(e):e.formType,e.fieldName);if(i.length>0){var s=i[0];e.condition=s.value,e.type=s.type}else e.condition="is",e.type=1;return e},resetAdvancedFilterFieldsValue:function(e){e.forEach((function(e){"number"==e.formType||"floatnumber"==e.formType||"percent"==e.formType?(e.min="",e.max="",e.value=""):"business_cause"==e.formType?(e.flowName="",e.settingName="",e.value="",e.settingList=[]):"map_address"==e.formType?e.address={state:"",city:"",area:""}:["date","datetime"].includes(e.formType)?(e.value="",e.range=[]):Object(C["a"])(e.value)?e.value=[]:Object(C["d"])(e.value)?e.value={}:e.value=""}))}}},H=a("8ed6"),R={showPersonTag:!1,request:null,params:null,businessCauseValueKey:"flowName"},q={name:"FilterFields",components:{WkUserDialogSelect:y["a"],XhProuctCate:v["b"],WkProductCategory:O,VDistpicker:S["a"],WkDeptDialogSelect:b["a"],WkPosition:I["a"],WkSearchSelect:D},mixins:[A],props:{conditionTypeFun:Function,form:Array,fieldList:Array,disabled:{type:Boolean,default:!1},showExport:{type:Boolean,default:!0},isExport:{type:Boolean,default:!1},props:Object},data:function(){return{updateFlag:!0}},computed:{config:function(){return Object(H["a"])(Object(r["a"])({},R),this.props||{})},fieldListOptions:function(){return this.fieldList.map((function(e){return{name:e.name,value:e.fieldName}}))}},watch:{form:function(){var e=this;this.$nextTick((function(){e.$el.scrollTop=e.$el.scrollHeight}))}},created:function(){var e,t=this;(null===(e=this.form)||void 0===e?void 0:e.length)>0&&this.form.forEach((function(e){"field_tag"==e.formType&&t.getPersonLabel(e)}))},mounted:function(){},beforeDestroy:function(){},methods:{showCalCondition:function(e,t,a){return this.getAdvancedFilterOptions(this.conditionTypeFun?this.conditionTypeFun(a):e,t).length>0},getValueSpan:function(e,t,a){return"business_cause"==e||this.showCalCondition(e,t,a)?8:13},typeOptionsChange:function(e){var t=this;if(e.flowName){var a=e.typeOption.find((function(a){return a[t.config.businessCauseValueKey]===e.flowName}));e.settingList=a.settingList||[]}else e.settingList=[];e.settingName=""},getSettingValueType:function(e){if(e&&e.length>0){var t=e[0];return Object(m["a"])(t)}return[]},getPersonLabel:function(e){var t=this;this.$nextTick((function(){var a=Array.from(new Set(e.setting)),i=!!(a.length>0&&a[0].labelList),s=null;i&&(s=a.map((function(e){var t;return{label:e.name,labelList:null===(t=e.labelList)||void 0===t?void 0:t.map((function(e){return e.name}))}})));var l=[{label:"企业标签",labelList:i?[]:a}];i&&l.push.apply(l,Object(h["a"])(s));var n=t.config,r=n.showPersonTag,o=n.request,c=n.params;r?o(c).then((function(a){var i,s=[],n=Object(p["a"])(a.data||[]);try{for(n.s();!(i=n.n()).done;){var r=i.value;s.push(r.name)}}catch(u){n.e(u)}finally{n.f()}var o=Array.from(new Set(s)),c={label:"个人标签",labelList:o};l.push(c),t.$set(e,"groupList",l)})):t.$set(e,"groupList",l)}))},selectProvince:function(e,t){t.address.state=e.value},selectCity:function(e,t){t.address.city=e.value},selectArea:function(e,t){t.address.area=e.value},arrayValueChange:function(e){e.value.length>0?(e.item.value=e.value,e.item.valueContent=e.valueContent):e.item.value=[]},userDepChange:function(e,t,a){e.valueContent=a},selectChange:function(e,t){this.getAdvancedFilterOptions(this.conditionTypeFun?this.conditionTypeFun(t):t.formType,t.fieldName).forEach((function(a){a.value===e&&(t.type=a.type)}))},fieldFocus:function(){this.$el.click()},fieldChange:function(e){var t=this,a=this.fieldList.find((function(t){return t.fieldName===e.fieldName}));a&&(e.formType=a.formType,e.name=a.name,"field_tag"==e.formType&&this.getPersonLabel(e),this.getAdvancedFilterDefaultItemByFormType(e,a,this.conditionTypeFun)),this.$emit("on-field-change"),this.updateFlag=!1,this.$nextTick((function(){t.updateFlag=!0}))},dateRangeSelect:function(e,t){var a=this.$refs["wkDatePicker".concat(t)][0];this.$nextTick((function(){a.focus(),a.pickerVisible=!0}))},datePickerChange:function(e){e.timeTypeName="",e.timeType=""},getPickerOptions:function(e,t){for(var a=this,i=[{text:"本年度",value:"year"},{text:"上一年度",value:"lastYear"},{text:"下一年度",value:"nextYear"},{text:"上半年",value:"firstHalfYear"},{text:"下半年",value:"nextHalfYear"},{text:"本季度",value:"quarter"},{text:"上一季度",value:"lastQuarter"},{text:"下一季度",value:"nextQuarter"},{text:"本月",value:"month"},{text:"上月",value:"lastMonth"},{text:"下月",value:"nextMonth"},{text:"本周",value:"week"},{text:"上周",value:"lastWeek"},{text:"下周",value:"nextWeek"},{text:"今天",value:"today"},{text:"昨天",value:"yesterday"},{text:"明天",value:"tomorrow"},{text:"过去7天",value:"previous7day"},{text:"过去30天",value:"previous30day"},{text:"未来7天",value:"future7day"},{text:"未来30天",value:"future30day"}],s=[],l=function(){var t=i[n];s.push({text:t.text,onClick:function(i){i.$emit("pick",[],!1),a.$nextTick((function(){e.timeTypeName=t.text,e.timeType=t.value}))}})},n=0;n<i.length;n++)l();return{shortcuts:s}},handleDelete:function(e){this.$emit("on-field-delete",e)},exportChange:function(){this.$emit("on-field-export")},getObjOptions:function(e){return e.map((function(e){return{name:e,value:e}}))}}},M=q,z=(a("bb7d"),Object(w["a"])(M,f,d,!1,null,"11f23114",null)),W=z.exports,B=(a("a15b"),a("5319"),function(e){return[5,6].includes(e)});function J(e){var t=[];return e.forEach((function(e){var a=[];if("datetime"==e.formType||"date"==e.formType)14===e.type?a=Object(C["c"])(e.timeType)?e.range:[e.timeType]:e.value&&(a=Object(C["a"])(e.value)?e.value:[e.value]),B(e.type)&&(a=[]),t.push({formType:e.formType,name:e.fieldName,type:e.type,values:a});else if("number"==e.formType||"floatnumber"==e.formType||"percent"==e.formType)14===e.type?a=[Object(C["c"])(e.min)?0:e.min,Object(C["c"])(e.max)?0:e.max]:Object(C["c"])(e.value)||(a=[e.value]),B(e.type)&&(a=[]),t.push({formType:e.formType,name:e.fieldName,type:e.type,values:a});else if("business_cause"==e.formType)e.flowName&&t.push({formType:e.formType,name:"flowName",type:1,values:[e.flowName]}),e.settingName&&t.push({formType:e.formType,name:"settingName",type:1,values:[e.settingName]});else if("user"==e.formType||"single_user"==e.formType)a=e.value,B(e.type)&&(a=[]),t.push({type:e.type,values:a,formType:e.formType,name:e.fieldName});else if("position"==e.formType)a=e.value.filter((function(e){return!Object(C["c"])(e.name)})).map((function(e){return JSON.stringify(e)})),B(e.type)&&(a=[]),t.push({type:e.type,values:a,formType:e.formType,name:e.fieldName});else if("structure"==e.formType)a=e.value,B(e.type)&&(a=[]),t.push({type:e.type,values:a,formType:e.formType,name:e.fieldName});else if("checkbox"==e.formType)a="receivedStatus"!==e.fieldName||Object(C["a"])(e.value)?Object(C["a"])(e.value)?e.value:[]:""===e.value||null===e.value||void 0===e.value?[]:[e.value],B(e.type)&&(a=[]),t.push({type:e.type,values:a,formType:e.formType,name:e.fieldName});else if("category"==e.formType)a=Object(C["a"])(e.value)&&e.value.length>0?[e.value[e.value.length-1]]:[],B(e.type)&&(a=[]),t.push({type:1,values:a,formType:e.formType,name:e.fieldName});else if("select"===e.formType)a=e.value||[],"string"==K(e.setting)||!e.value&&0!==e.value||(a=[e.value]),B(e.type)&&(a=[]),t.push({type:e.type,values:a,formType:e.formType,name:e.fieldName});else if(["field_tag","field_attention"].includes(e.formType))a=e.value||[],Object(C["a"])(a)||(a=[a]),B(e.type)&&(a=[]),t.push({type:e.type,values:a,formType:e.formType,name:e.fieldName});else if("map_address"==e.formType){var i=[];for(var s in e.address){var l=e.address[s];l&&i.push(l)}t.push({values:[i.join(",")],type:3,formType:e.formType,name:e.fieldName})}else{var n=[];if("string"===typeof e.value){var r=e.value.replace(/；/g,";");n=r.split(";").filter((function(e){return""!==e&&null!==e}))}else n=[e.value];B(e.type)&&(n=[]),t.push({type:e.type,values:n,formType:e.formType,name:e.fieldName})}})),t}function K(e){if(e&&e.length>0){var t=e[0];return Object(m["a"])(t)}return[]}var Y={name:"FilterExportFields",components:{FilterFields:W},props:{conditionTypeFun:Function,form:Array,fieldList:Array,props:Object},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{filterClick:function(){this.$emit("filter",J(this.form))},clearClick:function(){this.$emit("clear",this.form)}}},U=Y,Q=(a("0fe0"),Object(w["a"])(U,c,u,!1,null,"642ce051",null)),X=Q.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.visible,"append-to-body":!0,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[a("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[e._v("场景管理"),e.config.help?a("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":e.config.help.type,"data-id":e.config.help.id}}):e._e()]),e._v(" "),a("div",{staticClass:"scene-name"},[e._v("您可通过拖拽管理场景")]),e._v(" "),a("flexbox",{staticClass:"scene-list"},[a("div",{staticClass:"scene-list-box"},[a("flexbox",{staticClass:"scene-list-head"},[a("el-checkbox",{attrs:{indeterminate:e.isleftIndeterminate},on:{change:e.handleleftCheckAllChange},model:{value:e.checkleftAll,callback:function(t){e.checkleftAll=t},expression:"checkleftAll"}}),e._v(" "),a("div",{staticClass:"scene-list-head-name"},[e._v("显示的场景")]),e._v(" "),a("div",{staticClass:"scene-list-head-detail"},[e._v(e._s(e.leftCheckItems.length+"/"+e.checkedLeftData.length))])],1),e._v(" "),a("div",{staticClass:"scene-list-body"},[a("draggable",{staticStyle:{"min-height":"100px"},attrs:{move:e.leftMove,options:{group:"list",forceFallback:!1,fallbackClass:"draggingStyle"}},on:{end:e.leftMoveEnd},model:{value:e.checkedLeftData,callback:function(t){e.checkedLeftData=t},expression:"checkedLeftData"}},e._l(e.checkedLeftData,(function(t,i){return a("flexbox",{key:i,staticClass:"list-item"},[a("div",{staticClass:"default-mark",class:{"default-mark-active":t.sceneId==e.defaultId}}),e._v(" "),a("el-checkbox",{staticClass:"list-item-check",on:{change:e.leftCheckItemChange},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}}),e._v(" "),a("div",{staticClass:"list-item-name"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"list-item-handle"},[1!=t.isSystem?a("i",{staticClass:"el-icon-edit",on:{click:function(a){e.itemHandle("edit",t,i)}}}):e._e(),e._v(" "),1!=t.isSystem?a("i",{staticClass:"el-icon-delete",on:{click:function(a){e.itemHandle("delete",t,i)}}}):e._e(),e._v(" "),t.sceneId!=e.defaultId?a("el-dropdown",{on:{command:function(a){e.defaultHandle(arguments[0],t)}},model:{value:t.visible,callback:function(a){e.$set(t,"visible",a)},expression:"item.visible"}},[a("el-button",{staticClass:"dropdown-btn menu-edit-btn",attrs:{icon:"wk wk-manage",size:"small"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"default"}},[e._v("设置为默认场景")])],1)],1):e._e()],1)],1)})))],1)],1),e._v(" "),a("div",{staticClass:"scene-middle-list"},[a("el-button",{staticClass:"scene-middle-left-button",class:{"scene-middle-button-select":e.rightCheckItems.length>0},attrs:{disabled:0==e.rightCheckItems.length},on:{click:function(t){e.changePositon("left")}}},[a("i",{staticClass:"el-icon-arrow-left scene-middle-icon"})]),e._v(" "),a("el-button",{staticClass:"scene-middle-right-button",class:{"scene-middle-button-select":e.leftCheckItems.length>0},attrs:{disabled:0==e.leftCheckItems.length},on:{click:function(t){e.changePositon("right")}}},[a("i",{staticClass:"el-icon-arrow-right scene-middle-icon"})])],1),e._v(" "),a("div",{staticClass:"scene-list-box"},[a("flexbox",{staticClass:"scene-list-head"},[a("el-checkbox",{attrs:{indeterminate:e.isrightIndeterminate},on:{change:e.handlerightCheckAllChange},model:{value:e.checkrightAll,callback:function(t){e.checkrightAll=t},expression:"checkrightAll"}}),e._v(" "),a("div",{staticClass:"scene-list-head-name"},[e._v("隐藏的场景")]),e._v(" "),a("div",{staticClass:"scene-list-head-detail"},[e._v(e._s(e.rightCheckItems.length+"/"+e.checkedRightData.length))])],1),e._v(" "),a("div",{staticClass:"scene-list-body"},[a("draggable",{staticStyle:{"min-height":"100px"},attrs:{move:e.rightMove,options:{group:"list",forceFallback:!1,fallbackClass:"draggingStyle"}},on:{end:e.rightMoveEnd},model:{value:e.checkedRightData,callback:function(t){e.checkedRightData=t},expression:"checkedRightData"}},e._l(e.checkedRightData,(function(t,i){return a("flexbox",{key:i,staticClass:"list-item"},[a("el-checkbox",{staticClass:"list-item-check",staticStyle:{"margin-left":"9px"},on:{change:e.rightCheckItemChange},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}}),e._v(" "),a("div",{staticClass:"list-item-name"},[e._v(e._s(t.name))])],1)})))],1)],1)]),e._v(" "),a("div",{staticClass:"handle-bar"},[a("el-button",{staticStyle:{"padding-right":"0","padding-left":"0"},attrs:{type:"text"},on:{click:function(t){e.addAndEditScene("add",{})}}},[e._v("+ 新建场景")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("保存")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v("取消")])],1),e._v(" "),a("scene-create",{attrs:{"field-list":e.fieldList,props:e.createProps,"filter-fields-props":e.filterFieldsProps,"condition-type-fun":e.conditionTypeFun,"dialog-visible":e.showCreateScene,obj:e.filterObj,name:e.filterName,"edit-id":e.filterEditId,"is-default":e.filterDefault},on:{"update:dialogVisible":function(t){e.showCreateScene=t},"save-success":e.refreshSceneList}})],1)},Z=[],ee=(a("a434"),a("25f0"),a("b76a")),te=a.n(ee),ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.editId?"编辑场景":"新建场景",visible:e.visible,"close-on-click-modal":!1,"append-to-body":!0,width:"800px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[a("div",{staticClass:"scene-name-container"},[a("div",{staticClass:"scene-name"},[e._v("场景名称")]),e._v(" "),a("el-input",{staticClass:"scene-input",attrs:{maxlength:10,placeholder:"场景名称，最多10个字符"},model:{value:e.saveName,callback:function(t){e.saveName="string"===typeof t?t.trim():t},expression:"saveName"}})],1),e._v(" "),a("div",{staticClass:"scene-name"},[e._v("筛选条件")]),e._v(" "),a("filter-fields",{attrs:{id:"scene-filter-container","condition-type-fun":e.conditionTypeFun,form:e.form,"field-list":e.fieldList,props:e.filterFieldsProps,"show-export":!1},on:{"on-field-change":e.getError,"on-field-delete":e.handleDelete}}),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:e.showErrors,expression:"showErrors"}],staticClass:"el-icon-warning warning-info"},[a("span",{staticClass:"desc"},[e._v(e._s(e.errorTypes[e.errorType]))])]),e._v(" "),a("el-button",{staticStyle:{"padding-right":"0","padding-left":"0"},attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("+ 添加筛选条件")]),e._v(" "),a("div",{staticClass:"save"},[a("div",{staticClass:"save-setting"},[a("el-checkbox",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:"saveDefault"}},[e._v("设置为默认")]),e.config.help?a("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":e.config.help.type,"data-id":e.config.help.id}}):e._e()],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},ie=[],se=(a("fb6a"),a("ed08")),le={updateRequest:null,updateParams:null,saveRequest:null,saveParams:null,help:null},ne={name:"SceneCreate",components:{FilterFields:W},mixins:[A],props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:function(){return[]}},obj:{type:Object,required:!0,default:function(){return{}}},props:Object,filterFieldsProps:Object,conditionTypeFun:Function,name:{type:String,default:""},isDefault:{type:Boolean,default:!1},editId:{type:String,default:""}},data:function(){return{form:[],visible:!1,errorTypes:["筛选条件中有重复项！","请选择筛选条件！"],errorType:0,showErrors:!1,saveDefault:!1,saveName:null,timeTypes:[{text:"本年度",value:"year"},{text:"上一年度",value:"lastYear"},{text:"下一年度",value:"nextYear"},{text:"上半年",value:"firstHalfYear"},{text:"下半年",value:"nextHalfYear"},{text:"本季度",value:"quarter"},{text:"上一季度",value:"lastQuarter"},{text:"下一季度",value:"nextQuarter"},{text:"本月",value:"month"},{text:"上月",value:"lastMonth"},{text:"下月",value:"nextMonth"},{text:"本周",value:"week"},{text:"上周",value:"lastWeek"},{text:"下周",value:"nextWeek"},{text:"今天",value:"today"},{text:"昨天",value:"yesterday"},{text:"明天",value:"tomorrow"},{text:"过去7天",value:"previous7day"},{text:"过去30天",value:"previous30day"},{text:"未来7天",value:"future7day"},{text:"未来30天",value:"future30day"}]}},computed:{config:function(){return Object(H["a"])(Object(r["a"])({},le),this.props||{})}},watch:{dialogVisible:{handler:function(e){var t=this;if(e){var a=[];if(this.editId){var i=function(){var e=t.obj.obj[s],i=t.getFilterItem();if(i.fieldName=e.name,i.formType=e.formType,i.type=e.type,t.getAdvancedFilterOptions(e.formType,e.fieldName).forEach((function(t){e.type===t.type&&(i.condition=t.value)})),"checkbox"!==i.formType&&"select"!==i.formType&&"dealStatus"!==i.formType&&"checkStatus"!==i.formType||(i.setting=t.getEditSetting(i.formType,i.fieldName)),"date"==e.formType||"datetime"==e.formType)if(i.value="",t.$set(i,"timeType",""),t.$set(i,"timeTypeName",""),t.$set(i,"range",[]),14===i.type)if(Object(C["a"])(e.values)&&e.values.length>0)if(1===e.values.length){i.timeType=e.values[0];var l=t.timeTypes.find((function(e){return e.value===i.timeType}));l&&(i.timeTypeName=l.text)}else t.$set(i,"range",e.values.slice(0,2));else i.value="";else i.value=e.values[0];else if("number"==e.formType||"floatnumber"==e.formType||"percent"==e.formType)i.min="",i.max="",i.value="",14===i.type?(i.min=Object(C["a"])(e.values)&&!Object(C["c"])(e.values[0])?e.values[0]:"",i.max=Object(C["a"])(e.values)&&!Object(C["c"])(e.values[1])?e.values[1]:""):i.value=e.values[0];else if("business_cause"==e.formType){if("settingName"===e.name&&(i=a.find((function(e){return"business_cause"===e.formType}))||i,i.ignorePush=!0),i[e.name]=e.values[0],i.typeOption=t.getEditSetting(i.formType,i.fieldName),i.flowName){var n=i.typeOption.find((function(e){return e.flowName===i.flowName}));i.settingList=n?n.settingList:[]}}else if("user"==e.formType||"single_user"==e.formType||"structure"==e.formType||"checkbox"==e.formType||"position"==e.formType)i.value=e.values;else if("select"==e.formType)"string"!=t.getSettingValueType(i.setting)?i.value=e.values[0]:i.value=e.values;else if("category"==e.formType)i.value=[],t.getProductCategoryValue(i,e.values[0]);else if("map_address"==e.formType){var r=e.values[0].split(",");i.address={state:r.length>0?r[0]:"",city:r.length>1?r[1]:"",area:r.length>2?r[2]:""}}else i.setting=e.setting,i.value=e.values.join(";");i.ignorePush||a.push(i)};for(var s in this.obj.obj)i()}else a=Object(se["z"])(this.obj.form),0==a.length&&a.push(this.getFilterItem());this.form=a,this.name?this.saveName=this.name:this.saveName="",this.isDefault?this.saveDefault=this.isDefault:this.saveDefault=!1}this.visible=this.dialogVisible},deep:!0,immediate:!0},form:function(){this.$nextTick((function(){var e=document.getElementById("scene-filter-container");e.scrollTop=e.scrollHeight}))}},methods:{getEditSetting:function(e,t){var a=this.fieldList.find((function(a){return a.formType==e&&a.fieldName==t}));return a?a.setting:[]},getProductCategoryValue:function(e,t){var a=this;Object(k["o"])().then((function(i){var s=i.data||[],l=[];a.filterProductTree(s,t,l),e.value=l.reverse()})).catch((function(){}))},filterProductTree:function(e,t,a){for(var i=0;i<e.length;i++){var s=e[i];if(s.categoryId==t){a.push(t),this.filterProductTree(e,s.parentId,a);break}}},getFilterItem:function(){return{fieldName:"",name:"",formType:"",isOut:0,condition:"contains",type:3,value:"",setting:[],typeOption:[],settingList:[],flowName:"",settingName:"",address:{state:"",city:"",area:""}}},handleCancel:function(){this.visible=!1,this.$emit("update:dialogVisible",!1)},getError:function(){this.showErrors=!1;for(var e=[],t=0;t<this.form.length;t++){var a=this.form[t];if(""===a.fieldName||void 0===a.fieldName||null===a.fieldName){this.errorType=1,this.showErrors=!0;break}if(e.includes(a.fieldName)){this.errorType=0,this.showErrors=!0;break}e.push(a.fieldName)}return this.showErrors},handleConfirm:function(){var e=this;if(!this.getError())if(this.saveName&&""!==this.saveName){for(var t=0;t<this.form.length;t++){var a=this.form[t];if(!a.fieldName||""===a.fieldName)return void this.$message.error("筛选的字段名称不能为空！");if("business_cause"==a.formType){if(!a.flowName&&!a.settingName)return void this.$message.error("筛选内容不能为空！")}else if("map_address"==a.formType){if(!a.address.state&&!a.address.city&&!a.address.area)return void this.$message.error("筛选内容不能为空！")}else if("date"==a.formType||"datetime"==a.formType){if("isNull"!=a.condition&&"isNotNull"!=a.condition)if(14===a.type){if(Object(C["c"])(a.timeType)&&Object(C["c"])(a.range))return void this.$message.error("筛选内容不能为空！")}else if(Object(C["c"])(a.value))return void this.$message.error("筛选内容不能为空！")}else if("number"==a.formType||"floatnumber"==a.formType||"percent"==a.formType){if("isNull"!=a.condition&&"isNotNull"!=a.condition)if(14===a.type){if(Object(C["c"])(a.min)||Object(C["c"])(a.max))return void this.$message.error("筛选内容不能为空！")}else if(Object(C["c"])(a.value))return void this.$message.error("筛选内容不能为空！")}else if("user"==a.formType||"single_user"==a.formType||"structure"==a.formType||"category"==a.formType||"checkbox"==a.formType||"position"==a.formType){if(Object(C["c"])(a.value)&&"isNull"!=a.condition&&"isNotNull"!=a.condition)return void this.$message.error("筛选内容不能为空！")}else if(Object(C["c"])(a.value)&&"isNull"!=a.condition&&"isNotNull"!=a.condition)return void this.$message.error("筛选内容不能为空！")}var i=[];this.form.forEach((function(t){if("datetime"==t.formType||"date"==t.formType){var a=[];a=14===t.type?Object(C["c"])(t.timeType)?t.range:[t.timeType]:[t.value],i.push({formType:t.formType,name:t.fieldName,type:t.type,values:a})}else if("number"==t.formType||"floatnumber"==t.formType||"percent"==t.formType){var s=[];s=14===t.type?[Object(C["c"])(t.min)?"":t.min,Object(C["c"])(t.max)?"":t.max]:[t.value],i.push({formType:t.formType,name:t.fieldName,type:t.type,values:s})}else if("business_cause"==t.formType)t.flowName&&i.push({formType:t.formType,name:"flowName",type:1,values:[t.flowName]}),t.settingName&&i.push({formType:t.formType,name:"settingName",type:1,values:[t.settingName]});else if("user"==t.formType||"single_user"==t.formType)i.push({type:t.type,values:t.value,formType:t.formType,name:t.fieldName});else if("position"==t.formType)i.push({type:t.type,values:t.value.filter((function(e){return!Object(C["c"])(e.name)})).map((function(e){return JSON.stringify(e)})),formType:t.formType,name:t.fieldName});else if("structure"==t.formType)i.push({type:t.type,values:t.value,formType:t.formType,name:t.fieldName});else if("checkbox"==t.formType)i.push({type:t.type,values:t.value,formType:t.formType,name:t.fieldName});else if("category"==t.formType)i.push({type:1,values:[t.value[t.value.length-1]],formType:t.formType,name:t.fieldName});else if("select"==t.formType){var l=t.value;"string"!=e.getSettingValueType(t.setting)&&(l=[t.value]),i.push({type:t.type,values:l,formType:t.formType,name:t.fieldName})}else if("map_address"==t.formType){var n=[];for(var r in t.address){var o=t.address[r];o&&n.push(o)}i.push({values:[n.join(",")],type:1,formType:t.formType,name:t.fieldName})}else{var c=[];if("string"===typeof t.value){var u=t.value.replace(/；/g,";");c=u.split(";").filter((function(e){return""!==e&&null!==e}))}else c=[t.value];i.push({type:t.type,values:c,formType:t.formType,name:t.fieldName})}}));var s={obj:i,form:this.form,saveDefault:this.saveDefault,saveName:this.saveName};this.requestCreateScene(s)}else this.$message.error("场景名称不能为空！")},requestCreateScene:function(e){var t=this;this.editId?this.config.updateRequest(Object(r["a"])({isDefault:e.saveDefault?1:0,name:e.saveName,sceneId:this.editId,data:JSON.stringify(e.obj)},this.config.updateParams)).then((function(e){t.$message({type:"success",message:"编辑成功"}),t.$emit("save-success"),t.handleCancel()})).catch((function(){})):this.config.saveRequest(Object(r["a"])({isDefault:e.saveDefault?1:0,name:e.saveName,data:JSON.stringify(e.obj)},this.config.saveParams)).then((function(e){t.$emit("save-success"),t.$message({type:"success",message:"创建成功"}),t.handleCancel()})).catch((function(){}))},handleAdd:function(){this.form.push(this.getFilterItem())},handleDelete:function(e){var t=this;this.$confirm("您确定要删除这一条数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.form.splice(e,1),t.getError()})).catch((function(){}))},getSettingValueType:function(e){if(e&&e.length>0){var t=e[0];return Object(m["a"])(t)}return[]}}},re=ne,oe=(a("de2b"),Object(w["a"])(re,ae,ie,!1,null,"7f4c9887",null)),ce=oe.exports,ue={indexRequest:null,indexParams:null,sortRequest:null,sortParams:null,defaultsRequest:null,defaultsParams:null,deleteRequest:null,deleteParams:null,fieldsIndexRequest:null,fieldsIndexParams:null,help:null},fe={name:"SceneSet",components:{draggable:te.a,SceneCreate:ce},props:{dialogVisible:{type:Boolean,required:!0,default:!1},props:Object,createProps:Object,filterFieldsProps:Object,conditionTypeFun:Function},data:function(){return{defaultId:"",visible:!1,isleftIndeterminate:!1,checkleftAll:!1,checkedLeftData:[],leftCheckItems:[],isrightIndeterminate:!1,checkrightAll:!1,checkedRightData:[],rightCheckItems:[],moveItem:{},handlDefaultItem:{},showCreateScene:!1,fieldList:[],filterObj:{form:[]},filterName:"",filterDefault:!1,filterEditId:""}},computed:{config:function(){return Object(H["a"])(Object(r["a"])({},ue),this.props||{})}},watch:{dialogVisible:{handler:function(e){this.visible=e,e&&this.getSceneList()},deep:!0,immediate:!0}},mounted:function(){},methods:{refreshSceneList:function(){this.getSceneList(),this.$emit("save-success")},getSceneList:function(){var e=this;this.config.indexRequest(Object(r["a"])({},this.config.indexParams)).then((function(t){var a=t.data||{};e.checkedLeftData=a.value.map((function(e){return e.check=!1,e.data=e.data?JSON.parse(e.data):[],e})),e.checkedRightData=a.hideValue.map((function(e){return e.check=!1,e.data=e.data?JSON.parse(e.data):[],e}));var i=e.checkedLeftData.filter((function(e){return 1==e.isDefault}));i&&i.length>0?e.defaultId=i[0].sceneId:e.defaultId=""})).catch((function(){}))},handleConfirm:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0!==this.checkedLeftData.length){var a=this.checkedLeftData.filter((function(t){return t.sceneId==e.defaultId}));0==a.length&&(this.defaultId=""),this.config.sortRequest(Object(r["a"])({noHideIds:this.checkedLeftData.map((function(e){return e.sceneId})),hideIds:this.checkedRightData.map((function(e){return e.sceneId}))},this.config.sortParams)).then((function(a){!1!==t&&(e.$message({type:"success",message:"操作成功"}),e.handleCancel()),e.$emit("save-success")})).catch((function(){}))}else this.$message.error("场景不能全部隐藏！")},itemHandle:function(e,t,a){var i=this;t.isTemp?this.$message.error("请保存后操作"):"edit"==e?this.addAndEditScene("edit",t):"delete"==e&&this.$confirm("您确定要删除这一条数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.config.deleteRequest({sceneId:t.sceneId}).then((function(e){i.$message({type:"success",message:"删除成功"}),i.checkedLeftData.splice(a,1),i.leftCheckItemChange(),i.$emit("save-success")})).catch((function(){}))})).catch((function(){}))},defaultHandle:function(e,t){var a=this;this.config.defaultsRequest({sceneId:t.sceneId}).then((function(e){a.$message({type:"success",message:"操作成功"}),a.defaultId=t.sceneId,a.handleConfirm(!1)})).catch((function(){}))},addAndEditScene:function(e,t){var a=this;this.config.fieldsIndexRequest(Object(r["a"])({},this.config.fieldsIndexParams)).then((function(i){var s=i.data||[];a.fieldList=s;var l=s.map((function(e){return e.fieldName}));"edit"==e?(a.fieldList.find((function(e){return"business_cause"===e.formType&&"flowName"===e.fieldName}))&&l.push("settingName"),a.filterObj={form:[],obj:t.data.filter((function(e){return l.includes(e.name)}))},a.filterName=t.name,a.filterDefault=1==t.isDefault,a.filterEditId=t.sceneId.toString()):(a.filterObj={form:[]},a.filterEditId="",a.filterName="",a.filterDefault=!1),a.showCreateScene=!0})).catch((function(){}))},handleCancel:function(){this.visible=!1,this.$emit("update:dialogVisible",!1)},rightMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},rightMove:function(e){this.moveItem=e.draggedContext.element},leftMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},leftMove:function(e){this.moveItem=e.draggedContext.element},handleleftCheckAllChange:function(e){e&&(this.isleftIndeterminate=!1),this.checkedLeftData.forEach((function(t){t.check=e})),this.leftCheckItems=e?this.checkedLeftData.filter((function(e){return e.check})):[]},leftCheckItemChange:function(){this.leftCheckItems=this.checkedLeftData.filter((function(e){return 1==e.check})),this.leftCheckItems.length>0?this.leftCheckItems.length==this.checkedLeftData.length?(this.checkleftAll=!0,this.isleftIndeterminate=!1):(this.checkleftAll=!1,this.isleftIndeterminate=!0):(this.checkleftAll=!1,this.isleftIndeterminate=!1)},handlerightCheckAllChange:function(e){e&&(this.isrightIndeterminate=!1),this.checkedRightData.forEach((function(t){t.check=e})),this.rightCheckItems=e?this.checkedRightData:[]},rightCheckItemChange:function(){this.rightCheckItems=this.checkedRightData.filter((function(e){return 1==e.check})),this.rightCheckItems.length>0?this.rightCheckItems.length==this.checkedRightData.length?(this.checkrightAll=!0,this.isrightIndeterminate=!1):(this.checkrightAll=!1,this.isrightIndeterminate=!0):(this.checkrightAll=!1,this.isrightIndeterminate=!1)},changePositon:function(e){var t=this;"left"==e?(this.checkedRightData=this.checkedRightData.filter((function(e,a,i){var s=!1;return t.rightCheckItems.forEach((function(t,a){e.sceneId==t.sceneId&&(s=!0)})),!s})),this.rightCheckItems.forEach((function(e,a){e.check=!1,e.isTemp=!0,t.checkedLeftData.push(e)})),this.rightCheckItems=[],this.isrightIndeterminate=!1,this.checkrightAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange()):(this.checkedLeftData=this.checkedLeftData.filter((function(e,a,i){var s=!1;return t.leftCheckItems.forEach((function(t,a){e.sceneId==t.sceneId&&(s=!0)})),!s})),this.leftCheckItems.forEach((function(e,a){e.check=!1,t.checkedRightData.push(e)})),this.leftCheckItems=[],this.isleftIndeterminate=!1,this.checkleftAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange())}}},de=fe,pe=(a("8a41"),Object(w["a"])(de,G,Z,!1,null,"08071584",null)),he=pe.exports,me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.visible,"close-on-click-modal":!1,"modal-append-to-body":"","append-to-body":"",title:"高级筛选",width:"900px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[a("div",{staticStyle:{"margin-bottom":"8px"}},[e._v("筛选条件"),e.config.exportHelp?a("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":e.config.exportHelp.type,"data-id":e.config.exportHelp.id}}):e._e()]),e._v(" "),a("filter-fields",{attrs:{"condition-type-fun":e.conditionTypeFun,form:e.form,"field-list":e.fieldList,props:e.config.filterFieldsProps,"show-export":e.config.showExport},on:{"on-field-change":e.getError,"on-field-delete":e.handleDelete,"on-field-export":e.handleExport}}),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:e.showErrors,expression:"showErrors"}],staticClass:"el-icon-warning warning-info"},[a("span",{staticClass:"desc"},[e._v(e._s(e.errorTypes[e.errorType]))])]),e._v(" "),a("el-button",{staticStyle:{"padding-right":"0","padding-left":"0"},attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("+ 添加筛选条件")]),e._v(" "),e.config.showSaveScene?a("div",{staticClass:"save"},[a("el-checkbox",{model:{value:e.saveChecked,callback:function(t){e.saveChecked=t},expression:"saveChecked"}},[e._v("保存为场景")]),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"name",attrs:{maxlength:10,placeholder:"场景名称，最多10个字符"},model:{value:e.saveName,callback:function(t){e.saveName="string"===typeof t?t.trim():t},expression:"saveName"}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"save-setting"},[a("el-checkbox",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:"saveDefault"}},[e._v("设置为默认")]),e.config.help?a("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":e.config.help.type,"data-id":e.config.help.id}}):e._e()],1)],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleConfirm(!1)}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:e.handleCancel}},[e._v("取消")])],1)],1)},ve=[],ye={showExport:!0,showSaveScene:!0,help:null,exportHelp:null,saveRequest:null,saveParams:null,filterFieldsProps:null},be={name:"FilterForm",components:{FilterFields:W},mixins:[],props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:function(){return[]}},obj:{type:Object,required:!0,default:function(){return{}}},conditionTypeFun:Function,props:Object},data:function(){return{form:[],visible:!1,errorTypes:["筛选条件中有重复项！","请选择筛选条件！"],errorType:0,showErrors:!1,saveChecked:!1,saveDefault:!1,saveName:null}},computed:{config:function(){return Object(H["a"])(Object(r["a"])({},ye),this.props||{})}},watch:{dialogVisible:{handler:function(e){e&&(this.form=Object(se["z"])(this.obj.form),0==this.form.length&&this.form.push(this.getFilterItem()),this.saveChecked=!1,this.saveDefault=!1,this.saveName=null),this.visible=this.dialogVisible},deep:!0,immediate:!0}},methods:{handleCancel:function(){this.$emit("update:dialogVisible",!1)},getError:function(){this.showErrors=!1;for(var e=[],t=0;t<this.form.length;t++){var a=this.form[t];if(""===a.fieldName||void 0===a.fieldName||null===a.fieldName){this.errorType=1,this.showErrors=!0;break}if(e.includes(a.fieldName)){this.errorType=0,this.showErrors=!0;break}e.push(a.fieldName)}return this.showErrors},handleConfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.getError())if(!this.saveChecked||this.saveName&&""!==this.saveName){var t={obj:J(this.form),form:this.form,saveChecked:this.saveChecked,saveDefault:this.saveDefault,saveName:this.saveName};this.$emit("filter",t,e),this.saveExportFields()}else this.$message.error("场景名称不能为空！")},saveExportFields:function(){if(this.config.saveRequest){var e=[];this.form.forEach((function(t){1===t.isOut&&e.push(t.fieldName)}));var t=this.config.saveParams?Object(r["a"])({defaultValue:JSON.stringify(e)},this.config.saveParams):{defaultValue:JSON.stringify(e)};this.config.saveRequest(t).then((function(e){})).catch((function(){}))}},handleAdd:function(){this.form.push(this.getFilterItem())},getFilterItem:function(){return{fieldName:"",name:"",formType:"",isOut:0,condition:"contains",type:3,value:"",setting:[],typeOption:[],settingList:[],flowName:"",settingName:"",address:{state:"",city:"",area:""}}},handleDelete:function(e){var t=this;this.$confirm("您确定要删除这一条数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.form.splice(e,1),t.getError()})).catch((function(){}))},handleExport:function(){this.handleConfirm(!0)}}},ge=be,Te=(a("9b24"),Object(w["a"])(ge,me,ve,!1,null,"b6234ade",null)),ke=Te.exports,Ce={showFilterView:!0,showExportFields:!1},xe={name:"WkTableHeader",components:{WkFilterHeader:o["a"],FilterExportFields:X,SceneSet:he,FilterForm:ke},mixins:[A],inheritAttrs:!1,props:{props:Object,filterHeaderProps:Object,filterFormProps:Object,sceneSetProps:Object,sceneCreateProps:Object,conditionTypeFun:Function,fields:[Array,Function]},data:function(){return{filterObj:{form:[],obj:[]},exportFieldsShow:!1,fieldList:[],filterShow:!1,sceneSetShow:!1}},computed:{config:function(){return Object(H["a"])(Object(r["a"])({},Ce),this.props||{})},filterHeaderConfig:function(){return Object(r["a"])({tabSetShow:!0,tabSetLabel:"场景设置",tabSetCommand:"sceneSet"},this.filterHeaderProps||{})},exportFields:function(){return this.filterObj.form?this.filterObj.form.filter((function(e){return 1===e.isOut})):[]},filterValidCount:function(){var e=Object(C["a"])(this.filterObj.obj)?this.filterObj.obj:[],t=2===e.filter((function(e){return"business_cause"===e.formType&&e.values&&e.values.length>0})).length,a=e.filter((function(e){return e.values&&e.values.length>0||[5,6].includes(e.type)}));return t?a.length-1:a.length}},watch:{"config.showExportFields":{handler:function(e){var t=this;return Object(n["a"])(Object(l["a"])().mark((function a(){return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:!t.config.showFilterView||Object(C["a"])(t.fieldList)&&0!==t.fieldList.length||(t.initFieldList(),t.exportFieldsShow=e);case 1:case"end":return a.stop()}}),a)})))()},immediate:!0}},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{filterHeaderHandle:function(e,t){e===this.filterHeaderConfig.tabSetCommand&&(this.sceneSetShow=!0)},collapseHandle:function(e){var t=void 0!==e?e:!this.exportFieldsShow;t!==this.exportFieldsShow&&(this.exportFieldsShow=t,this.$emit("event-change","export-fields-collapse",this.exportFieldsShow))},exportFilter:function(e){this.filterObj.obj=e,this.$emit("filter-change",e)},clearFilterVal:function(e){this.filterObj.obj=[],this.resetAdvancedFilterFieldsValue(e),this.$emit("filter-change",[])},showFilterClick:function(){var e=this;return Object(n["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object(C["a"])(e.fieldList)&&0!==e.fieldList.length){t.next=5;break}return t.next=3,e.initFieldList();case 3:t.next=8;break;case 5:return t.next=7,e.getFieldList();case 7:e.fieldList=t.sent;case 8:e.filterShow=!0;case 9:case"end":return t.stop()}}),t)})))()},initFieldList:function(){var e=this;return Object(n["a"])(Object(l["a"])().mark((function t(){var a,i;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldList();case 2:a=t.sent,i=[],a.forEach((function(t){if(1===t.isOut){var a=Object(se["z"])(t);i.push(e.getAdvancedFilterDefaultItemByFormType(a,t,e.conditionTypeFun))}})),e.fieldList=a,e.filterObj.form=i;case 7:case"end":return t.stop()}}),t)})))()},getFieldList:function(){var e=this;return new Promise((function(t){Object(C["a"])(e.fields)?t(e.fields):e.fields instanceof Function&&e.fields().then((function(e){t(e)}))}))},handleFilter:function(e,t){var a=this;this.filterObj=e,t?this.exportFieldsShow||this.collapseHandle(!0):(this.filterShow=!1,e.saveChecked&&this.sceneCreateProps.saveRequest(Object(r["a"])({isDefault:e.saveDefault?1:0,name:e.saveName,data:JSON.stringify(e.obj)},this.sceneCreateProps.saveParams)).then((function(e){a.updateSceneList()})).catch((function(){})),this.$emit("filter-change",e.obj))},updateSceneList:function(){this.$emit("event-change","scene-refresh")}}},_e=xe,we=(a("b211"),Object(w["a"])(_e,i,s,!1,null,"ab558d46",null));t["a"]=we.exports},"844b":function(e,t,a){"use strict";a("9f87")},"8a41":function(e,t,a){"use strict";a("fc25")},9897:function(e,t,a){},"9b24":function(e,t,a){"use strict";a("9897")},"9f87":function(e,t,a){},b211:function(e,t,a){"use strict";a("e7db")},bb7d:function(e,t,a){"use strict";a("3627")},de2b:function(e,t,a){"use strict";a("3ee3")},e7db:function(e,t,a){},fc25:function(e,t,a){},ff8d:function(e,t,a){}}]);