(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-160ff380"],{2317:function(e,t,a){},"4dbc":function(e,t,a){"use strict";a("b172")},"798d":function(e,t,a){"use strict";a("2317")},"7a17":function(e,t,a){"use strict";var i,s,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"d-view",attrs:{"body-style":{padding:"32px 32px 0",height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"},on:{close:e.hideView}},[a("div",{staticClass:"d-header"},[a("div",{staticClass:"header-title"},[a("span",{staticClass:"title"},[e._v(e._s(e.appraisalPlanName))]),e._v(" "),2==e.subTabType?a("div",{staticClass:"operation"},e._l(e.btnHandler,(function(t,i){return a("el-button",{key:i,attrs:{type:t.type},on:{click:function(a){e.handlerSubmit(t.handle)}}},[e._v(e._s(t.label))])}))):e._e()]),e._v(" "),a("div",{staticClass:"header-user"},[a("div",{staticClass:"header-user-ft"},[a("xr-avatar",{attrs:{name:e.inspectionPeople,size:40}}),e._v(" "),a("div",{staticClass:"user-info"},[a("span",{staticClass:"user-info-label"},[e._v("姓名")]),e._v(" "),a("span",{staticClass:"user-info-name"},[e._v(e._s(e.inspectionPeople))])])],1),e._v(" "),e.assessmentScore?a("div",{staticClass:"header-user-r"},[a("div",{staticClass:"header-user-rt"},[a("span",{staticStyle:{"font-size":"14px",color:"#6b778c"}},[e._v("考核分数")]),e._v(" "),a("span",{staticStyle:{"font-size":"24px",color:"#36b37e"}},[e._v(e._s(e.assessmentScore)+"分")])]),e._v(" "),e.level?a("div",{staticClass:"header-user-rt"},[a("span",{staticStyle:{"font-size":"14px",color:"#6b778c"}},[e._v("评级")]),e._v(" "),a("span",{staticStyle:{"font-size":"24px",color:"#36b37e"}},[e._v(e._s(e.level))])]):e._e()]):e._e()])]),e._v(" "),a("div",{staticStyle:{height:"calc(100% - 130px)","padding-right":"20px","overflow-y":"auto"}},[a("div",{staticClass:"desc"},[a("div",{staticClass:"desc-header"},e._l(e.headerList,(function(t,i){return a("div",{key:i,staticClass:"desc-header-item"},[a("span",[e._v(e._s(t.label))]),e._v(" "),a("span",[e._v(e._s(t.value))])])}))),e._v(" "),a("el-divider"),e._v(" "),a("div",{staticClass:"desc-target"},[a("el-steps",{attrs:{active:e.currentActive,space:150}},e._l(e.activities,(function(t,i){return a("el-step",{key:i},[a("template",{slot:"title"},[a("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[a("span",{staticStyle:{color:"#42526e"}},[e._v(e._s(t.stageName))]),e._v(" "),t.stageName?a("span",{staticStyle:{"font-weight":"700",color:"#172b4d"}},[e._v(e._s(t.stageUserName))]):a("el-tag",{staticStyle:{width:"60px","margin-top":"10px"},attrs:{type:"info"}},[e._v(e._s("结果确认"==t.label?"待审核":"待确认"))])],1)])],2)})))],1)],1),e._v(" "),a("div",{staticClass:"d-container-body"},[a("el-tabs",{attrs:{"nav-mode":"more"},model:{value:e.tabCurrentName,callback:function(t){e.tabCurrentName=t},expression:"tabCurrentName"}},e._l(e.tabNames,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t.label,name:t.name,lazy:""}},[a(t.name,{ref:"childForm",refInFor:!0,tag:"component",attrs:{id:e.id,"sub-tab-type":e.subTabType,"active-tab":e.activeTab},on:{rejectAuthority:e.rejectAuthority,realTime:e.realTime,close:e.success}})],1)})))],1),e._v(" "),e.disallowanceShow?a("el-dialog",{attrs:{title:6==e.activeTab?"申诉":"驳回",visible:e.disallowanceShow,"modal-append-to-body":!1,"append-to-body":!0,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(t){e.disallowanceShow=t}}},[a("el-form",{ref:"disallowanceForm",staticStyle:{padding:"0 40% 0 0"},attrs:{model:e.disallowanceForm,"label-position":"top"}},e._l(e.disallowanceFieldList,(function(t,i){return a("el-form-item",{key:i,attrs:{label:t.name,prop:t.fieldName,rules:t.rules||{}}},["rejectReason"==t.fieldName||"reason"==t.fieldName?a("el-input",{attrs:{type:"textarea",rows:2,resize:"none"},model:{value:e.disallowanceForm[t.fieldName],callback:function(a){e.$set(e.disallowanceForm,t.fieldName,a)},expression:"disallowanceForm[item.fieldName]"}}):e._e(),e._v(" "),"appraisalStageIdList"==t.fieldName?a("el-select",{attrs:{multiple:""},model:{value:e.disallowanceForm[t.fieldName],callback:function(a){e.$set(e.disallowanceForm,t.fieldName,a)},expression:"disallowanceForm[item.fieldName]"}},e._l(e.rejectUserList,(function(e){return a("el-option",{key:e.stageId,attrs:{label:e.stageUserName,value:e.stageId}})}))):e._e(),e._v(" "),"batchId"==t.fieldName?a("xh-files",{attrs:{value:e.batch,props:{multiple:!1}},on:{"value-change":function(a){e.oldChange(a,t,i)}}}):e._e()],1)}))),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.disallowanceShow=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handlerReject}},[e._v("确 定")])],1)],1):e._e()],1)])},l=[],r=(a("a9e3"),a("a434"),a("b0c0"),a("14d9"),a("d3b7"),a("159b"),a("f48e")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("p",{staticStyle:{padding:"12px 12px 0","margin-top":"10px"}},[e._v("当前维度权重总计"),a("span",{staticStyle:{color:"#ffb55f"}},[e._v(e._s(e.weightSum)+"%")])]),e._v(" "),e.assessmentDimensionList&&e.assessmentDimensionList.length?a("assessment-dimension",{ref:"dimensionalityForm",attrs:{"quota-item":e.quotaItem,"assessment-dimension-list":e.assessmentDimensionList,operation:!0}}):e._e()],1)},c=[],d=a("5530"),m=a("2909"),u=(a("4de4"),a("b64b"),a("05b4")),p={name:"FillInIndicator",components:{AssessmentDimension:u["a"]},inject:["rootTabs"],props:{id:String},data:function(){return{loading:!1,assessmentDimensionList:[],quotaItem:{}}},computed:{weightSum:function(){var e=0;return this.assessmentDimensionList.forEach((function(t){e+=t.dimensionWeight})),e}},watch:{"rootTabs.currentName":{handler:function(e){"FillInIndicator"===e&&(this.assessmentDimensionList=[],this.quotaItem={},this.getList())},immediate:!0}},methods:{getList:function(){var e=this;this.loading=!0,Object(r["p"])({appraisalEmployeeId:this.id,isScoring:!1}).then((function(t){var a=t.data.dimensionVOList||[];for(var i in a.forEach((function(t,a){var i;e.quotaItem["table"+(+new Date+a)]=[],e.assessmentDimensionList.push({dimensionName:t.dimensionName,dimensionWeight:t.dimensionWeight,quotaType:t.quotaType,isAllowEdit:t.isAllowEdit,dimensionId:t.dimensionId,key:+new Date+a}),(i=e.quotaItem["table"+(+new Date+a)]).push.apply(i,Object(m["a"])(t.achievementsQuotaVOList))})),e.quotaItem)e.quotaItem[i].push({});e.loading=!1})).catch((function(){e.$emit("close"),e.loading=!1}))},sendClick:function(){var e=this,t=!0,a=!0;this.assessmentDimensionList.forEach((function(t,i){if(t.isAllowEdit){var s=0;e.$refs.dimensionalityForm.tableForm["table"+t.key].forEach((function(e){s+=e.quotaWeight||0})),100!==s&&(a=!1)}})),this.$refs.dimensionalityForm.$refs.form.forEach((function(i){i.validate((function(i){if(t){if(i)if(a){if(a&&i){var s=[];e.assessmentDimensionList.forEach((function(t,a){t.isAllowEdit&&s.push(Object(d["a"])(Object(d["a"])({},t),{},{appraisalEmployeeQuotaBOList:e.$refs.dimensionalityForm.tableForm["table"+t.key].filter((function(e){return Object.keys(e).length&&!e.preset}))}))})),e.submiteParams(s)}}else e.$message.error("指标权重总和需等于100%");else e.$message.error("请完善信息");t=!1}}))}))},submiteParams:function(e){var t=this,a={appraisalEmployeeDimensionBOList:e,appraisalEmployeeId:this.id};Object(r["a"])(a).then((function(e){t.$message.success("保存成功"),t.close()})).catch((function(){t.close()}))},close:function(){this.$emit("close")}}},h=p,v=a("2877"),f=Object(v["a"])(h,o,c,!1,null,null,null),b=f.exports,g=a("c7c5"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"empty",rawName:"v-empty",value:e.list,expression:"list"}],staticClass:"rc-cont",staticStyle:{"min-height":"500px","padding-right":"10%","margin-top":"20px"}},e._l(e.list,(function(t,i){return a("flexbox",{key:i,staticClass:"ha-cont",attrs:{align:"stretch",justify:"flex-start"}},[a("div",{staticClass:"ha-week"},[e._v(e._s(e._f("filterTimestampToFormatTime")(t.createTime,"MM-DD dddd")))]),e._v(" "),a("div",{staticClass:"ha-circle"}),e._v(" "),a("div",{staticClass:"ha-time"},[e._v(e._s(e._f("filterTimestampToFormatTime")(t.createTime,"HH:mm")))]),e._v(" "),a("HrmAvatar",{staticClass:"ha-img",attrs:{id:t.createUserId,name:t.realname,size:32,src:t.img,disabled:!1}}),e._v(" "),a("div",{staticClass:"ha-name"},[e._v(e._s(t.realname))]),e._v(" "),a("div",{staticClass:"ha-content"},[a("p",[e._v(e._s(t.content))]),e._v(" "),t.fileEntity&&"file"==t.fileEntity.fileType?a("div",{staticStyle:{display:"flex","margin-top":"10px"}},[a("div",{staticClass:"cell-hd first-show"},[a("i",{staticClass:"wk wk-file"})]),e._v(" "),a("div",{staticClass:"cell-hd cell-label first-show",staticStyle:{"flex-shrink":"0","margin-right":"0"}},[e._v("\n          附件：\n        ")]),e._v(" "),a("div",{staticClass:"cell-bd cell-label text-one-line"},[e._v("\n          "+e._s(t.fileEntity.name)+"\n        ")]),e._v(" "),a("div",{staticClass:"cell-ft"},[a("span",{staticClass:"des"},[e._v("（"+e._s(e._f("getFileSize")(t.fileEntity.size))+"）")]),e._v(" "),a("a",{on:{click:function(a){e.previewImg(t.fileEntity,0)}}},[e._v("预览")]),e._v(" "),a("a",{on:{click:function(a){e.downloadFile(t.fileEntity)}}},[e._v("下载")])])]):e._e()]),e._v(" "),a("div",{staticClass:"ha-line"})],1)})))},_=[],T=(a("d81d"),a("7078")),w=a("5f0b"),N={name:"HrmAvatar",extends:w["a"],methods:{getUserData:function(){var e=this;Object(T["D"])(this.id).then((function(t){var a=t.data||null;e.userData=a?Object(d["a"])(Object(d["a"])({},a),{},{name:a.employeeName,realname:a.employeeName}):null})).catch((function(){}))}}},j=N,C=Object(v["a"])(j,i,s,!1,null,null,null),S=C.exports,x=a("ed08"),F={name:"InspectionRecords",filters:{getFileSize:function(e){return Object(x["g"])(e)}},components:{HrmAvatar:S},inject:["rootTabs"],props:{id:[String,Number]},data:function(){return{loading:!1,list:[]}},watch:{"rootTabs.currentName":function(e){"InspectionRecords"===e&&this.getDetail(!1)}},mounted:function(){this.getDetail()},methods:{getDetail:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading=t,Object(r["l"])({typeId:this.id}).then((function(t){e.loading=!1,e.list=t.data.map((function(e){return e.createTime=new Date(e.createTime).getTime(),e}))})).catch((function(){e.loading=!1}))},previewImg:function(e,t){var a=[e];this.$wkPreviewFile.preview({index:t,data:a})},downloadFile:function(e){Object(x["e"])({path:e.url,name:e.name})}}},I=F,k=(a("4dbc"),Object(v["a"])(I,y,_,!1,null,"4efe3949",null)),L=k.exports,D=a("130f"),E=a("215e"),$=a("5824"),A=a("f068"),O=a("0730"),q={name:"EmployeeDetails",components:{SlideView:D["a"],FillInIndicator:b,ScoreAndDetial:g["a"],InspectionRecords:L,WkFormItems:E["default"],WkTextarea:$["a"],XhFiles:A["a"]},mixins:[O["a"]],props:{id:String,activeTab:[String,Number],subTabType:[String,Number],appraisalPlanName:String},data:function(){return{loading:!1,headerList:[{label:"考核计划",value:"",prop:"appraisalPlanName"},{label:"考核周期",value:"",prop:"appraisalCycleType"},{label:"部门",value:"",prop:"deptName"},{label:"岗位",value:"",prop:"post"},{label:"聘用形式",value:"",prop:"employmentForms"}],appraisalCycleType:{1:"月度",2:"季度",3:"上半年",4:"下半年",5:"全年"},activities:[],currentActive:null,assessmentScore:"",inspectionPeople:"",level:"",assessmentDimensionList:[],quotaItem:{},targetRejectAuth:!0,disallowanceShow:!1,disallowanceForm:{},isRejectAuthority:!1,rejectUserList:[],batch:[]}},computed:{tabNames:function(){var e=[{label:"考核评分",name:"FillInIndicator"},{label:"考核评分",name:"ScoreAndDetial"},{label:"考核记录",name:"InspectionRecords"}];return 1==this.activeTab&&2==this.subTabType?e.splice(1,2):1==this.activeTab&&1==this.subTabType?e.splice(0,1):2==this.activeTab&&2==this.subTabType?(e.splice(0,1),e.splice(1,1)):2!=this.activeTab&&4!=this.activeTab||1!=this.subTabType?4==this.activeTab&&2==this.subTabType?(e.splice(2,1),e.splice(0,1)):5!=this.activeTab&&6!=this.activeTab&&7!=this.activeTab||2!=this.subTabType&&1!=this.subTabType&&5!=this.subTabType||e.splice(0,1):e.splice(0,1),e},tabCurrentName:function(){return this.tabNames[0].name},btnHandler:function(){var e=5==this.activeTab?"审核":"提交",t=[{label:e,type:"primary",handle:"submit"}];return 2==this.activeTab&&this.targetRejectAuth||4==this.activeTab&&this.isRejectAuthority?t.push({label:"驳回",type:"",handle:"reject"}):6==this.activeTab?t.push({label:"申诉",type:"",handle:"reject"}):5!=this.activeTab&&7!=this.activeTab||t.push({label:"驳回",type:"",handle:"reject"}),t},disallowanceFieldList:function(){var e=[];return 2==this.activeTab||4==this.activeTab?e=[{name:"驳回原因",fieldName:"rejectReason",rules:{required:!0,message:"驳回原因不能为空",trigger:"blur"}}]:5==this.activeTab?(this.getRejectUserList(),e=[{name:"驳回原因",fieldName:"reason",rules:{required:!0,message:"驳回原因不能为空",trigger:"blur"}},{name:"评分节点",fieldName:"appraisalStageIdList",rules:{required:!0,message:"请选择申诉节点",trigger:"change"}}]):6==this.activeTab?(this.getRejectUserList(),e=[{name:"申诉原因",fieldName:"reason",rules:{required:!0,message:"驳回原因不能为空",trigger:"blur"}},{name:"评分节点",fieldName:"appraisalStageIdList",rules:{required:!0,message:"请选择申诉节点",trigger:"change"}},{name:"驳回说明",fieldName:"batchId"}]):7==this.activeTab&&(e=[{name:"驳回原因",fieldName:"reason",rules:{required:!0,message:"驳回原因不能为空",trigger:"blur"}}]),e}},created:function(){this.getDetialHeader()},methods:{getDetialHeader:function(){var e=this;Object(r["o"])({id:this.id}).then((function(t){e.activities=t.data||[]})).catch((function(){e.hideView()})),Object(r["j"])({id:this.id}).then((function(t){var a=t.data||{};e.currentActive=a.stageSort,e.inspectionPeople=a.employeeName,e.assessmentScore=a.score,e.level=a.level,e.targetRejectAuth=a.canRejectTarget,e.headerList.forEach((function(t){for(var i in a)t.prop==i&&("appraisalCycleType"==t.prop?t.value=e.appraisalCycleType[a[i]]?e.appraisalCycleType[a[i]]:a[i]:"employmentForms"==t.prop?t.value=1==a[i]?"正式":"非正式":t.value=a[i])}))}))},handlerSubmit:function(e){var t=this;"submit"==e?this.$refs.childForm[0].sendClick():"reject"==e&&(this.disallowanceShow=!0,this.disallowanceFieldList.forEach((function(e){t.$set(t.disallowanceForm,e.fieldName,"")})),this.batch=[],this.$nextTick((function(){t.$refs.disallowanceForm.clearValidate()})))},handlerReject:function(){var e,t=this;2==this.activeTab?e=r["z"]:4==this.activeTab?e=r["r"]:5==this.activeTab?e=r["w"]:6==this.activeTab?(e=r["s"],this.disallowanceForm["batchId"]=this.batch.length?this.batch[0].batchId:""):7==this.activeTab&&(e=r["u"]),this.$refs.disallowanceForm.validate((function(a){a?(t.disallowanceForm["appraisalEmployeeId"]=t.id,e(t.disallowanceForm).then((function(e){t.$message.success("操作成功"),t.success()}))):t.$message.error("请完善基本信息")}))},rejectAuthority:function(e){this.isRejectAuthority=e},getRejectUserList:function(){var e=this,t=this.activities[this.currentActive-1].appraisalEmployeeId;Object(r["m"])({id:t}).then((function(t){e.rejectUserList=t.data}))},oldChange:function(e,t,a){e.value.length>1&&this.batch.splice(0,1)},realTime:function(e){this.assessmentScore=e.assessmentScore,this.level=e.level},hideView:function(){this.$emit("hide-view")},success:function(){this.hideView(),this.$emit("success")}}},R=q,z=(a("798d"),Object(v["a"])(R,n,l,!1,null,"86d34d7e",null));t["a"]=z.exports},b172:function(e,t,a){}}]);