(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4988dab0"],{"07bc":function(e,t,a){"use strict";a("e299")},3214:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var r=a("b775");function n(e){return Object(r["a"])({url:"hrmEmployeeLeaveRecord/queryLeaveRecordPageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function i(e){return Object(r["a"])({url:"hrmEmployeeLeaveRecord/queryLeaveTypeList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(r["a"])({url:"hrmEmployeeLeaveRecord/export",method:"post",responseType:"blob",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}},"3d4e":function(e,t,a){"use strict";var r=a("5530"),n=(a("ac1f"),a("841c"),a("14d9"),a("de91")),i=a("6bfe");t["a"]={created:function(){this.getFieldList()},data:function(){return{loading:!1,createType:"",tableHeight:document.documentElement.clientHeight-260,list:[],fieldList:[],currentPage:1,pageSize:15,pageSizes:[15,30,60,100],total:0,otherParams:{},request:"",sortData:{},popoverFilterWidth:150,attendanceDetailDialog:!1,attendanceDetail:{},statusMap:n["a"],params:{}}},computed:{searchComputed:function(){return this.$parent.search||this.search},date:function(){return this.$parent.month||this.month},filterObjComputed:function(){return this.$parent.filterObj||this.filterObj},times:function(){return[this.$moment(this.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD"),this.$moment(this.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD")]}},methods:{sortChange:function(e,t,a){this.currentPage=1,this.sortData=e||{},this.getList()},rowClick:function(){"punching"==this.recordType&&(this.attendanceDetailDialog=!0,this.attendanceDetail={})},getMonthField:function(e,t){for(var a=[],r=this.getCurrentMonthDay(e,t),n=1;n<=r;n++)a.push({fieldName:"day"+n,name:n+"",width:100});return a},getCurrentMonthDay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).getFullYear(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).getMonth()+1,a=new Date(e,t,0);return a.getDate()},refreshList:function(){this.handleCurrentChange(1)},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},fieldFormatter:function(e,t){return"clockType"==t.property?{1:"上班打卡",2:"下班打卡"}[e[t.property]]||"--":"type"==t.property?{1:"手机端打卡",2:"HR添加",3:"自动打卡"}[e[t.property]]||"--":"attendanceTime"==t.property?e[t.property].split(" ").shift():Object(i["c"])(e[t.property])?"--":e[t.property]},getList:function(e){var t=this;this.$refs.originalTable&&this.$refs.originalTable.clearSelection(),this.loading=!0;var a={page:this.currentPage,limit:this.pageSize,search:this.searchComputed,times:this.times},n=this.request,i=this.otherParams;for(var o in this.filterObjComputed)a[o]=this.filterObjComputed[o];this.sortData.order&&(a.sortField=this.sortData.prop,a.order="ascending"==this.sortData.order?2:1),this.params=Object(r["a"])(Object(r["a"])({},a),i),n(Object(r["a"])(Object(r["a"])({},a),i)).then((function(a){t.loading=!1,t.list=a.data.list,t.total=a.data.totalRow,a.data.totalRow&&Math.ceil(a.data.totalRow/t.pageSize)<t.currentPage&&t.currentPage>1?(t.currentPage=t.currentPage-1,t.getList()):(t.total=a.data.totalRow,t.loading=!1),t.$nextTick((function(){var e=document.querySelector(".el-table__body-wrapper");e.scrollTop=1,0!=e.scrollLeft&&(e.scrollLeft=e.scrollLeft-1)})),e&&e()})).catch((function(){t.loading=!1}))}}}},de91:function(e,t,a){"use strict";t["a"]=[{value:0,color:"#333333",label:"正常",backgroundColor:"#f5f6f7"},{value:1,color:"#e83d22",label:"迟到",backgroundColor:"#ffeeee"},{value:2,color:"#e83d22",label:"早退",backgroundColor:"#ffeeee"},{value:3,color:"#ff7c18",label:"缺卡",backgroundColor:"#fff5e5"},{value:4,color:"#ff7c18",label:"旷工",backgroundColor:"#fff5e5"},{value:5,color:"#7fcb27",label:"外勤",backgroundColor:"#e9f7eb"},{value:6,color:"#809aaa",label:"请假",backgroundColor:"#f3f3ff"},{value:7,color:"#3da8f5",label:"加班",backgroundColor:"#e5f6fe"},{value:8,color:"#7fcb27",label:"出差",backgroundColor:"#e9f7eb"},{value:9,color:"#333333",label:"休息",backgroundColor:"#f5f6f7"}]},e299:function(e,t,a){},f8e3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"clock-index",attrs:{id:"employee-main-container"}},[a("wk-page-header",{attrs:{title:"请假记录",dropdowns:e.headerMoreHandle},on:{command:e.headerMoreHandleClick}}),e._v(" "),a("wk-filter-header",{attrs:{props:{searchPlaceholder:"请输入员工姓名/工号"}},on:{"event-change":e.filterHeaderHandle}},[a("template",{slot:"left-start"},[a("el-date-picker",{staticClass:"margin-left-interval",attrs:{clearable:!1,"value-format":"yyyy-MM",format:"",type:"month",placeholder:"选择月"},on:{change:e.refreshList},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1),e._v(" "),a("template",{slot:"right"},[e.hasFilterContent?a("el-button",{attrs:{type:"text"},on:{click:e.resetFilter}},[e._v("清除筛选")]):e._e(),e._v(" "),a("wk-popover-filter",{ref:"popoverFilter",staticClass:"margin-left-interval",attrs:{width:e.popoverFilterWidth,"field-from":e.filterObj,"field-list":e.filterList,"has-content":e.hasFilterContent,placement:"bottom"},on:{"update:fieldFrom":function(t){e.filterObj=t},sure:e.refreshList,reset:e.resetFilter},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return[a("el-select",{staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.leaveChange},model:{value:e.filterObj[r.field],callback:function(t){e.$set(e.filterObj,r.field,t)},expression:"filterObj[data.field]"}},e._l(r.setting,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})))]}}])})],1)],2),e._v(" "),a("div",{staticClass:"crm-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"table","cell-class-name":e.cellClassName,"row-height":40,data:e.list,height:e.tableHeight,"use-virtual":"",stripe:"",border:"","highlight-current-row":""},on:{"sort-change":e.sortChange}},[e._l(e.fieldList,(function(t,r){return a("el-table-column",{key:r,attrs:{fixed:0==r,prop:t.fieldName,label:t.name,"min-width":t.width,formatter:e.fieldFormatter,sortable:"","show-overflow-tooltip":""}})})),e._v(" "),a("el-table-column")],2),e._v(" "),a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},n=[],i=a("5530"),o=(a("14d9"),a("b64b"),a("ac1f"),a("841c"),a("0f4c")),l=a("3214"),s=a("fdca"),c=a("1bfc"),d=a("9011"),h=a("c1df"),u=a.n(h),f=a("2f62"),p=a("ed08"),m=a("3d4e"),g={components:{WkPageHeader:s["a"],WkFilterHeader:c["a"],WkPopoverFilter:d["a"]},mixins:[m["a"]],data:function(){return{request:l["c"],month:u()().format("YYYY-MM"),search:"",popoverFilterWidth:150,filterObj:{},leaveTypeList:[],rowID:""}},computed:Object(i["a"])(Object(i["a"])({},Object(f["b"])(["collapse","hrm"])),{},{attendanceAuth:function(){return this.hrm&&this.hrm.attendance},exportLeaveRecordAuth:function(){return this.attendanceAuth&&this.attendanceAuth.exportLeaveRecord},headerMoreHandle:function(){var e=[];return this.exportLeaveRecordAuth&&e.push({command:"export",name:"导出",icon:"wk wk-export"}),e},hasFilterContent:function(){if(this.filterObj){for(var e=!1,t=Object.keys(this.filterObj),a=0;a<t.length;a++){var r=t[a];""!=this.filterObj[r]&&this.filterObj[r]!=[]&&null!=this.filterObj[r]&&void 0!=this.filterObj[r]&&(e=!0)}return e}return!1},filterList:function(){return[{name:"部门",field:"deptIds",formType:"structure",radio:!1,props:{dataType:"hrm"},request:o["e"],setting:[]},{name:"请假类型",field:"leaveTypes",formType:"leaveTypes",clearable:!0,setting:this.leaveTypeList}]}}),watch:{collapse:{handler:function(e){this.popoverFilterWidth=document.documentElement.clientWidth-(e?89:225)},immediate:!0}},created:function(){var e=this;window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-190},this.getLeaveType()},methods:{getLeaveType:function(){var e=this;Object(l["b"])().then((function(t){e.leaveTypeList=t.data||[]}))},detailHandleCallBack:function(){},resetFilter:function(){this.filterObj={},this.refreshList()},filterHeaderHandle:function(e,t){"search"===e&&(this.search=t,this.refreshList())},getFieldList:function(){this.fieldList=[{fieldName:"employeeName",name:"姓名",width:100},{fieldName:"jobNumber",name:"工号",width:100},{fieldName:"deptName",name:"部门",width:100},{fieldName:"post",name:"岗位",width:100},{fieldName:"leaveType",name:"请假类型"},{fieldName:"leaveStartTime",name:"请假开始时间"},{fieldName:"leaveEndTime",name:"请假结束时间"},{fieldName:"leaveDay",name:"请假天数"},{fieldName:"leaveReason",name:"请假事由"},{fieldName:"remark",name:"备注"}],this.getList()},leaveChange:function(){this.$set(this.$refs.popoverFilter.$data.from,"leaveTypes",this.filterObj.leaveTypes)},refreshList:function(){this.handleCurrentChange(1)},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},headerMoreHandleClick:function(e){var t=this;"export"==e&&(this.loading=!0,Object(l["a"])(this.params).then((function(e){Object(p["d"])(e),t.loading=!1})).catch((function(){t.loading=!1})))},cellClassName:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return""}}},b=g,v=(a("07bc"),a("2877")),y=Object(v["a"])(b,r,n,!1,null,"7feb3936",null);t["default"]=y.exports}}]);