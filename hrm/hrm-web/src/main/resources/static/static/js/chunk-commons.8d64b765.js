(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"09c7":function(e,t,i){},"0add":function(e,t,i){"use strict";i("2606")},"115e":function(e,t,i){},"11ef":function(e,t,i){},"189f":function(e,t,i){"use strict";i("11ef")},1924:function(e,t,i){},1926:function(e,t,i){e.exports={colorPrimary:"#0052cc",colorBlack:"#172b4d",colorSuccess:"#36b37e",colorWarning:"#ffab00",colorDanger:"#ff5630",colorN40:"#dfe1e6",axisLineColor:"#dfe1e6",axisLabelFontWeight:"500"}},"1bfc":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-filter-header"},[i("flexbox",{directives:[{name:"show",rawName:"v-show",value:!e.selectionList||0===e.selectionList.length,expression:"!selectionList || selectionList.length === 0"}],staticClass:"filter-wrap"},[e.config.showSearch?i("el-input",{staticClass:"search-input",attrs:{placeholder:e.config.searchPlaceholder},on:{input:e.inputChange},nativeOn:{keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInput(t)}},model:{value:e.inputContent,callback:function(t){e.inputContent="string"===typeof t?t.trim():t},expression:"inputContent"}},[i("el-button",{attrs:{slot:"suffix",type:"icon",icon:"wk wk-sousuo"},on:{click:e.searchInput},slot:"suffix"})],1):e._e(),e._v(" "),e._t("left-start"),e._v(" "),i("div",{ref:"filterTabs",staticClass:"tabs"},[e.showTabs&&e.showTabs.length>0?[i("span",{staticClass:"tabs-label"},[e._v("显示:")]),e._v(" "),e._l(e.showTabs,(function(t,n){return i("el-button",{key:n,attrs:{title:t.label,type:t.value===e.currentActiveTab?"selected":null,icon:t.icon},on:{click:function(i){e.tabsClick(t)}}},[e._v(e._s(t.label))])}))]:e._e(),e._v(" "),e.config.tabSetShow||e.otherTabs.length>0||e.$slots.dropdownMore?i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.otherClick}},[i("el-button",{staticClass:"dropdown-btn",attrs:{type:e.otherActiveTabName?"selected":null}},[i("span",[e._v(e._s(e.otherActiveTabName))]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down",staticStyle:{"margin-left":"0"}})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.otherTabs,(function(t,n){return i("el-dropdown-item",{key:n,class:{"is-select":e.currentActiveTab===t.value},attrs:{command:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])})),e._v(" "),i("div",{class:{"none-other":0===e.otherTabs.length}},[e._t("dropdownMore")],2),e._v(" "),e.config.tabSetShow?i("el-dropdown-item",{attrs:{divided:e.otherTabs.length>0,command:e.config.tabSetCommand}},[i("span",{staticClass:"wk-filter-btn"},[i("i",{staticClass:"wk wk-manage"}),e._v(e._s(e.config.tabSetLabel)+"\n            ")])]):e._e()],2)],1):e._e(),e._v(" "),e._t("left-end")],2),e._v(" "),i("div",{staticClass:"filter-right"},[e._t("right")],2)],2),e._v(" "),e.selectionList&&e.selectionList.length>0?i("flexbox",{staticClass:"selection-bar"},[i("div",{staticClass:"selected—title"},[e._v("已选中 "),i("span",{staticClass:"selected—count"},[e._v(e._s(e.selectionList.length))]),e._v(" 项")]),e._v(" "),i("flexbox",{staticClass:"selection-items-box"},e._l(e.operations,(function(t,n){return i("el-button",{key:n,attrs:{icon:t.icon,size:"medium"},on:{click:function(i){e.selectionBarClick(t.type)}}},[e._v(e._s(t.name))])})))],1):e._e(),e._v(" "),e._t("default")],2)},a=[],s=i("b85c"),o=(i("a9e3"),i("fb6a"),i("7db0"),i("d3b7"),i("ac1f"),i("841c"),i("4de4"),i("a630"),i("3ca3"),i("caad"),i("8ed6")),l=i("7a1a"),r={name:"WkFilterHeader",components:{},props:{props:Object,search:String,selectionList:Array,activeTab:[String,Number],tabs:Array,operations:{type:Array,default:function(){return[]}}},data:function(){return{inputContent:"",currentActiveTab:"",currentMaxTabCount:5,observer:null}},computed:{config:function(){return Object(o["a"])({showSearch:!0,searchPlaceholder:"",maxTabCount:5,tabSetShow:!1,tabSetLabel:"设置",tabSetCommand:"set"},this.props||{})},showTabs:function(){return this.tabs&&this.tabs.length>this.currentMaxTabCount?this.tabs.slice(0,this.currentMaxTabCount):this.tabs},otherTabs:function(){return this.tabs&&this.tabs.length>this.currentMaxTabCount?this.tabs.slice(this.currentMaxTabCount):[]},otherActiveTabName:function(){var e=this;if(!this.tabs||!this.tabs.length||!this.otherTabs.length)return"";var t=this.otherTabs.find((function(t){return t.value===e.currentActiveTab}));return t?t.label:""}},watch:{activeTab:{handler:function(){void 0!==this.activeTab&&null!==this.activeTab&&this.currentActiveTab!==this.activeTab&&(this.currentActiveTab=this.activeTab)},immediate:!0},tabs:{handler:function(){this.changeTabsSize()},immediate:!0},search:{handler:function(){this.inputContent!==this.search&&(this.inputContent=this.search)},immediate:!0}},created:function(){this.debounceResizeWindow=Object(l["debounce"])(300,this.resizeWindow)},mounted:function(){this.debounceResizeWindow(),this.domUpdate(),window.addEventListener("resize",this.debounceResizeWindow)},beforeDestroy:function(){window.removeEventListener("resize",this.debounceResizeWindow),this.observer&&this.observer.disconnect()},methods:{resizeWindow:function(){this.currentMaxTabCount=this.config.maxTabCount,this.changeTabsSize()},domUpdate:function(){var e=this,t={attributes:!0,childList:!0,subtree:!0},i=function(t){var i,n=Object(s["a"])(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;"childList"===a.type&&e.debounceResizeWindow()}}catch(o){n.e(o)}finally{n.f()}},n=new MutationObserver(i);n.observe(this.$el,t),this.observer=n},changeTabsSize:function(){var e=this;this.$nextTick((function(){var t=e.$refs.filterTabs;if(t)for(var i=t.getBoundingClientRect(),n=i.x+i.width,a=Array.from(t.childNodes||[]).filter((function(e){return["DIV","BUTTON","SPAN"].includes(e.tagName)})),s=a.length-1;s>=0;s--){var o=a[s],l=o.getBoundingClientRect(),r=l.x+l.width;if(!(r>n))break;e.currentMaxTabCount--}}))},searchInput:function(){this.$emit("event-change","search",this.inputContent)},inputChange:function(){this.$emit("update:search",this.inputContent),this.$emit("event-change","searchUpdate",this.inputContent)},otherClick:function(e){if(e===this.config.tabSetCommand)this.$emit("event-change",e);else{var t=this.tabs.find((function(t){return t.value===e}));t?this.tabsClick(t):this.$emit("event-change",e)}},tabsClick:function(e){this.currentActiveTab=e.value,this.debounceResizeWindow(),this.$emit("update:activeTab",this.currentActiveTab),this.$emit("tabs-change",e)},selectionBarClick:function(e){this.$emit("operations-click",e)}}},c=r,d=(i("2f69"),i("9187"),i("2877")),u=Object(d["a"])(c,n,a,!1,null,"7a6f438c",null);t["a"]=u.exports},"1f77":function(e,t,i){"use strict";i("be09")},"215e":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{staticClass:"wk-form-items",attrs:{align:"flex-start",wrap:"wrap",justify:"flex-start"}},[e._l(e.fieldList,(function(t,n){return[i("wk-form-item",{key:n,attrs:{"prop-prefix":e.propPrefix,item:t,index:n,"field-from":e.fieldFrom,"ignore-fields":e.ignoreFields,disabled:t.disabled||e.disabled},on:{change:e.fieldChange},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("default",null,{data:t.data,index:t.index})]}}])})]}))],2)},a=[],s=i("c04c"),o={name:"WkFormItems",components:{WkFormItem:s["default"]},props:{propPrefix:{type:String,default:""},fieldFrom:{type:Object,default:function(){return{}}},fieldList:{type:Array,default:function(){return[]}},ignoreFields:{type:Array,default:function(){return[]}},disabled:Boolean},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{fieldChange:function(e,t,i,n){this.$emit("change",e,t,i,n)}}},l=o,r=i("2877"),c=Object(r["a"])(l,n,a,!1,null,"6ab965fa",null);t["default"]=c.exports},2309:function(e,t,i){"use strict";i("d302")},2606:function(e,t,i){},2682:function(e,t,i){"use strict";i("1924")},"273f":function(e,t,i){e.exports={colorPrimary:"#0052cc",colorBlack:"#172b4d",colorSuccess:"#36b37e",colorWarning:"#ffab00",colorDanger:"#ff5630",colorN40:"#dfe1e6",axisLineColor:"#dfe1e6",axisLabelFontWeight:"500"}},"29fc":function(e,t,i){},"2a90":function(e,t,i){},"2d2d":function(e,t,i){"use strict";i("bb22")},"2e03":function(e,t,i){"use strict";i("7949")},"2f69":function(e,t,i){"use strict";i("1926")},"32dc":function(e,t,i){},"3b0f":function(e,t,i){},"3f02":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-file-select",on:{click:e.handleClick}},[e._t("default")],2)},a=[],s=(i("b0c0"),{name:"WkFileSelect",components:{},props:{name:{type:String,default:"file"},disabled:Boolean,multiple:Boolean,accept:{type:String,default:"*.*"}},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{handleChange:function(e){var t=e.target.files;t&&this.$emit("change",t,e)},handleClick:function(){var e=this;this.disabled||this.$wkFile.select({name:this.name,multiple:this.multiple,accept:this.accept}).then((function(t){e.handleChange(t)}))}}}),o=s,l=(i("e1e1"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"b95eaae0",null);t["a"]=r.exports},"3fe8":function(e,t,i){"use strict";i("e0f0")},"43b6":function(e,t,i){"use strict";i.d(t,"a",(function(){return Ue})),i.d(t,"b",(function(){return p}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"add-node-btn"},[e.showAdd?i("el-popover",{attrs:{"visible-arrow":!1,placement:"right",trigger:"click","popper-class":"no-padding-popover"},model:{value:e.popoverShow,callback:function(t){e.popoverShow=t},expression:"popoverShow"}},[i("div",{staticClass:"add-node-approve"},[e.WkApproveFlow.config.examineAddShow?i("div",{staticClass:"add-node-approve-btn",on:{click:function(t){e.selectClick("approve")}}},[i("i",{staticClass:"wk wk-associate is-orange"}),e._v("审批人\n      ")]):e._e(),e._v(" "),e.WkApproveFlow.config.conditionAddShow?i("div",{staticClass:"add-node-approve-btn",on:{click:function(t){e.selectClick("condition")}}},[i("i",{staticClass:"wk wk-approve is-green"}),e._v("条件分支\n      ")]):e._e(),e._v(" "),e.WkApproveFlow.config.copyAddShow?i("div",{staticClass:"add-node-approve-btn",on:{click:function(t){e.selectClick("copy")}}},[i("i",{staticClass:"wk wk-source-line"}),e._v("抄送节点\n      ")]):e._e(),e._v(" "),e.WkApproveFlow.eventObj.copy?i("div",{staticClass:"add-node-approve-btn",on:{click:function(t){e.selectClick("paste")}}},[i("i",{staticClass:"wk wk-icon-transfer2"}),e._v("粘贴\n      ")]):e._e()]),e._v(" "),i("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-plus",circle:""},slot:"reference"})],1):e._e()],1)},a=[],s={name:"AddNodeBtn",components:{},inject:["WkApproveFlow"],props:{},data:function(){return{popoverShow:!1}},computed:{showAdd:function(){return this.WkApproveFlow.config.examineAddShow||this.WkApproveFlow.config.conditionAddShow||this.WkApproveFlow.config.copyAddShow}},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{selectClick:function(e){this.popoverShow=!1,this.$emit("command",e)}}},o=s,l=i("2877"),r=Object(l["a"])(o,n,a,!1,null,null,null),c=r.exports,d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"condition-node"},[i("div",{staticClass:"condition-node-wrap"},[i("div",{staticClass:"condition-wrap",class:{"is-error":e.node.isError,"is-disabled":e.disabled},on:{click:e.click}},[i("div",{staticClass:"header"},[e.isEdit?i("el-input",{ref:"wkFlowInput",attrs:{type:"text",size:"mini",maxlength:"20"},on:{blur:e.nameInputBlur},model:{value:e.node.conditionName,callback:function(t){e.$set(e.node,"conditionName",t)},expression:"node.conditionName"}}):i("span",{staticClass:"title",on:{click:function(t){return t.stopPropagation(),e.titleEditClick(t)}}},[e._v(e._s(e.node.conditionName))]),e._v(" "),i("span",{staticClass:"priority"},[e._v("优先级"+e._s(e.index+1))]),e._v(" "),e.disabled?e._e():i("i",{staticClass:"wk wk-copy",on:{click:function(t){return t.stopPropagation(),e.copyClick(t)}}}),e._v(" "),e.disabled?e._e():i("i",{staticClass:"el-icon-close close",on:{click:function(t){return t.stopPropagation(),e.deleteClick(t)}}})],1),e._v(" "),i("div",{staticClass:"content"},[e.node.conditionDataList&&e.node.conditionDataList.length>0?[e._v("\n          "+e._s(e.getConditonContent())+"\n        ")]:[e._v("\n          无条件\n        ")]],2),e._v(" "),e.modal?i("div",{staticClass:"wk-flow-modal"}):e._e()]),e._v(" "),i("add-node-btn",{on:{command:e.handleCommand}})],1)])},u=[],p=(i("a9e3"),i("a434"),i("14d9"),i("b0c0"),i("3c65"),i("a15b"),i("d81d"),i("d3b7"),i("ddb0"),i("159b"),i("caad"),i("2532"),i("99af"),{examineType:1,name:"审批人",conditionList:[],deptList:[],parentLevel:1,tempParentLevel:1,roleIdList:[],type:1,userList:[],memberUserList:[],chooseType:1,overType:1,rangeType:1,isError:!1}),h={examineType:7,name:"抄送节点",conditionList:[],parentLevelList:[],isSelf:0,isAdd:0,roleIdList:[],userList:[],isError:!1},f={examineType:0,name:"",conditionList:[{conditionName:"条件",conditionDataList:[],examineDataList:[],isError:!1},{conditionName:"条件",conditionDataList:[],examineDataList:[],isError:!1}]},m={conditionName:"条件",conditionDataList:[],examineDataList:[],isError:!1},v=i("ed08"),b=[{label:"属于",value:7}],g=[{label:"完全等于",value:11},{label:"包含任意",value:7}],w=[{label:"小于",value:3},{label:"大于",value:2},{label:"小于等于",value:5},{label:"等于",value:1},{label:"大于等于",value:4},{label:"介于(两个数之间)",value:6}],_=[{label:"<",value:1},{label:"≤",value:2}];function y(e){var t={};return e.forEach((function(e){t[e.value]=e.label})),t}function x(e){return{name:"发起人",conditionType:8,userList:[],deptList:[],roleList:[],values:{userList:[],deptList:[],roleList:[]},checked:e}}var k=i("6bfe"),C={name:"WkConditionNode",components:{AddNodeBtn:c},inject:["WkApproveFlow"],props:{index:Number,disabled:{type:Boolean,default:!1},modal:{type:Boolean,default:!1},parent:Array,conditionParent:Array,node:{type:Object,default:function(){return{}}}},data:function(){return{selectOptionsObj:y(b),checkboxOptionsObj:y(g),numberOptionsObj:y(w),numberValueOptionsObj:y(_),isEdit:!1}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{nameInputBlur:function(){this.isEdit=!1,""===this.node.conditionName&&(this.node.conditionName="条件")},titleEditClick:function(){var e=this;this.disabled||(this.isEdit=!0,this.$nextTick((function(){e.$refs.wkFlowInput.focus()})))},deleteClick:function(){this.$emit("delete")},handleCommand:function(e){if("approve"===e)this.parent.splice(0,0,Object(v["z"])(p));else if("condition"===e){var t=this.parent.splice(0),i=Object(v["z"])(f);i.conditionList[1].examineDataList=t,this.parent.push(i)}else if("copy"===e)this.parent.splice(this.index+1,0,Object(v["z"])(h));else if("paste"===e){var n,a=Object(v["z"])(Object(v["z"])((null===(n=this.WkApproveFlow.eventObj.copy)||void 0===n?void 0:n.node)||p));a.name="".concat(a.name,"（复制）"),this.parent.unshift(a)}},copyClick:function(){var e=Object(v["z"])(this.node);e.conditionName="".concat(e.conditionName,"（复制）"),this.conditionParent.splice(this.index+1,0,e)},click:function(){this.disabled||this.$emit("node-click",this.$props)},getConditonContent:function(){var e=this,t=this.node.conditionDataList;return t.map((function(t){return e.getSectionConditionDes(t)})).join(" 或 ")},getSectionConditionDes:function(e){var t=this;return Array.isArray(e)?e.map((function(e){if(3===e.type){var i=e.values;if(e.setting){var n=[];e.setting.forEach((function(t){void 0!=t.value&&e.values.includes(t.value)&&n.push(t.label)})),n.length>0&&(i=n)}return"".concat(e.name," ").concat(t.selectOptionsObj[e.conditionType]," ").concat(i.join("或"))}return 9===e.type?"".concat(e.name," ").concat(t.checkboxOptionsObj[e.conditionType]," ").concat(e.values.join("、")):6===e.conditionType?"".concat(Object(k["c"])(e.leftValue)?"":e.leftValue," ").concat(t.numberValueOptionsObj[e.leftCondition]," ").concat(e.name," ").concat(t.numberValueOptionsObj[e.rightCondition]," ").concat(Object(k["c"])(e.rightValue)?"":e.rightValue):8===e.conditionType?"".concat(e.name,"属于 ").concat(e.deptList.map((function(e){return $getDeptName(e)})).join("或")).concat(e.deptList.length>0&&e.userList.length>0?"或":"").concat(e.userList.map((function(e){return $getUserName(e)})).join("或")).concat(e.userList.length>0&&e.roleList.length>0?"或":"").concat(e.roleList.map((function(e){return e.roleName})).join("或")):"".concat(e.name," ").concat(t.numberOptionsObj[e.conditionType]," ").concat(e.values)})).join(" 并且 "):""}}},S=C,L=Object(l["a"])(S,d,u,!1,null,"2066fbc5",null),T=L.exports,N=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-conditon-node"},[i("div",{staticClass:"wk-conditon-node-wrap"},[i("div",{staticClass:"conditon-wrap-body",class:{"hide-condition-add":!e.WkApproveFlow.config.conditionAddShow}},[e.WkApproveFlow.config.conditionAddShow?i("el-button",{staticClass:"add-btn",attrs:{plain:""},on:{click:e.addClick}},[e._v("添加条件")]):e._e(),e._v(" "),e._l(e.node.conditionList,(function(t,n){return i("div",{key:n,staticClass:"condition"},[0===n?[i("div",{staticClass:"cover-line is-top-left"}),e._v(" "),i("div",{staticClass:"cover-line is-bottom-left"})]:e._e(),e._v(" "),n===e.node.conditionList.length-1?[i("div",{staticClass:"cover-line is-top-right"}),e._v(" "),i("div",{staticClass:"cover-line is-bottom-right"})]:e._e(),e._v(" "),i("wk-condition-node",{attrs:{index:n,parent:t.examineDataList,"condition-parent":e.node.conditionList,node:t,disabled:t.disabled,modal:t.modal},on:{delete:function(t){e.conditionDelete(n)},"node-click":e.nodeClick}}),e._v(" "),t.examineDataList&&t.examineDataList.length>0?[e._l(t.examineDataList,(function(n,a){return[0===n.examineType?i("wk-condition-wrap",{key:a,attrs:{level:e.level+1,index:a,node:n,parent:t.examineDataList}}):i("wk-node",{key:a,attrs:{index:a,node:n,disabled:n.disabled,modal:n.modal,"header-color":e.getHeaderStyle(n).bgColor,"header-icon":e.getHeaderStyle(n).icon,parent:t.examineDataList},on:{"node-click":e.nodeClick,"on-handle":e.nodeHandleClick}})]}))]:e._e()],2)}))],2),e._v(" "),i("div",{staticClass:"add-node-btn-wrap"},[i("add-node-btn",{on:{command:e.handleCommand}})],1)])])},O=[],D=i("2909"),F=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-node"},[i("div",{staticClass:"wk-node-wrap",class:{"is-first":!e.visibleArrow,"is-error":e.node.isError,"is-disabled":e.disabled},on:{click:e.click}},[i("div",{staticClass:"header",style:{backgroundColor:e.headerColor}},[i("i",{staticClass:"icon",class:e.headerIcon}),e._v(" "),e.isEdit?i("el-input",{ref:"wkFlowInput",attrs:{type:"text",size:"mini"},on:{blur:function(t){e.isEdit=!1}},model:{value:e.node.name,callback:function(t){e.$set(e.node,"name",t)},expression:"node.name"}}):i("span",{staticClass:"title",on:{click:function(t){return t.stopPropagation(),e.titleEditClick(t)}}},[e._v(e._s(e.node.name))]),e._v(" "),e.disabled?e._e():i("i",{staticClass:"wk wk-copy",on:{click:function(t){return t.stopPropagation(),e.copyClick(t)}}}),e._v(" "),e.disabled?e._e():i("i",{staticClass:"el-icon-close close",on:{click:function(t){return t.stopPropagation(),e.deleteClick(t)}}})],1),e._v(" "),i("div",{staticClass:"body"},[e.showCustomContent?i("div",{staticClass:"content"},[e._v(e._s(e.node.content))]):i("div",{staticClass:"content"},[e._v(e._s(e.getContent()))]),e._v(" "),e.disabled?e._e():i("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),e.modal?i("div",{staticClass:"wk-flow-modal"}):e._e()]),e._v(" "),i("div",{staticClass:"add-node-btn-wrap"},[i("add-node-btn",{on:{command:e.handleCommand}})],1)])},V=[],$=i("5530"),I=(i("4de4"),i("eecc")),E={name:"WkNode",components:{AddNodeBtn:c},mixins:[],inject:["memberControlFun","WkApproveFlow"],props:{visibleArrow:{type:Boolean,default:!0},index:Number,disabled:{type:Boolean,default:!1},modal:{type:Boolean,default:!1},headerColor:{type:String,default:"#FF991F"},headerIcon:String,parent:Array,showCustomContent:{type:Boolean,default:!1},node:{type:Object,default:function(){return{}}}},data:function(){return{isEdit:!1,examineTypeObj:I["a"],sendLevelObj:{},topLevelObj:{},levelObj:{}}},computed:{memberControlList:function(){return this.memberControlFun()}},watch:{},created:function(){for(var e=1;e<=20;e++){var t="第".concat(e,"级上级");this.levelObj[e]=t,1===e?(this.sendLevelObj[e]="直属上级",this.topLevelObj[e]="最高级上级"):(this.sendLevelObj[e]=t,this.topLevelObj[e]=t)}},mounted:function(){},beforeDestroy:function(){},methods:{titleEditClick:function(){var e=this;this.disabled||(this.isEdit=!0,this.$nextTick((function(){e.$refs.wkFlowInput.focus()})))},deleteClick:function(){this.parent.splice(this.index,1)},handleCommand:function(e){if("approve"===e)this.parent.splice(this.index+1,0,Object(v["z"])(p));else if("condition"===e){var t=this.parent.splice(this.index+1),i=Object(v["z"])(f);i.conditionList[1].examineDataList=t,this.parent.push(i)}else if("copy"===e)this.parent.splice(this.index+1,0,Object(v["z"])(h));else if("paste"===e){var n,a=Object(v["z"])(Object(v["z"])((null===(n=this.WkApproveFlow.eventObj.copy)||void 0===n?void 0:n.node)||p));a.name="".concat(a.name,"（复制）"),this.parent.splice(this.index+1,0,a)}},getContent:function(){var e=this.node,t=e.examineType,i=e.type,n=e.userList,a=e.memberUserList,s=e.parentLevel,o=e.parentLevelList,l=e.roleIdList,r=e.roleList,c=void 0===r?[]:r,d=e.overType,u=e.tempParentLevel,p=e.isAdd,h=e.isSelf,f=e.fieldName,m=e.parentLevelCheck,v=void 0!==m&&m,b=I["a"][t];if(1===t)return 1===(null===a||void 0===a?void 0:a.length)?"".concat(b," 1人"):(null===a||void 0===a?void 0:a.length)>1?"".concat(null===a||void 0===a?void 0:a.length,"人").concat(I["b"][i]):"请选择审批人";if(2===t)return"".concat(this.sendLevelObj[s]);if(3===t)return l&&l.length>0?"".concat(c.map((function(e){return e.roleName})).join("，")).concat(I["b"][i]):"请选择审批人";if(4===t)return l&&l.length>0?"发起人从".concat(c.map((function(e){return e.roleName})).join("，"),"中自选"):b;if(5===t)return 1===i?!l&&l.length>0?"请选择审批人":0===d?"从 直属上级 到 ".concat(c.map((function(e){return e.roleName})).join("，")):1===d?"从 直属上级 到 发起人向上的".concat(this.levelObj[s]):"":"从 直属上级 到 组织架构中由上至下的".concat(this.topLevelObj[u]);if(7===t){var g="";return n.length&&(g+="指定抄送人".concat(n.length,"人")),l&&l.length&&(g+=g?" 指定角色：":"指定角色：",c.forEach((function(e,t){g+="".concat(e.roleName).concat(t===l.length-1?"":"，")}))),o&&o.length&&(g+=g?" 指定上级：":"指定上级：",o.forEach((function(e,t){g+="".concat(1===e?"直属上级":"第".concat(e,"级上级")).concat(t===o.length-1?"":"，")}))),p&&(g+=g?" 发起人自选":"发起人自选"),h&&(g+=g?" 抄送给发起人自己":"抄送给发起人自己"),g||"请选择抄送人"}if(8===t){var w="",_="";return f&&(_=this.memberControlList.filter((function(e){return e.fieldName==f}))[0].name,w+=_),v&&(w+=1===s?"直属上级":"第".concat(s,"级上级")),1!=i&&(w+=I["b"][i]),w||"请选择审批人"}return""},click:function(){this.disabled||this.$emit("node-click",this.$props)},copyClick:function(){this.$emit("on-handle",Object($["a"])({eventName:"copy"},this.$props))}}},j=E,A=Object(l["a"])(j,F,V,!1,null,"54714b6a",null),U=A.exports,P={name:"WkConditionWrap",components:{AddNodeBtn:c,WkNode:U,WkConditionNode:T},inject:["WkApproveFlow"],props:{level:{type:Number,default:0},index:Number,parent:Array,node:{type:Object,default:function(){return{}}}},data:function(){return{tree:null}},computed:{wrapAddHide:function(){return this.parent.length===this.index+1&&1===this.node.conditionList.length}},watch:{},created:function(){"WkConditionWrap"===this.$parent.$options.name?this.tree=this.$parent.tree:this.tree=this},mounted:function(){},beforeDestroy:function(){},methods:{addClick:function(){this.node.conditionList.push(Object(v["z"])(m))},conditionDelete:function(e){if(this.node.conditionList.length>2)this.node.conditionList.splice(e,1);else{var t,i=0==e?1:0;(t=this.parent).splice.apply(t,[this.index,1].concat(Object(D["a"])(this.node.conditionList[i].examineDataList)))}},handleCommand:function(e){if("approve"===e)this.parent.splice(this.index+1,0,Object(v["z"])(p));else if("condition"===e){var t=this.parent.splice(this.index+1),i=Object(v["z"])(f);i.conditionList[1].examineDataList=t,this.parent.push(i)}else if("copy"===e)this.parent.splice(this.index+1,0,Object(v["z"])(h));else if("paste"===e){var n,a=Object(v["z"])(Object(v["z"])((null===(n=this.WkApproveFlow.eventObj.copy)||void 0===n?void 0:n.node)||p));a.name="".concat(a.name,"（复制）"),this.parent.splice(this.index+1,0,a)}},nodeClick:function(e){this.tree.$emit("node-click",e)},nodeHandleClick:function(e){this.tree.$emit("on-handle",e)},getHeaderStyle:function(e){var t={bgColor:"#0052cc",icon:""};return e.examineType>=1&&e.examineType<=5?(t.bgColor="#FF991F",t.icon="wk wk-approve-line"):7===e.examineType&&(t.bgColor="#6B778C",t.icon="wk wk-source-line"),t}}},B=P,W=(i("835e"),Object(l["a"])(B,N,O,!1,null,null,null)),H=W.exports,R=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},z=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-end-node"},[i("div",{staticClass:"circle"}),e._v(" "),i("div",{staticClass:"text"},[e._v("流程结束")])])}],M={name:"WkEndNode",components:{},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{}},q=M,G=Object(l["a"])(q,R,z,!1,null,"100619a6",null),X=G.exports,J=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-approve-flow-wrap"},[i("el-button-group",[i("el-button",{staticClass:"group-btn",attrs:{disabled:e.scale<=.5,icon:"el-icon-minus"},on:{click:function(t){e.scaleClick("minus")}}}),e._v(" "),i("el-button",{staticClass:"group-btn",attrs:{disabled:e.scale>3,icon:"el-icon-plus"},on:{click:function(t){e.scaleClick("plus")}}})],1),e._v(" "),i("div",{staticClass:"wk-approve-flow",style:{transform:"scale("+e.scale+")"}},[e.sendNode?i("wk-node",{attrs:{"visible-arrow":!1,"show-custom-content":"",node:e.sendNode,parent:e.list,disabled:"","header-color":"#0052cc","header-icon":"wk wk-visit-contract"}}):e._e(),e._v(" "),e._l(e.list,(function(t,n){return[0===t.examineType?i("wk-condition-wrap",{key:n,attrs:{index:n,node:t,parent:e.list},on:{"node-click":e.nodeClick,"on-handle":e.nodeHandleClick}}):i("wk-node",{key:n,attrs:{index:n,parent:e.list,node:t,disabled:t.disabled,modal:t.modal,"header-color":e.getHeaderStyle(t).bgColor,"header-icon":e.getHeaderStyle(t).icon},on:{"node-click":e.nodeClick,"on-handle":e.nodeHandleClick}})]})),e._v(" "),i("wk-end-node"),e._v(" "),i("wk-condition-set",{attrs:{visible:e.conditionSetVisible,node:e.editNode,"condition-parent":e.conditionParent,"condition-parent-index":e.conditionParentIndex,props:e.config},on:{"update:visible":function(t){e.conditionSetVisible=t}}}),e._v(" "),i("wk-node-set",{attrs:{visible:e.nodeSetVisible,node:e.editNode,props:e.config},on:{"update:visible":function(t){e.nodeSetVisible=t}}}),e._v(" "),i("WkCopyNodeSet",{attrs:{visible:e.copyNodeSetVisible,node:e.editNode,props:e.config},on:{"update:visible":function(t){e.copyNodeSetVisible=t}}})],2)],1)},K=[],Z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-drawer",{attrs:{visible:e.visible,"with-header":!1,size:"500px",title:"我是标题","append-to-body":""},on:{close:e.close}},[e.editNode?i("flexbox",{staticClass:"drawer-header"},[i("div",{staticClass:"edit-title"},[e.isNameEdit?i("el-input",{ref:"conditionNameInput",attrs:{maxlength:"20"},on:{blur:e.nameInputBlur},model:{value:e.editNode.conditionName,callback:function(t){e.$set(e.editNode,"conditionName",t)},expression:"editNode.conditionName"}}):[i("span",{staticClass:"title",on:{click:e.titleEditClick}},[e._v(e._s(e.editNode.conditionName))]),e._v(" "),i("i",{staticClass:"wk wk-edit",on:{click:e.titleEditClick}})]],2),e._v(" "),i("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[i("draggable",{attrs:{options:{group:"list",forceFallback:!1,fallbackClass:"draggingStyle",filter:"drag-item__label",preventOnFilter:!1}},model:{value:e.dragList,callback:function(t){e.dragList=t},expression:"dragList"}},e._l(e.dragList,(function(t,n){return i("flexbox",{key:n,staticClass:"drag-item"},[i("div",{staticClass:"drag-item__label"},[e._v(e._s(t.conditionName))]),e._v(" "),i("div",{staticClass:"drag-item__handle"},[e._v("⋮⋮")])])}))),e._v(" "),i("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("优先级设置")])],1),e._v(" "),i("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":"26","data-id":"236"}}),e._v(" "),i("i",{staticClass:"el-icon-close ",on:{click:e.close}})],1):e._e(),e._v(" "),e.editNode?i("div",{staticClass:"drawer-body"},e._l(e.editNode.conditionDataList,(function(t,n){return i("div",{key:n},[i("div",{staticClass:"section"},[i("div",{staticClass:"section-header"},[i("span",{staticClass:"sh-title"},[e._v("条件组")]),e._v(" "),e.editNode.conditionDataList.length>1?i("el-button",{attrs:{type:"primary-text"},on:{click:function(t){e.deleteSection(n)}}},[e._v("删除")]):e._e()],1),e._v(" "),e._l(t,(function(t,a){return i("el-row",{key:a,staticClass:"set-row",attrs:{gutter:20,type:"flex",align:"middle"}},[i("el-col",{staticClass:"set-row__title",attrs:{span:5}},[e._v(e._s(t.name))]),e._v(" "),i("el-col",{staticClass:"set-row__center",attrs:{span:17}},[8===t.conditionType?i("flexbox",[i("div",{staticStyle:{flex:"1"}},[i("wk-user-dep-dialog-select",{staticStyle:{width:"100%"},attrs:{"user-value":t.values.userList,"dep-value":t.values.deptList,placeholder:"请选择员工或部门"},on:{"update:userValue":function(i){e.$set(t.values,"userList",i)},"update:depValue":function(i){e.$set(t.values,"deptList",i)},change:function(i){e.userDepSelectChange(arguments,t)}}}),e._v(" "),i("role-employee-select",{ref:"roleSelect",refInFor:!0,staticStyle:{width:"100%","margin-top":"8px"},attrs:{props:{onlyShowRole:!0},multiple:"",placeholder:"请选择角色","collapse-tags":"",clearable:""},on:{change:function(i){e.roleSelectChange(t,n)}},model:{value:t.values.roleList,callback:function(i){e.$set(t.values,"roleList",i)},expression:"item.values.roleList"}})],1),e._v(" "),i("div",{staticStyle:{"flex-shrink":"0","margin-left":"8px"}},[e._v("或")])]):[9,3].includes(t.type)?[3==t.type?i("el-select",{staticClass:"condition-select",model:{value:t.conditionType,callback:function(i){e.$set(t,"conditionType",i)},expression:"item.conditionType"}},e._l(e.selectOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))):9==t.type?i("el-select",{staticClass:"condition-select",model:{value:t.conditionType,callback:function(i){e.$set(t,"conditionType",i)},expression:"item.conditionType"}},e._l(e.checkboxOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))):e._e(),e._v(" "),i("el-select",{staticClass:"condition-value",attrs:{multiple:""},model:{value:t.values,callback:function(i){e.$set(t,"values",i)},expression:"item.values"}},e._l(t.setting,(function(e,t){return i("el-option",{key:t,attrs:{label:void 0!==e.value?e.label:e,value:void 0!==e.value?e.value:e}})})))]:[i("el-select",{class:["condition-select",{"is-block":6===t.conditionType}],model:{value:t.conditionType,callback:function(i){e.$set(t,"conditionType",i)},expression:"item.conditionType"}},e._l(e.numberOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))),e._v(" "),6===t.conditionType?[i("div",{staticStyle:{"margin-top":"10px"}},[i("el-input-number",{staticClass:"small",attrs:{controls:!1},model:{value:t.leftValue,callback:function(i){e.$set(t,"leftValue",i)},expression:"item.leftValue"}}),e._v(" "),i("el-select",{staticClass:"small is-condition",model:{value:t.leftCondition,callback:function(i){e.$set(t,"leftCondition",i)},expression:"item.leftCondition"}},e._l(e.numberValueOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))),e._v(" "),i("span",{staticClass:"small-select-label"},[e._v(e._s(t.name))]),e._v(" "),i("el-select",{staticClass:"small is-condition",model:{value:t.rightCondition,callback:function(i){e.$set(t,"rightCondition",i)},expression:"item.rightCondition"}},e._l(e.numberValueOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))),e._v(" "),i("el-input-number",{staticClass:"small",attrs:{controls:!1},model:{value:t.rightValue,callback:function(i){e.$set(t,"rightValue",i)},expression:"item.rightValue"}})],1)]:i("el-input-number",{staticClass:"condition-value",attrs:{controls:!1},model:{value:t.values,callback:function(i){e.$set(t,"values",i)},expression:"item.values"}})]],2),e._v(" "),i("el-col",{staticClass:"set-row__footer",attrs:{span:1}},[i("i",{staticClass:"wk wk-delete",on:{click:function(t){e.deleteItem(n,a)}}})])],1)})),e._v(" "),i("div",[i("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(t){e.conditionSelectClick(n)}}},[e._v("添加条件")]),e._v(" "),i("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":"26","data-id":"237"}})],1)],2),e._v(" "),e.editNode.conditionDataList.length-1>n?i("div",{staticClass:"section-and"},[e._v("或")]):i("div",{staticClass:"section-footer"},[e.editNode.conditionDataList.length<4?i("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(t){e.addSection()}}},[e._v("添加条件组")]):e._e()],1)])}))):e._e(),e._v(" "),i("div",{staticClass:"drawer-footer"},[i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("保存")]),e._v(" "),i("el-button",{nativeOn:{click:function(t){return e.close(t)}}},[e._v("取消")])],1),e._v(" "),i("wk-condition-select",{attrs:{props:e.props,checks:e.editNode&&null!==e.addSectionIndex?e.editNode.conditionDataList[e.addSectionIndex]:[],visible:e.conditionSelectVisible},on:{"update:visible":function(t){e.conditionSelectVisible=t},confirm:e.conditionSelectConfirm}})],1)},Q=[],Y=(i("7db0"),i("fb6a"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.visible,"append-to-body":!0,"close-on-click-modal":!1,title:"选择条件",width:"600px","custom-class":"no-padding-dialog"},on:{close:e.handleCancel}},[i("div",{staticStyle:{padding:"20px"}},[i("div",[e._v("请选择用来区分审批流程的条件字段 ")]),e._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},e._l(e.list,(function(t,n){return i("el-checkbox",{key:n,attrs:{label:t.name},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"item.checked"}})})))]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("确定")]),e._v(" "),i("el-button",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v("取消")])],1)])}),ee=[],te={name:"WkConditionSelect",components:{},inheritAttrs:!1,props:{visible:{type:Boolean,required:!0,default:!1},checks:Array,props:{type:Object,default:function(){return{}}}},data:function(){return{list:[]}},computed:{},watch:{visible:function(e){e&&this.getList()}},methods:{handleConfirm:function(){this.$emit("confirm",this.list.filter((function(e){return e.checked}))),this.handleCancel()},getList:function(){var e=this,t=this.props,i=t.conditionSelectRequest,n=t.conditionSelectParams,a=t.conditionSelectList;a?this.handleList(Object(v["z"])(a)):i(n).then((function(t){var i=t.data||[];e.handleList(i)})).catch((function(){}))},handleList:function(e){var t=this,i=[],n=null;this.checks&&this.checks.forEach((function(e){8===e.conditionType?n=e:i.push(e.fieldName||e.name)}));var a=[];e.forEach((function(e,n){i.includes(e.fieldName||e.name)?(a.push(n),t.$set(e,"checked",!0)):t.$set(e,"checked",!1)})),a.forEach((function(i){var n=e[i],a=t.checks.find((function(e){return e.fieldName===n.fieldName||e.name===n.name}));t.$set(a,"checked",!0),e.splice(i,1,a)})),n?(this.$set(n,"checked",!0),e.splice(0,0,n),this.list=e):(e.splice(0,0,Object(v["z"])(x(!1))),this.list=e)},handleCancel:function(){this.$emit("update:visible",!1)}}},ie=te,ne=Object(l["a"])(ie,Y,ee,!1,null,"412745e0",null),ae=ne.exports,se=i("b76a"),oe=i.n(se),le=i("b592"),re=i("94d4"),ce={name:"WkConditionSet",components:{WkConditionSelect:ae,Draggable:oe.a,WkUserDepDialogSelect:le["a"],RoleEmployeeSelect:re["a"]},props:{visible:{type:Boolean,required:!0,default:!1},node:{type:Object,default:function(){return{}}},conditionParent:Array,conditionParentIndex:Number,props:{type:Object,default:function(){return{}}}},data:function(){return{editNode:null,isNameEdit:!1,selectOptions:b,checkboxOptions:g,numberOptions:w,numberValueOptions:_,addSectionIndex:null,conditionSelectVisible:!1,dragList:[]}},computed:{},watch:{visible:function(e){var t=this;if(e){var i=Object(v["z"])(this.conditionParent);this.editNode=i[this.conditionParentIndex],0===this.editNode.conditionDataList.length?this.editNode.conditionDataList.push([x(!0)]):this.validateSetting(this.editNode.conditionDataList),i.forEach((function(e,t){e.index=t})),this.dragList=i}else{var n=Object(v["z"])(this.conditionParent);this.conditionParent.splice(0,this.conditionParent.length),this.dragList.forEach((function(e){t.conditionParent.push(n[e.index])})),this.editNode=null}}},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{validateSetting:function(e){var t=this,i=[];if(e.forEach((function(e){3!==e.type&&9!==e.type||e.setting||i.push(e)})),i&&i.length>0){var n=this.props,a=n.conditionSelectRequest,s=n.conditionSelectParams,o=n.conditionSelectList;if(o){var l=Object(v["z"])(o);i.forEach((function(e){var i=l.find((function(t){return t.fieldName===e.fieldName}));i&&t.$set(e,"setting",i.setting)}))}else a(s).then((function(e){var n=e.data||[];i.forEach((function(e){var i=n.find((function(t){return t.fieldName===e.fieldName}));i&&t.$set(e,"setting",i.setting)}))})).catch((function(){}))}},nameInputBlur:function(){this.isNameEdit=!1,""===this.editNode.conditionName&&(this.editNode.conditionName="条件")},titleEditClick:function(){var e=this;this.isNameEdit=!0,this.$nextTick((function(){e.$refs.conditionNameInput.focus()}))},close:function(){this.$emit("update:visible",!1)},handleConfirm:function(){var e=this,t=this.editNode.conditionDataList||[],i=[];for(var n in t.forEach((function(t){var n=e.getValidCondition(t);n.length>0&&i.push(n)})),this.editNode.conditionDataList=i.length>4?i.slice(0,4):i,this.editNode.isError=!1,this.editNode)"examineDataList"!==n&&(this.node[n]=this.editNode[n]);this.close()},getValidCondition:function(e){return e.filter((function(e){return 3===e.type||9===e.type?e.values&&e.values.length>0:6===e.conditionType?!Object(k["c"])(e.leftValue)&&!Object(k["c"])(e.rightValue)&&e.leftValue<e.rightValue:8===e.conditionType?!Object(k["c"])(e.userList)||!Object(k["c"])(e.deptList)||!Object(k["c"])(e.roleList):!Object(k["c"])(e.values)}))},conditionSelectClick:function(e){this.addSectionIndex=e,this.conditionSelectVisible=!0},deleteItem:function(e,t){var i=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.editNode.conditionDataList[e].splice(t,1)})).catch((function(){}))},deleteSection:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.editNode.conditionDataList.splice(e,1)})).catch((function(){}))},addSection:function(){this.editNode.conditionDataList.length<5&&this.editNode.conditionDataList.push([x(!0)])},conditionSelectConfirm:function(e){e.forEach((function(e){e.conditionType||(3===e.type||9===e.type?(e.conditionType=3===e.type?7:11,e.values=[]):5!==e.type&&6!==e.type||(e.conditionType=3,e.values=0,e.leftValue=0,e.leftCondition=1,e.rightCondition=1,e.rightValue=0))})),this.$set(this.editNode.conditionDataList,this.addSectionIndex,Object(v["z"])(e))},userDepSelectChange:function(e,t){var i=e[2],n=e[3];t.userList=i,t.deptList=n},roleSelectChange:function(e,t){var i=this;this.$nextTick((function(){var n=i.$refs.roleSelect[t].select.selected;e.roleList=n.map((function(e){return{roleName:e.$props.label}}))}))}}},de=ce,ue=(i("db54"),Object(l["a"])(de,Z,Q,!1,null,"9560d374",null)),pe=ue.exports,he=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-drawer",{attrs:{visible:e.visible,"with-header":!1,size:"500px","append-to-body":""},on:{close:e.close}},[e.editNode?i("flexbox",{staticClass:"drawer-header"},[i("div",{staticClass:"edit-title"},[e.isNameEdit?i("el-input",{attrs:{maxlength:"20"},on:{blur:e.nameInputBlur},model:{value:e.editNode.name,callback:function(t){e.$set(e.editNode,"name",t)},expression:"editNode.name"}}):[i("span",{staticClass:"title",on:{click:function(t){e.isNameEdit=!0}}},[e._v(e._s(e.editNode.name))]),e._v(" "),i("i",{staticClass:"wk wk-edit",on:{click:function(t){e.isNameEdit=!0}}})]],2),e._v(" "),i("i",{staticClass:"el-icon-close ",on:{click:e.close}})]):e._e(),e._v(" "),e.tabsShow?i("el-tabs",{on:{"tab-click":e.activeTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.tabs,(function(e,t){return i("el-tab-pane",{key:t,attrs:{label:e.label,name:e.name}})}))):e._e(),e._v(" "),"base"===e.activeTab&&e.editNode?i("div",{staticClass:"drawer-body",class:{"is-tab":e.tabsShow}},[i("div",{staticClass:"section"},[i("el-radio-group",{on:{change:e.examineTypeChange},model:{value:e.editNode.examineType,callback:function(t){e.$set(e.editNode,"examineType",t)},expression:"editNode.examineType"}},e._l(e.examineTypeOptions,(function(t,n){return i("el-radio",{key:n,staticClass:"el-radio--type",attrs:{label:t.value}},[e._v(e._s(t.label))])}))),e._v(" "),1===e.editNode.examineType?i("div",{staticClass:"area-top"},[i("div",{staticClass:"section-handle"},[i("el-dropdown",{staticClass:"more-handle",on:{command:e.addCommandClick}},[i("el-button",{attrs:{type:"primary"}},[e._v("添加")]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"selectUser"}},[e._v("选择员工")]),e._v(" "),e.props.examineNodeProps.addExternalUserShow?i("el-dropdown-item",{attrs:{command:"external"}},[e._v("选择外部联系人")]):e._e()],1)],1),e._v(" "),i("span",{staticClass:"text-des"},[e._v("不能超过20人")])],1),e._v(" "),i("div",{staticClass:"user-list-wrap"},e._l(e.editNode.memberUserList,(function(t,n){return i("el-tag",{key:n,staticClass:"user-item",attrs:{size:"medium","disable-transitions":"",closable:"",type:"info"},on:{close:function(t){e.typeUserDelete(n)}}},[e._v("\n            "+e._s(t.userId?e.$getUserName(t):t.outerUserEmail)+"\n          ")])})))]):e._e(),e._v(" "),2===e.editNode.examineType?i("div",{staticClass:"area-top"},[i("div",{staticClass:"section-handle"},[i("span",[e._v("发起人的")]),e._v(" "),i("el-select",{model:{value:e.editNode.parentLevel,callback:function(t){e.$set(e.editNode,"parentLevel",t)},expression:"editNode.parentLevel"}},e._l(e.sendLevelOption,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1),e._v(" "),i("div",{staticClass:"area-top wk-checkbox"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.editNode.type,callback:function(t){e.$set(e.editNode,"type",t)},expression:"editNode.type"}}),e._v(" "),i("span",{staticClass:"wk-checkbox__label"},[e._v("找不到主管时，由上级主管代审批")])],1)]):e._e(),e._v(" "),3===e.editNode.examineType?i("div",{staticClass:"area-top"},[i("role-employee-select",{ref:"roleSelect",staticStyle:{width:"400px"},attrs:{multiple:"",props:{onlyShowRole:!0},clearable:""},on:{change:e.roleSelectChange},model:{value:e.editNode.roleIdList,callback:function(t){e.$set(e.editNode,"roleIdList",t)},expression:"editNode.roleIdList"}})],1):e._e(),e._v(" "),4===e.editNode.examineType?i("div",{staticClass:"area-top"},[i("div",{staticClass:"section-handle"},[i("el-select",{model:{value:e.editNode.chooseType,callback:function(t){e.$set(e.editNode,"chooseType",t)},expression:"editNode.chooseType"}},[i("el-option",{attrs:{value:1,label:"自选一人"}}),e._v(" "),i("el-option",{attrs:{value:2,label:"自选多人"}})],1)],1),e._v(" "),i("div",{staticClass:"area-top"},[i("div",{staticClass:"section__title"},[e._v("选择范围")]),e._v(" "),i("div",{staticClass:"area-top"},[i("el-select",{on:{change:e.rangeTypeChange},model:{value:e.editNode.rangeType,callback:function(t){e.$set(e.editNode,"rangeType",t)},expression:"editNode.rangeType"}},[i("el-option",{attrs:{value:1,label:"全公司"}}),e._v(" "),i("el-option",{attrs:{value:2,label:"指定成员"}}),e._v(" "),i("el-option",{attrs:{value:3,label:"指定角色"}})],1),e._v(" "),2===e.editNode.rangeType?[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.depUserViewDialogShow=!0}}},[e._v("添加员工")])]:e._e(),e._v(" "),3===e.editNode.rangeType?i("role-employee-select",{ref:"roleSelect",attrs:{multiple:"",props:{onlyShowRole:!0},clearable:""},on:{change:e.roleSelectChange},model:{value:e.editNode.roleIdList,callback:function(t){e.$set(e.editNode,"roleIdList",t)},expression:"editNode.roleIdList"}}):e._e()],2),e._v(" "),2===e.editNode.rangeType&&e.editNode.userList.length>0?i("div",{staticClass:"user-list-wrap",staticStyle:{"margin-top":"8px"}},e._l(e.editNode.userList,(function(t,n){return i("el-tag",{key:n,staticClass:"user-item",attrs:{size:"medium","disable-transitions":"",closable:"",type:"info"},on:{close:function(t){e.userDelete(n)}}},[e._v("\n              "+e._s(e.$getUserName(t))+"\n            ")])}))):e._e()])]):e._e(),e._v(" "),5===e.editNode.examineType?i("div",{staticClass:"area-top"},[i("div",{staticClass:"section__title"},[e._v("审批终点")]),e._v(" "),i("el-radio-group",{staticClass:"el-radio-group--block",on:{change:e.endTypeChange},model:{value:e.editNode.type,callback:function(t){e.$set(e.editNode,"type",t)},expression:"editNode.type"}},[i("el-radio",{staticClass:"el-radio--block",attrs:{label:1}},[i("div",[e._v("指定角色（连续多级上级须包含该角色）"),i("role-employee-select",{ref:"roleSelect",attrs:{props:{onlyShowRole:!0},multiple:"",clearable:""},on:{change:e.roleSelectChange},model:{value:e.editNode.roleIdList,callback:function(t){e.$set(e.editNode,"roleIdList",t)},expression:"editNode.roleIdList"}})],1)]),e._v(" "),i("div",{staticClass:"area-top wk-checkbox",staticStyle:{"margin-left":"20px","line-height":"34px"}},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.editNode.overType,callback:function(t){e.$set(e.editNode,"overType",t)},expression:"editNode.overType"}}),e._v(" "),i("span",{staticClass:"wk-checkbox__label",staticStyle:{"margin-right":"8px","font-size":"13px"}},[e._v("同时不超过发起人向上的")]),e._v(" "),i("el-select",{model:{value:e.editNode.parentLevel,callback:function(t){e.$set(e.editNode,"parentLevel",t)},expression:"editNode.parentLevel"}},e._l(e.levelOption,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1),e._v(" "),i("el-radio",{staticClass:"el-radio--block area-top",attrs:{label:2}},[i("span",[e._v("组织架构中由上至下的")]),i("el-select",{staticStyle:{"margin-left":"5px"},model:{value:e.editNode.tempParentLevel,callback:function(t){e.$set(e.editNode,"tempParentLevel",t)},expression:"editNode.tempParentLevel"}},e._l(e.topLevelOption,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1)],1)],1):e._e(),e._v(" "),8===e.editNode.examineType?i("div",{staticClass:"area-top"},[i("div",{staticClass:"text-des"},[e._v("模板中必填的人员字段，可关联为审批人")]),e._v(" "),i("el-select",{staticStyle:{"margin-top":"5px"},attrs:{placeholder:"请选择人员字段"},on:{change:e.memberControlChange},model:{value:e.editNode.fieldName,callback:function(t){e.$set(e.editNode,"fieldName",t)},expression:"editNode.fieldName"}},e._l(e.memberControlList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.fieldName}})}))),e._v(" "),i("flexbox",{staticStyle:{"margin-top":"10px"}},[i("el-checkbox",{on:{change:e.parentLevelCheckClick},model:{value:e.editNode.parentLevelCheck,callback:function(t){e.$set(e.editNode,"parentLevelCheck",t)},expression:"editNode.parentLevelCheck"}},[e._v("成员的")]),e._v(" "),i("el-select",{staticStyle:{"margin-left":"3px"},model:{value:e.editNode.parentLevel,callback:function(t){e.$set(e.editNode,"parentLevel",t)},expression:"editNode.parentLevel"}},e._l(e.sendLevelOption,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1)],1):e._e()],1),e._v(" "),e.waySectionShow?i("div",{staticClass:"section"},[i("div",{staticClass:"section__title"},[i("span",[e._v("多人审批时采用的审批方式")])]),e._v(" "),i("div",{staticClass:"section__content"},[i("el-radio-group",{model:{value:e.editNode.type,callback:function(t){e.$set(e.editNode,"type",t)},expression:"editNode.type"}},[3!==e.editNode.examineType&&8!==e.editNode.examineType?i("el-radio",{staticClass:"el-radio--block",attrs:{label:1}},[e._v("依次审批")]):e._e(),e._v(" "),i("el-radio",{staticClass:"el-radio--block",attrs:{label:2}},[e._v("会签（需所有审批人同意）")]),e._v(" "),i("el-radio",{staticClass:"el-radio--block",attrs:{label:3}},[e._v("或签（一名审批人同意或拒绝即可）")])],1)],1)]):e._e()]):e._e(),e._v(" "),"field"===e.activeTab&&e.editNode?i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"drawer-body",class:{"is-tab":e.tabsShow}},[i("field-custom-auth",{ref:"fieldAuth",attrs:{"auth-data":e.editNode.fieldAuthList,"field-list":e.fieldList}})],1):e._e(),e._v(" "),i("div",{staticClass:"drawer-footer"},[i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("保存")]),e._v(" "),i("el-button",{nativeOn:{click:function(t){return e.close(t)}}},[e._v("取消")])],1),e._v(" "),e.depUserViewDialogShow?i("wk-dep-user-dialog",{attrs:{"user-value":e.selectUserList,visible:e.depUserViewDialogShow,props:{showDisableUser:!1,showDept:!1}},on:{"update:visible":function(t){e.depUserViewDialogShow=t},change:e.selectUserChange}}):e._e(),e._v(" "),e.externalDialogShow?i("el-dialog",{attrs:{visible:e.externalDialogShow,"close-on-click-modal":!1,"append-to-body":!0,title:"外部联系人",width:"30%"},on:{"update:visible":function(t){e.externalDialogShow=t}}},[i("span",[e._v("请输入外部联系人邮箱")]),e._v(" "),i("el-input",{staticStyle:{"margin-top":"10px"},model:{value:e.outerUserEmail,callback:function(t){e.outerUserEmail=t},expression:"outerUserEmail"}}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.externalDialogShow=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.verifyEmail}},[e._v("确定")])],1)],1):e._e()],1)},fe=[],me=i("2581"),ve=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"field-custom-auth"},[i("el-table",{attrs:{data:e.tableData}},[i("el-table-column",{attrs:{label:"字段名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("span",{class:{"sub-name":n.parentFieldId}},[e._v(e._s(n.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:110},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-checkbox",{attrs:{indeterminate:e.authViewHalf},on:{change:e.authViewAllChange},model:{value:e.authViewAll,callback:function(t){e.authViewAll=t},expression:"authViewAll"}}),e._v(" "),i("span",{staticClass:"header-text"},[e._v("可以查看")])]}},{key:"default",fn:function(t){var n=t.row,a=t.$index;return[i("el-checkbox",{on:{change:function(t){e.handleRowChange(n,"authView",a)}},model:{value:n.authView,callback:function(t){e.$set(n,"authView",t)},expression:"row.authView"}})]}}])}),e._v(" "),e.disabledEdit?e._e():i("el-table-column",{attrs:{width:110},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-checkbox",{attrs:{indeterminate:e.authEditHalf},on:{change:e.authEditAllChange},model:{value:e.authEditAll,callback:function(t){e.authEditAll=t},expression:"authEditAll"}}),e._v(" "),i("span",{staticClass:"header-text"},[e._v("可以修改")])]}},{key:"default",fn:function(t){var n=t.row,a=t.$index;return[e.getCanEditStatus(n)?i("el-checkbox",{on:{change:function(t){e.handleRowChange(n,"authEdit",a)}},model:{value:n.authEdit,callback:function(t){e.$set(n,"authEdit",t)},expression:"row.authEdit"}}):e._e(),e._v(" "),e.detailTableFormTypes.includes(n.formType)?i("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[i("div",{staticClass:"table-set"},[i("div",{staticClass:"set-item"},[i("el-checkbox",{model:{value:n.tableLineAddEdit,callback:function(t){e.$set(n,"tableLineAddEdit",t)},expression:"row.tableLineAddEdit"}}),e._v(" "),i("span",{staticClass:"header-text"},[e._v("新增行")])],1),e._v(" "),i("div",{staticClass:"set-item"},[i("el-checkbox",{model:{value:n.tableLineDeleteEdit,callback:function(t){e.$set(n,"tableLineDeleteEdit",t)},expression:"row.tableLineDeleteEdit"}}),e._v(" "),i("span",{staticClass:"header-text"},[e._v("删除已有行")])],1)]),e._v(" "),i("el-button",{staticStyle:{padding:"0","margin-left":"8px"},attrs:{slot:"reference",type:"primary-text"},slot:"reference"},[e._v("表格权限")])],1):e._e()]}}])})],1)],1)},be=[],ge=(i("4d90"),i("25f0"),{name:"FieldCustomAuth",props:{fieldList:{type:Array,required:!0},authData:Array,disabledEdit:{type:Boolean,default:!1}},data:function(){return{detailTableFormTypes:["detail_table","business_cause","examine_cause"],tableData:[],authViewAll:!1,authViewHalf:!1,authEditAll:!1,authEditHalf:!1}},computed:{observerObj:function(){return[this.fieldList,this.authData]}},watch:{observerObj:{handler:function(){this.initCom()},immediate:!0,deep:!0}},methods:{initCom:function(){var e=this,t=[],i=[];this.authData&&(i=this.authData),this.fieldList.forEach((function(n){if(t.push(e.getAuthItem(i,n)),e.detailTableFormTypes.includes(n.formType)&&n.fieldExtendList){var a=i.find((function(e){return e.fieldName===n.fieldName}));n.fieldExtendList.forEach((function(i){t.push(e.getAuthItem(null===a||void 0===a?void 0:a.fieldExtendList,i,n,a))}))}})),this.tableData=t,this.setAllCheckStatus()},getAuthItem:function(e,t,i,n){var a=null,s=null;e&&0!==e.length?(s=e.find((function(e){return e.fieldName===t.fieldName})),a=s?s.authLevel:1):a=2;var o={fieldId:t.fieldId,formType:t.formType,fieldName:t.fieldName,name:t.name,hideEdit:t.hideEdit,tableLevel:s&&s.tableLevel||0,authLevel:a,authView:[2,3].includes(a),authEdit:3===a};if(this.detailTableFormTypes.includes(t.formType)){var l=o.tableLevel.toString(2).padStart(3,"0");o.tableLineAddEdit=Boolean(Number(l.charAt(0))),o.tableLineEdit=Boolean(Number(l.charAt(1))),o.tableLineDeleteEdit=Boolean(Number(l.charAt(2)))}return i&&(o.parentFieldId=i.fieldId,n||(o.authLevel=1,o.authView=!1,o.authEdit=!1),o.fieldId=t.id),o},getCanEditStatus:function(e){return!this.disabledEdit&&!e.hideEdit&&!["serial_number"].includes(e.formType)},authViewAllChange:function(e){var t=this;this.tableData.forEach((function(i){t.$set(i,"authView",e)})),this.authViewHalf=!1,this.authViewAll=e,e||this.authEditAllChange(!1)},authEditAllChange:function(e){var t=this;this.tableData.forEach((function(i){t.$set(i,"authEdit",e),e&&t.$set(i,"authView",e)})),this.authEditHalf=!1,this.authEditAll=e},setAllCheckStatus:function(){var e=this,t=this.tableData.length;if(!t)return this.authViewAll=!1,this.authViewHalf=!1,this.authEditAll=!1,void(this.authViewHalf=!1);var i=["authView","authEdit"];i.forEach((function(i){var n=e.tableData.filter((function(e){return e[i]})).length;e["".concat(i,"All")]=n===t,e["".concat(i,"Half")]=n>0&&n!==t}))},handleRowChange:function(e,t,i){switch(t){case"authView":e.authView||(e.authEdit=!1);break;case"authEdit":e.authEdit&&(e.authView=!0);break}if(e.parentFieldId&&e[t]){var n=this.tableData.find((function(t){return t.fieldId===e.parentFieldId}));n&&(n[t]=!0)}this.setAllCheckStatus()},getSaveForm:function(){var e=this,t=[];return this.tableData.forEach((function(i){if(e.detailTableFormTypes.includes(i.formType)){var n=e.tableData.filter((function(e){return e.parentFieldId===i.fieldId})),a=n.map((function(t){return e.getPostItem(t)})),s=e.getPostItem(i);s.fieldExtendList=a,t.push(s)}else i.parentFieldId||t.push(e.getPostItem(i))})),t},getPostItem:function(e){var t;t=e.authEdit&&this.getCanEditStatus(e)?3:e.authView?2:1;var i={fieldId:e.fieldId,formType:e.formType,fieldName:e.fieldName,name:e.name,authLevel:t};if(this.detailTableFormTypes.includes(e.formType)){var n=[];n.push(e.tableLineAddEdit?"1":"0"),n.push(e.tableLineEdit?"1":"0"),n.push(e.tableLineDeleteEdit?"1":"0");var a=n.join("");i.tableLevel=parseInt(a,2)}return i}}}),we=ge,_e=(i("8871"),Object(l["a"])(we,ve,be,!1,null,"608ec6d3",null)),ye=_e.exports,xe={methods:{getWkWayShowStatus:function(e){var t,i,n,a;return!!e&&(1===e.examineType&&(null===(t=e.memberUserList)||void 0===t?void 0:t.length)>1||3===e.examineType&&(null===(i=e.roleIdList)||void 0===i?void 0:i.length)>0||4===e.examineType&&2===e.chooseType&&(1===e.rangeType||2===e.rangeType&&(null===(n=e.userList)||void 0===n?void 0:n.length)>1||3===e.rangeType&&(null===(a=e.roleIdList)||void 0===a?void 0:a.length)>0))},getWkNodeErrorStatus:function(e){return 1===e.examineType?0===e.memberUserList.length:2!==e.examineType&&(3===e.examineType?!e.roleIdList||0===e.roleIdList.length:4===e.examineType?2===e.rangeType?0===e.userList.length:3===e.rangeType&&(!e.roleIdList||0===e.roleIdList.length):5===e.examineType?1===e.type?!e.roleIdList||0===e.roleIdList.length:2===e.type&&Object(k["c"])(e.tempParentLevel):7===e.examineType?!(e.userList.length||e.parentLevelList.length||e.roleIdList.length||e.isSelf||e.isAdd):8===e.examineType?!!Object(k["c"])(e.fieldName):void 0)}}},ke={name:"WkNodeSet",components:{WkDepUserDialog:me["a"],RoleEmployeeSelect:re["a"],FieldCustomAuth:ye},mixins:[xe],inject:["memberControlFun"],props:{visible:{type:Boolean,required:!0,default:!1},node:{type:Object,default:function(){return{}}},props:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,editNode:null,isNameEdit:!1,sendLevelOption:[],topLevelOption:[],levelOption:[],depUserViewDialogShow:!1,activeTab:"base",fieldList:[],selectUserList:[],externalDialogShow:!1,outerUserEmail:""}},computed:{examineTypeOptions:function(){var e=[{label:"指定成员",value:1},{label:"上级",value:2},{label:"角色",value:3},{label:"发起人自选",value:4},{label:"连续多级上级",value:5},{label:"关联人员字段",value:8}];return this.props.examineTypeFilterFun?this.props.examineTypeFilterFun(e):e},waySectionShow:function(){return this.getWkWayShowStatus(this.editNode)||this.memberControlSectionShow},memberControlSectionShow:function(){var e=this.editNode,t=e.fieldName,i=e.examineType;if(8===i&&t){var n=this.memberControlList.filter((function(e){return e.fieldName==t}))[0];return 1===n.isMulti}return!1},memberControlList:function(){return this.memberControlFun()},tabsShow:function(){return this.tabs.length>1},tabs:function(){var e=[{label:"基础设置",name:"base"}];return this.props.nodeFieldSetShow&&e.push({label:"字段权限",name:"field"}),e}},watch:{visible:function(e){this.editNode=e?Object(v["z"])(this.node):null}},created:function(){for(var e=1;e<=20;e++){var t="第".concat(e,"级上级");this.levelOption.push({label:t,value:e}),1===e?(this.sendLevelOption.push({label:"直属上级",value:e}),this.topLevelOption.push({label:"最高级上级",value:e})):(this.sendLevelOption.push({label:t,value:e}),this.topLevelOption.push({label:t,value:e}))}},mounted:function(){},beforeDestroy:function(){},methods:{memberControlChange:function(){this.memberControlSectionShow?this.$set(this.editNode,"type",2):this.$set(this.editNode,"type",1)},nameInputBlur:function(){this.isNameEdit=!1,""===this.editNode.name&&(this.editNode.name="审批人")},close:function(){this.$emit("update:visible",!1)},handleConfirm:function(){var e=this;for(var t in this.editNode.isError=this.getWkNodeErrorStatus(this.editNode),this.editNode)"conditionList"!==t&&(this.node[t]=this.editNode[t]);var i=this.$refs.fieldAuth;if(i){var n=i.getSaveForm();this.props.nodeFieldItemParamsFun&&n.forEach((function(t){e.props.nodeFieldItemParamsFun(t)})),this.node.fieldAuthList=n}this.close()},examineTypeChange:function(){this.editNode.parentLevel=1,this.$set(this.editNode,"userList",[]),this.$set(this.editNode,"memberUserList",[]),1===this.editNode.examineType?this.editNode.type=1:2===this.editNode.examineType?this.editNode.type=0:3===this.editNode.examineType?this.editNode.type=2:4===this.editNode.examineType?(this.editNode.rangeType||(this.editNode.rangeType=1),this.editNode.chooseType=1,this.editNode.type=1):5===this.editNode.examineType&&(this.editNode.type=1),this.editNode.roleIdList=[],this.editNode.chooseType=1},selectUserChange:function(e,t,i){var n=this;if(1===this.editNode.examineType){var a=[],s=[];this.editNode.memberUserList.forEach((function(e){e.userId?a.push(e.userId):s.push(e.outerUserEmail)})),i.forEach((function(e){!a.includes(e.userId)&&a.length+s.length<20&&n.editNode.memberUserList.push(e)})),this.editNode.type=1}else i.length>0?this.editNode.userList=i.length>20?i.slice(0,20):i:this.editNode.userList=[]},userDelete:function(e){this.editNode.userList.splice(e,1)},typeUserDelete:function(e){this.editNode.memberUserList.splice(e,1)},rangeTypeChange:function(){this.editNode.userList=[],this.editNode.roleIdList=[],this.editNode.type=1},endTypeChange:function(){this.editNode.overType=0},roleSelectChange:function(){var e=this;this.$nextTick((function(){var t=e.$refs.roleSelect.select.selected;e.$set(e.editNode,"roleList",t.map((function(e){return{roleName:e.$props.label}})))}))},activeTabClick:function(){"field"===this.activeTab&&this.props.nodeFieldSetShow&&this.getFieldList()},getFieldList:function(){var e=this;this.loading=!0,this.props.nodeFieldSetRequestFun().then((function(t){e.fieldList=t,e.loading=!1})).catch((function(){e.fieldList=[],e.loading=!1}))},addCommandClick:function(e){"selectUser"===e?(1===this.editNode.examineType?this.selectUserList=(this.editNode.memberUserList||[]).filter((function(e){return!!e.userId})).map((function(e){return e.userId})):this.selectUserList=(this.editNode.userList||[]).map((function(e){return e.userId})),this.depUserViewDialogShow=!0):"external"===e&&(this.externalDialogShow=!0)},verifyEmail:function(){if(Object(v["A"])(this.outerUserEmail)){var e=[],t=[];this.editNode.memberUserList.forEach((function(i){i.userId?e.push(i.userId):t.push(i.outerUserEmail)})),!t.includes(this.outerUserEmail)&&e.length+t.length<20&&this.editNode.memberUserList.push({outerUserEmail:this.outerUserEmail}),this.outerUserEmail=null,this.externalDialogShow=!1}else this.$message.error("邮箱格式有误")},parentLevelCheckClick:function(){var e;this.editNode.parentLevelCheck&&!this.editNode.parentLevel&&(this.editNode.parentLevel=null===(e=this.sendLevelOption[0])||void 0===e?void 0:e.value)}}},Ce=ke,Se=(i("eff5"),i("8d09"),Object(l["a"])(Ce,he,fe,!1,null,"7c1c571a",null)),Le=Se.exports,Te=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-drawer",{attrs:{visible:e.visible,"with-header":!1,size:"500px",title:"我是标题","append-to-body":""},on:{close:e.close}},[e.editNode?i("flexbox",{staticClass:"drawer-header"},[i("div",{staticClass:"edit-title"},[e.isNameEdit?i("el-input",{attrs:{maxlength:"20"},on:{blur:e.nameInputBlur},model:{value:e.editNode.name,callback:function(t){e.$set(e.editNode,"name",t)},expression:"editNode.name"}}):[i("span",{staticClass:"title",on:{click:function(t){e.isNameEdit=!0}}},[e._v(e._s(e.editNode.name))]),e._v(" "),i("i",{staticClass:"wk wk-edit",on:{click:function(t){e.isNameEdit=!0}}})]],2),e._v(" "),i("i",{staticClass:"el-icon-close ",on:{click:e.close}})]):e._e(),e._v(" "),e.tabsShow?i("el-tabs",{on:{"tab-click":e.activeTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.tabs,(function(e,t){return i("el-tab-pane",{key:t,attrs:{label:e.label,name:e.name}})}))):e._e(),e._v(" "),"base"===e.activeTab&&e.editNode?i("div",{staticClass:"drawer-body",class:{"is-tab":e.tabsShow}},[i("div",{staticClass:"set-copy"},[i("div",{staticClass:"item"},[i("div",{staticClass:"item-title"},[e._v("\n          抄送人\n        ")]),e._v(" "),i("div",{staticClass:"item-body"},[e._l(e.editNode.userList,(function(t,n){return i("el-tag",{key:t.userId,attrs:{size:"medium","disable-transitions":"",closable:"",type:"info"},on:{close:function(t){e.handleRemoveUser(n)}}},[e._v("\n            "+e._s(t.realname)+"\n          ")])})),e._v(" "),i("el-button",{staticClass:"add-btn",attrs:{type:"text",icon:"el-icon-circle-plus"},on:{click:function(t){e.handleToChooseUser()}}},[e._v("\n            添加成员\n          ")]),e._v(" "),i("div",{staticClass:"section-handle"},[i("p",{staticClass:"section-handle-title"},[e._v("指定上级")]),e._v(" "),i("el-select",{staticStyle:{width:"400px"},attrs:{multiple:""},on:{change:e.setContent},model:{value:e.editNode.parentLevelList,callback:function(t){e.$set(e.editNode,"parentLevelList",t)},expression:"editNode.parentLevelList"}},e._l(e.sendLevelOption,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1),e._v(" "),i("div",{staticClass:"section-handle"},[i("p",{staticClass:"section-handle-title"},[e._v("指定角色")]),e._v(" "),i("role-employee-select",{ref:"roleSelect",staticStyle:{width:"400px"},attrs:{multiple:"",props:{onlyShowRole:!0,showCustomRoles:!0},clearable:""},on:{change:e.roleSelectChange},model:{value:e.editNode.roleIdList,callback:function(t){e.$set(e.editNode,"roleIdList",t)},expression:"editNode.roleIdList"}})],1),e._v(" "),i("div",{staticClass:"checkbox-wrapper"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},on:{change:e.setContent},model:{value:e.editNode.isSelf,callback:function(t){e.$set(e.editNode,"isSelf",t)},expression:"editNode.isSelf"}},[e._v("\n              抄送给发起人本人\n            ")])],1),e._v(" "),i("div",{staticClass:"checkbox-wrapper"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},on:{change:e.setContent},model:{value:e.editNode.isAdd,callback:function(t){e.$set(e.editNode,"isAdd",t)},expression:"editNode.isAdd"}},[e._v("\n              允许发起人添加抄送人\n            ")])],1)],2)]),e._v(" "),e.userDialogSelectVisible?i("wk-dep-user-dialog",{attrs:{visible:e.userDialogSelectVisible,"user-value":e.userList,props:{showDept:!1}},on:{"update:visible":function(t){e.userDialogSelectVisible=t},"update:userValue":function(t){e.userList=t},change:e.selectUserChange}}):e._e()],1)]):e._e(),e._v(" "),"field"===e.activeTab&&e.editNode?i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"drawer-body",class:{"is-tab":e.tabsShow}},[i("field-custom-auth",{ref:"fieldAuth",attrs:{"auth-data":e.editNode.fieldAuthList,"field-list":e.fieldList,"disabled-edit":""}})],1):e._e(),e._v(" "),i("div",{staticClass:"drawer-footer"},[i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("保存")]),e._v(" "),i("el-button",{nativeOn:{click:function(t){return e.close(t)}}},[e._v("取消")])],1)],1)},Ne=[],Oe={name:"WkCopyNodeSet",components:{WkDepUserDialog:me["a"],RoleEmployeeSelect:re["a"],FieldCustomAuth:ye},mixins:[xe],inject:["WkApproveFlow"],props:{visible:{type:Boolean,required:!0,default:!1},node:{type:Object,default:function(){return{}}},props:{type:Object,default:function(){return{}}}},data:function(){return{editNode:null,isNameEdit:!1,sendLevelOption:[],topLevelOption:[],levelOption:[],userDialogSelectVisible:!1,userList:[],activeTab:"base",fieldList:[]}},computed:{tabsShow:function(){return this.tabs.length>1},tabs:function(){return[]}},watch:{visible:function(e){this.editNode=e?Object(v["z"])(this.node):null}},created:function(){for(var e=1;e<=20;e++){var t="第".concat(e,"级上级");this.levelOption.push({label:t,value:e}),1===e?(this.sendLevelOption.push({label:"直属上级",value:e}),this.topLevelOption.push({label:"最高级上级",value:e})):(this.sendLevelOption.push({label:t,value:e}),this.topLevelOption.push({label:t,value:e}))}},mounted:function(){},beforeDestroy:function(){},methods:{handleToChooseUser:function(){var e;this.userList=null===(e=this.editNode.userList)||void 0===e?void 0:e.map((function(e){return e.userId})),this.userDialogSelectVisible=!0},setContent:function(){},nameInputBlur:function(){this.isNameEdit=!1,""===this.editNode.name&&(this.editNode.name="抄送节点")},close:function(){this.$emit("update:visible",!1)},handleConfirm:function(){var e=this;for(var t in this.editNode.isError=this.getWkNodeErrorStatus(this.editNode),this.editNode)"conditionList"!==t&&(this.node[t]=this.editNode[t]);var i=this.$refs.fieldAuth;if(i){var n=i.getSaveForm();this.props.nodeFieldItemParamsFun&&n.forEach((function(t){e.props.nodeFieldItemParamsFun(t)})),this.node.fieldAuthList=n}this.close()},selectUserChange:function(e,t,i,n){this.editNode.userList=i,this.setContent(),this.userDialogSelectVisible=!1},handleRemoveUser:function(e){this.editNode.userList.splice(e,1),this.setContent(),this.$forceUpdate()},roleSelectChange:function(){var e=this;this.$nextTick((function(){var t=e.$refs.roleSelect.select.selected.map((function(e){return{roleName:e.label}}));e.$set(e.editNode,"roleList",t)}))},activeTabClick:function(){"field"===this.activeTab&&this.props.nodeFieldSetShow&&this.getFieldList()},getFieldList:function(){var e=this;this.loading=!0,this.props.nodeFieldSetRequestFun().then((function(t){e.fieldList=t,e.loading=!1})).catch((function(){e.fieldList=[],e.loading=!1}))}}},De=Oe,Fe=(i("5704"),Object(l["a"])(De,Te,Ne,!1,null,"722e9440",null)),Ve=Fe.exports,$e=i("8ed6"),Ie={conditionSelectRequest:null,conditionSelectParams:null,conditionSelectList:null,nodeFieldSetShow:!1,nodeFieldItemParamsFun:null,nodeFieldSetRequestFun:null,examineTypeFilterFun:null,conditionAddShow:!0,examineAddShow:!0,copyAddShow:!0,examineNodeProps:{addExternalUserShow:!0}},Ee={name:"WkApproveFlow",components:{WkNode:U,WkConditionWrap:H,WkEndNode:X,WkConditionSet:pe,WkNodeSet:Le,WkCopyNodeSet:Ve},mixins:[xe],inject:["memberControlFun"],provide:function(){return{WkApproveFlow:this}},props:{props:{type:Object,default:function(){return{}}},sendNode:Object,list:Array},data:function(){return{editNode:null,editNodeIndex:null,conditionParent:[],conditionParentIndex:0,conditionSetVisible:!1,nodeSetVisible:!1,copyNodeSetVisible:!1,errorList:[],scale:1,eventObj:{copy:null}}},computed:{config:function(){return Object($e["a"])(Object($["a"])({},Ie),this.props||{})},memberControlList:function(){return this.memberControlFun()}},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{nodeClick:function(e){var t=e.node,i=e.index,n=e.conditionParent;this.editNode=t,t.examineType>0?7==t.examineType?this.copyNodeSetVisible=!0:this.nodeSetVisible=!0:(this.conditionParent=n,this.conditionParentIndex=i,this.conditionSetVisible=!0)},nodeHandleClick:function(e){"copy"===e.eventName&&(this.eventObj[e.eventName]=e,this.$message.success("复制成功"))},scaleClick:function(e){"minus"===e?this.scale=this.scale-.1:"plus"===e&&(this.scale=this.scale+.1)},getParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={needUserFieldNamesParams:!1},i=Object($e["a"])(Object($["a"])({},t),e);this.errorList=[];var n=[],a={userFieldNames:[]};return this.getListParams(this.list,n,i,a),this.errorList.length>0?{isError:!0,list:this.errorList,paramsData:a}:{isError:!1,list:n,paramsData:a}},getListParams:function(e,t,i,n){var a=this;e.forEach((function(e){0===e.examineType?t.push(a.getConditonWrapParams(e,i,n)):t.push(a.getNodeParams(e,i,n))}))},getNodeParams:function(e,t,i){e.isError=this.getWkNodeErrorStatus(e),e.isError&&this.errorList.push(e);var n={examineType:e.examineType,name:e.name,deptList:e.deptList,roleIdList:e.roleIdList,type:e.type,userList:e.userList.map((function(e){return e.userId})),chooseType:e.chooseType,rangeType:e.rangeType};if(1==e.examineType)n.memberUserList=e.memberUserList,n.userList=[];else if(5===e.examineType)1===e.type?n.parentLevel=1===e.overType?e.parentLevel:0:2===e.type&&(n.parentLevel=e.tempParentLevel);else if(7===e.examineType)n={examineType:e.examineType,name:e.name,userList:e.userList.map((function(e){return e.userId})),isSelf:e.isSelf,isAdd:e.isAdd,roleIdList:e.roleIdList,parentLevelList:e.parentLevelList};else if(8==e.examineType){var a=e.parentLevelCheck,s=void 0!==a&&a,o=e.fieldName;if(n.parentLevel=s?e.parentLevel:null,n.fieldName=o,o){var l=this.memberControlList.filter((function(e){return e.fieldName==o}))[0].fieldId;n.fieldId=l,t.needUserFieldNamesParams&&i.userFieldNames.push(o)}}else n.parentLevel=e.parentLevel;return e.fieldAuthList&&(n.fieldAuthList=e.fieldAuthList),n},getConditionNodeParams:function(e,t){var i=this;e.isError=!1,e.isError&&this.errorList.push(e);var n={conditionName:e.conditionName,sort:t+1,conditionDataList:[]};return e.conditionDataList.forEach((function(e){n.conditionDataList.push(i.getSectionConditionParams(e))})),n},getSectionConditionParams:function(e){return e.map((function(e){var t={name:e.name,fieldName:e.fieldName,type:e.type,fieldId:e.fieldId,conditionType:e.conditionType};return 3===e.type||9===e.type?t.values=e.values:6===e.conditionType?t.values=[e.leftValue,e.leftCondition,e.rightCondition,e.rightValue]:8===e.conditionType?t.values=e.values:t.values=[e.values],t}))},getConditonWrapParams:function(e,t,i){var n=this,a={examineType:e.examineType,name:e.name,conditionList:[]};return e.conditionList.forEach((function(e,s){var o=n.getConditionNodeParams(e,s);o.examineDataList=[],a.conditionList.push(o),n.getListParams(e.examineDataList,o.examineDataList,t,i)})),a},getHeaderStyle:function(e){var t={bgColor:"#0052cc",icon:""};return e.examineType>=1&&e.examineType<=5?(t.bgColor="#FF991F",t.icon="wk wk-approve-line"):7===e.examineType?(t.bgColor="#6B778C",t.icon="wk wk-source-line"):8===e.examineType&&(t.bgColor="#FF991F",t.icon="wk wk-approve-line"),t}}},je=Ee,Ae=(i("9c1d"),Object(l["a"])(je,J,K,!1,null,null,null)),Ue=Ae.exports},4445:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{staticClass:"wk-base-detail-section",attrs:{gutter:e.gutter,align:"stretch",wrap:"wrap"}},[e._l(e.list,(function(t,n){return i("flexbox-item",{key:n,class:[{"is-block":e.isBlockShowField(t)},"is-"+t.formType]},[i("div",{staticClass:"wk-base-detail-section__item"},[i("div",{staticClass:"item-name"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"item-value"},[i("wk-field-view",{attrs:{props:t,"form-type":t.formType,value:t.value},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data;return[e._t("data",null,{data:i})]}}])})],1)])])})),e._v(" "),e.dropdownItems&&e.dropdownItems.length>0?i("el-dropdown",{staticClass:"wk-base-detail-section__more",attrs:{trigger:"hover"},on:{command:e.handleTypeClick}},[i("i",{staticClass:"el-icon-more",staticStyle:{cursor:"pointer"}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.dropdownItems,(function(t,n){return i("el-dropdown-item",{key:n,attrs:{icon:t.icon,command:t.command}},[e._v(e._s(t.label))])})))],1):e._e(),e._v(" "),e._t("default")],2)},a=[],s=(i("a9e3"),i("caad"),i("8967")),o={name:"WkBaseDetailSection",components:{WkFieldView:s["default"]},props:{list:Array,gutter:{type:Number,default:0},dropdownItems:Array},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{handleTypeClick:function(e){this.$emit("command-select",e)},isBlockShowField:function(e){return["file","detail_table"].includes(e.formType)}}},l=o,r=(i("7600"),i("2877")),c=Object(r["a"])(l,n,a,!1,null,"45476a4a",null);t["a"]=c.exports},4859:function(e,t,i){},"4e75":function(e,t,i){},5057:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"xr-header"},[i("flexbox",[e.iconClass?i("div",{staticClass:"xr-header__icon",style:{backgroundColor:e.iconColor}},[i("i",{class:e.iconClass})]):e._e(),e._v(" "),i("div",{staticClass:"xr-header__label"},[e.$slots.label?e._t("label"):[e._v(e._s(e.label)),e._t("otherLabel")]],2),e._v(" "),i("div",{staticClass:"xr-header__ft",style:{top:e.ftTop}},[e._t("ft")],2)]),e._v(" "),i("flexbox",{staticClass:"xr-header__bottom",attrs:{justify:"space-between"}},[e.showSearch?i("el-input",e._b({staticClass:"xr-header__search",style:{"margin-top":e.ftTop},attrs:{placeholder:e.placeholder},on:{input:e.inputChange},nativeOn:{keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchClick(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},"el-input",e.inputAttr,!1),[i("el-button",{attrs:{slot:"suffix",type:"icon",icon:"wk wk-sousuo"},on:{click:e.searchClick},slot:"suffix"})],1):e._e(),e._v(" "),i("div",[e._t("bottom-ft")],2)],1)],1)},a=[],s=(i("a9e3"),i("ac1f"),i("841c"),{name:"XrHeader",components:{},props:{iconClass:[String,Array],iconColor:String,label:String,showSearch:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入内容"},ftTop:{type:String,default:"0"},content:[String,Number],inputAttr:{type:Object,default:function(){}}},data:function(){return{search:""}},computed:{},watch:{content:{handler:function(){this.search!=this.content&&(this.search=this.content)},immediate:!0}},mounted:function(){},beforeDestroy:function(){},methods:{inputChange:function(){this.$emit("update:content",this.search)},searchClick:function(){this.$emit("search",this.search)}}}),o=s,l=(i("fa73"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"641c8559",null);t["a"]=r.exports},5067:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",e._g(e._b({ref:"form",staticClass:"wk-form",class:e.customClass},"el-form",e.$attrs,!1),e.$listeners),[e._l(e.fieldList,(function(t,n){return i("el-form-item",{key:n,class:[t.className||"","is-"+t.formType],attrs:{prop:t.field}},[i("template",{slot:"label"},[e._v(e._s(t.name)),"tooltip"==t.tipType?i("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[i("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.getTips(t))},slot:"content"}),e._v(" "),i("i",{staticClass:"wk wk-help wk-help-tips"})]):"system-help"==t.tipType||t.helpType?i("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":t.helpType,"data-id":t.helpId}}):i("span",{staticClass:"label-tips"},[e._v("\n        "+e._s(e.getTips(t))+"\n      ")])],1),e._v(" "),"text"==t.formType?i("el-input",{attrs:{disabled:t.disabled,maxlength:t.maxlength||100,placeholder:t.placeholder,type:t.formType},on:{input:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):e.isTrimInput(t.formType)?i("el-input",{attrs:{disabled:t.disabled,"prefix-icon":e.getInputIcon(t.formType),placeholder:t.placeholder,type:"text"},on:{input:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,"string"===typeof i?i.trim():i)},expression:"fieldFrom[item.field]"}}):"number"==t.formType?i("el-input-number",{attrs:{placeholder:t.placeholder,disabled:t.disabled,controls:!1,max:t.hasOwnProperty("max")?t.max:1/0},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"floatnumber"==t.formType?i("el-input-number",{attrs:{placeholder:t.placeholder,disabled:t.disabled,controls:!1},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"textarea"==t.formType?i("el-input",{attrs:{disabled:t.disabled,rows:3,autosize:{minRows:3},maxlength:t.maxlength||800,placeholder:t.placeholder,type:t.formType,resize:"none"},on:{input:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"select"===t.formType&&t.setting.includes(e.LOGIC_OTHER)?i("wk-select",{attrs:{disabled:t.disabled,clearable:t.clearable,placeholder:t.placeholder,options:t.setting,"show-type":1===t.precisions?"tiled":"default","other-show-input":""},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"checkbox"===t.formType&&t.setting.includes(e.LOGIC_OTHER)?i("wk-checkbox",{attrs:{disabled:t.disabled,clearable:t.clearable,placeholder:t.placeholder,options:t.setting,"show-type":1===t.precisions?"tiled":"default","other-show-input":""},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):["checkbox","select"].includes(t.formType)?i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","remote-method":e.remoteMethod,disabled:t.disabled,clearable:t.clearable,placeholder:t.placeholder,multiple:"checkbox"===t.formType},on:{change:function(i){e.commonChange(t,n,i)},blur:function(t){e.search=""}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}},e._l(e.filterOptions(t.setting),(function(t,n){return i("el-option",{key:n,attrs:{label:e.isEmptyValue(t.value)?t:t.label||t.name,value:e.isEmptyValue(t.value)?t:t.value}})}))):"date"==t.formType?i("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:t.disabled,clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"dateRange"==t.formType?i("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:t.disabled,type:t.dateType||"daterange","value-format":t.dateValueFormat||"yyyy-MM-dd",clearable:"","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"datetime"==t.formType?i("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:t.disabled,clearable:"",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"structure"==t.formType&&(t.request||t.props||t.params)?i("wk-dep-select",{staticStyle:{width:"100%"},attrs:{request:t.request,props:t.props,params:t.params,disabled:t.disabled,radio:!!e.isEmptyValue(t.radio)||t.radio},on:{change:function(i){e.depOrUserChange(t,n,arguments[0],arguments[1])}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"structure"==t.formType?i("wk-dept-dialog-select",{staticStyle:{width:"100%"},attrs:{disabled:t.disabled,radio:!!e.isEmptyValue(t.radio)||t.radio},on:{change:function(i){e.depOrUserChange(t,n,arguments[0],arguments[1])}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):["single_user","user"].includes(t.formType)&&(t.request||t.props||t.params)?i("wk-user-select",{staticStyle:{width:"100%"},attrs:{request:t.request,props:t.props,params:t.params,disabled:t.disabled,radio:!!e.isEmptyValue(t.radio)||t.radio},on:{change:function(i){e.depOrUserChange(t,n,arguments[0],arguments[1])}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):["single_user","user"].includes(t.formType)?i("wk-user-dialog-select",{staticStyle:{width:"100%"},attrs:{disabled:t.disabled,radio:!!e.isEmptyValue(t.radio)||t.radio},on:{change:function(i){e.depOrUserChange(t,n,arguments[0],arguments[1])}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"radio"==t.formType?i("el-radio-group",{attrs:{disabled:t.disabled,placeholder:t.placeholder},on:{change:function(i){e.commonChange(t,n,i)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}},e._l(t.setting,(function(t,n){return i("el-radio",{key:n,attrs:{label:e.isEmptyValue(t.value)?t:t.value}},[e._v("\n        "+e._s(e.isEmptyValue(t.value)?t:t.label||t.name)+"\n      ")])}))):"boolean_value"==t.formType?i("el-switch",{attrs:{disabled:t.disabled,"active-value":"1","inactive-value":"0"},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}}):"address"==t.formType?i("v-distpicker",{attrs:{province:e.fieldFrom[t.field].province,city:e.fieldFrom[t.field].city,area:e.fieldFrom[t.field].area},on:{province:function(i){e.selectProvince(i,t,n)},city:function(i){e.selectCity(i,t,n)},area:function(i){e.selectArea(i,t,n)}}}):"file"==t.formType?i("xh-files",{attrs:{value:e.fieldFrom[t.field],disabled:t.disabled},on:{"value-change":function(i){e.oldChange(i,t,n)}}}):[e._t("default",null,{data:t,index:n})]],2)})),e._v(" "),e._t("suffix")],2)},a=[],s=(i("ac1f"),i("841c"),i("4de4"),i("d3b7"),i("466d"),i("b0c0"),i("5c0a")),o=i("de98"),l=i("8f81"),r=i("bfba"),c=i("5a8c"),d=i("f068"),u=i("0cc2"),p=i("b46d"),h=i("6d60"),f=i("d22a"),m="其他",v={name:"WkForm",components:{WkUserSelect:s["a"],WkDepSelect:o["a"],WkUserDialogSelect:l["a"],WkDeptDialogSelect:r["a"],VDistpicker:c["a"],XhFiles:d["a"],WkSelect:u["a"],WkCheckbox:p["a"]},mixins:[h["a"]],inheritAttrs:!1,props:{fieldFrom:{type:Object,default:function(){return{}}},fieldList:{type:Array,default:function(){return[]}},customClass:{type:String,default:"is-two-columns"}},data:function(){return{LOGIC_OTHER:m,instance:null,search:""}},computed:{filterOptions:function(){var e=this;return function(t){return e.search?t.filter((function(t){return f["a"].match(e.isEmptyValue(t.value)?t:t.label||t.name,e.search)})):t}}},watch:{},mounted:function(){var e=this;this.$nextTick((function(){e.instance=e.$refs.form}))},beforeDestroy:function(){},methods:{remoteMethod:function(e){this.search=e}}},b=v,g=(i("1f77"),i("d76d"),i("2877")),w=Object(g["a"])(b,n,a,!1,null,"b61d5730",null);t["a"]=w.exports},5337:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{staticClass:"xr-detail-header"},[e.iconClass?i("div",{staticClass:"xr-detail-header__icon",style:{backgroundColor:e.iconBgColor}},[i("i",{class:e.iconClass,style:{color:e.iconColor}})]):e._e(),e._v(" "),i("div",{staticClass:"xr-detail-header__body"},[e._t("body"),e._v(" "),e.defaultBodyShow?[i("div",{staticClass:"detail-name"},[e._v(e._s(e.detailName))]),e._v(" "),i("div",{staticClass:"detail-value"},[e._v(e._s(e.detailValue))])]:e._e()],2),e._v(" "),i("div",{staticClass:"xr-detail-header__ft"},[e._t("ft"),e._v(" "),e.showEdit?i("el-button",{staticClass:"xr-detail-header--button",class:e.editButtonClass,staticStyle:{"margin-right":"10px"},attrs:{icon:"wk wk-circle-edit",type:"primary"},nativeOn:{click:function(t){return e.editClick(t)}}},[e._v("编辑")]):e._e(),e._v(" "),e.dropdownItems&&e.dropdownItems.length>0?i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleTypeClick}},[i("el-button",{staticClass:"xr-detail-header--more",attrs:{icon:"el-icon-more"}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.dropdownItems,(function(t,n){return i("el-dropdown-item",{key:n,attrs:{icon:t.icon,command:t.command}},[e._v(e._s(t.label))])})))],1):e._e()],2)])},a=[],s={name:"WkDetailHeader",components:{},props:{iconClass:[String,Array],iconBgColor:{type:String,default:"#ECEEF2"},iconColor:{type:String,default:"#42526E"},detailName:String,detailValue:String,defaultBodyShow:{type:Boolean,default:!0},dropdownItems:Array,showEdit:{type:Boolean,default:!1},editButtonClass:{type:String,default:"xr-btn--primary"}},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{handleTypeClick:function(e){this.$emit("command-select",e)},editClick:function(){this.$emit("edit")}}},o=s,l=(i("5ce1"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"16e64836",null);t["a"]=r.exports},"545c":function(e,t,i){},5704:function(e,t,i){"use strict";i("8c67")},"59fc":function(e,t,i){"use strict";i("09c7")},"5a5d":function(e,t,i){},"5ce1":function(e,t,i){"use strict";i("4e75")},6641:function(e,t,i){"use strict";i("a303")},"67ba":function(e,t,i){},7296:function(e,t,i){"use strict";i("29fc")},7600:function(e,t,i){"use strict";i("a0dd")},7949:function(e,t,i){},"799f":function(e,t,i){"use strict";i("115e")},"7c26":function(e,t,i){},"7d86":function(e,t,i){},"835e":function(e,t,i){"use strict";i("e2d9")},8871:function(e,t,i){"use strict";i("7d86")},8967:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isEmpty?e._e():i("div",{staticClass:"wk-field-view",class:["is-"+e.formType,{"is-common-type":e.isCommonType||e.isInline||e.isModule}]},[e.ignoreFields.includes(e.props.field)||e.ignoreFields.includes(e.props.fieldName)?[e._t("default",null,{data:e.$props})]:"lastContent"===e.props.fieldName?i("span",{domProps:{innerHTML:e._s(e.getCommonShowValue())}}):e.isCommonType?i("span",[e._v(e._s(e.getCommonShowValue()))]):"boolean_value"==e.formType?i("el-switch",{attrs:{value:e.value,disabled:"","active-value":"1","inactive-value":"0"}}):"handwriting_sign"==e.formType?i("wk-signature-image",{attrs:{src:e.value,height:e.config.signatureHeight}}):"desc_text"==e.formType?i("wk-desc-text",{key:Date.now().toString(),attrs:{value:e.value}}):"location"==e.formType?i("span",{class:{"can-check":e.objectHasValue(e.value,"address")},on:{click:function(t){t.stopPropagation(),e.mapViewShow=!0}}},[e._v(e._s(e.objectHasValue(e.value,"address")?e.value.address:""))]):"website"==e.formType?i("span",{class:{"can-check":!e.isEmpty},on:{click:function(t){t.stopPropagation(),e.openUrl(e.value)}}},[e._v(e._s(e.value))]):"file"==e.formType?i("file-list-view",{attrs:{list:e.value||[]}}):"detail_table"==e.formType?i("wk-detail-table-view",{attrs:{"show-type":2===e.props.precisions?"table":"default",title:e.props.name,"add-field-list":e.props.fieldExtendList,"field-form":e.value,"field-list":e.props.fieldList},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data;return[e._t("default",null,{data:i})]}}])}):"field_group"==e.formType?i("wk-group",{attrs:{"show-tips":!1,data:e.props}}):"field_attention"==e.formType?i("el-rate",{attrs:{value:Number(e.value||0),disabled:""}}):"field_tag"==e.formType?i("tag-view",{attrs:{"item-bottom":0,value:e.value}}):"rich_text_format"==e.formType?i("div",{domProps:{innerHTML:e._s(e.value)}}):"pic"==e.formType?i("wk-picture-preview",{attrs:{wrap:e.props.wrap,"picture-url":e.value}}):[e._t("default",null,{data:e.$props})],e._v(" "),e.mapViewShow?i("map-view",{attrs:{title:e.value.address,lat:e.value.lat,lng:e.value.lng},on:{hidden:function(t){e.mapViewShow=!1}}}):e._e()],2)},a=[],s=i("5530"),o=(i("a9e3"),i("caad"),i("2532"),i("ac1f"),i("466d"),i("5b79")),l=i("aebc"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"map-view"},[i("div",{ref:"mapView",staticClass:"main-map"}),e._v(" "),i("i",{staticClass:"el-icon-close map-close",on:{click:e.hiddenView}})])},c=[],d=i("ed08"),u={name:"MapView",components:{},props:{title:{type:String,default:""},lat:{type:[String,Number],default:0},lng:{type:[String,Number],default:0}},data:function(){return{}},computed:{},mounted:function(){var e=this;this.$el.style.zIndex=Object(d["p"])(),document.body.appendChild(this.$el),Object(d["k"])().then((function(){var t=new BMap.Map(e.$refs.mapView,{enableMapClick:!1}),i=new BMap.Point(parseFloat(e.lng),parseFloat(e.lat));t.centerAndZoom(i,18),t.enableScrollWheelZoom();var n=new BMap.Marker(i);t.addOverlay(n);var a=new BMap.InfoWindow(e.title);n.addEventListener("click",(function(){t.openInfoWindow(a,i)}))}))},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hiddenView:function(){this.$emit("hidden")}}},p=u,h=(i("189f"),i("2877")),f=Object(h["a"])(p,r,c,!1,null,"15f1fc41",null),m=f.exports,v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"file-list-view"},e._l(e.list,(function(t,n){return i("div",{key:n,staticClass:"file-item"},[i("img",{staticClass:"pic-icon",attrs:{src:e.getFileTypeIcon(t.name),alt:""}}),e._v(" "),i("div",{staticClass:"file-name text-one-line"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"file-size"},[e._v("( "+e._s(e._f("fontSizeValue")(t.size))+" )")]),e._v(" "),i("div",{staticClass:"down"},[i("span",{on:{click:function(i){e.previewClick(t,n)}}},[e._v("预览")]),e._v(" "),i("span",{on:{click:function(i){e.downloadClick(t)}}},[e._v("下载")])])])})))},b=[],g=(i("b0c0"),i("d81d"),{name:"FileListView",filters:{fontSizeValue:function(e){return Object(d["g"])(e)}},props:{list:{type:Array,required:!0}},data:function(){return{}},methods:{getFileTypeIcon:function(e){if(!e)return"";var t=e?e.split("."):[],i="";return i=t.length>0?t[t.length-1]:"",Object(d["m"])(i)},downloadClick:function(e){Object(d["e"])({path:e.filePath||e.url,name:e.name})},previewClick:function(e,t){this.$wkPreviewFile.preview({index:t,data:this.list.map((function(e){return{url:e.filePath||e.url,name:e.name}}))})}}}),w=g,_=(i("2e03"),Object(h["a"])(w,v,b,!1,null,"792ecc68",null)),y=_.exports,x=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-detail-table-view"},["default"===e.showType?e._l(e.fieldList,(function(t,n){return i("div",{key:n,staticClass:"detail-item"},[i("flexbox",{staticClass:"detail-item__head"},[i("div",{staticClass:"detail-item__head-title"},[e._v(e._s(e.title)+"（"+e._s(n+1)+"）")])]),e._v(" "),i("flexbox",{staticClass:"wk-form-items",attrs:{align:"flex-start",wrap:"wrap",justify:"flex-start"}},[e._l(t,(function(t,a){return[e.getShowValue(t)?i("div",{key:a,staticClass:"wk-form-item",class:["is-"+t.formType],style:{width:t.stylePercent?t.stylePercent+"%":"auto"},attrs:{label:t.name}},[i("div",{staticClass:"wk-form-item__label"},[e._v(e._s(t.name))]),e._v(" "),i("wk-field-view",{attrs:{props:t,"form-type":t.formType,value:e.fieldForm&&e.fieldForm[n]?e.fieldForm[n][t.field]:[]},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data;return[e._t("default",null,{data:i})]}}])})],1):e._e()]}))],2)],1)})):"table"===e.showType?i("div",{staticClass:"detail-item"},[i("el-table",{key:Date.now().toString(),staticClass:"wk-table-items",staticStyle:{width:"100%"},attrs:{data:e.fieldForm||[]}},e._l(e.addFieldList,(function(t,n){return i("el-table-column",{directives:[{name:"show",rawName:"v-show",value:e.getShowValue(t),expression:"getShowValue(item)"}],key:n,attrs:{prop:t.field,label:t.name,"min-width":e.getMinWidth(t.formType)},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.row;return[i("wk-field-view",{attrs:{props:t,"form-type":t.formType,value:a[t.field]},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data;return[e._t("default",null,{data:i})]}}])})]}}])})})))],1):e._e()],2)},k=[],C=(i("d3b7"),i("3ca3"),i("ddb0"),{name:"WkDetailTableView",components:{WkFieldView:function(){return Promise.resolve().then(i.bind(null,"8967"))}},props:{title:String,showType:{type:String,default:"defalut"},addFieldList:Array,fieldForm:{type:Array,default:function(){return[]}},fieldList:{type:Array,default:function(){return[]}}},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{getMinWidth:function(e){return"date_interval"===e||"dateRange"===e||"file"===e||"location"===e||"position"===e?250:150},getShowValue:function(e){return!e.hasOwnProperty("show")||e.show}}}),S=C,L=(i("8a10"),Object(h["a"])(S,x,k,!1,null,"0d404cc1",null)),T=L.exports,N=i("2444"),O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tag-view",style:{"flex-wrap":e.wrap}},[e._l(e.showValue,(function(t,n){return i("div",{key:n,ref:"tag",refInFor:!0,staticClass:"item-label",style:{background:e.colorRgb(t.value,.1),"margin-bottom":e.itemBottom+"px",color:t.value}},[e._v(e._s(t.name))])})),e._v(" "),e.hideValue.length>0?i("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border"}},[i("div",{staticClass:"tooltip-box",attrs:{slot:"content"},slot:"content"},e._l(e.value,(function(t,n){return i("span",{directives:[{name:"show",rawName:"v-show",value:n>=e.maxTagCount,expression:"index >= maxTagCount"}],key:n,staticClass:"tooltip-item",style:{background:e.colorRgb(t.value,.1),"margin-bottom":e.itemBottom+"px",color:t.value}},[e._v("\n        "+e._s(t.name)+"\n      ")])}))),e._v(" "),i("el-button",{staticStyle:{height:"20px"},attrs:{size:"mini",icon:"el-icon-more"}})],1):e._e(),e._v(" "),e._t("default")],2)},D=[],F=(i("fb6a"),i("159b"),{name:"TagView",props:{value:null,wrap:{type:String,default:"nowrap"},itemBottom:{type:Number,default:4}},data:function(){return{maxTagCount:null}},computed:{showValue:function(){return"wrap"===this.wrap||null===this.maxTagCount?this.value:this.value.slice(0,this.maxTagCount)},hideValue:function(){return"wrap"===this.wrap?[]:this.value.slice(this.maxTagCount)}},mounted:function(){"nowrap"===this.wrap&&(this.setMaxTagCount(),window.addEventListener("resize",this.setMaxTagCount))},beforeDestroy:function(){"nowrap"===this.wrap&&window.removeEventListener("resize",this.setMaxTagCount)},methods:{colorRgb:function(e,t){return Object(d["c"])(e,t)},setMaxTagCount:function(){var e,t=this.$el.getBoundingClientRect().width,i=4,n=0,a=0;null===(e=this.$refs.tag)||void 0===e||e.forEach((function(e){n=e.getBoundingClientRect().width,t>=a*(n+i)+n&&a++})),this.maxTagCount=a}}}),V=F,$=(i("bda2"),Object(h["a"])(V,O,D,!1,null,"b287bd5a",null)),I=$.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-picture-preview",class:[e.wrap?"wrap":"nowrap"]},[e.showMorePicture?e._l(e.getPictureArray,(function(t,n){return i("preview-image",{key:n,staticClass:"preview",attrs:{src:t.url,index:n,"show-preview":""},on:{preview:e.handlePreview}})})):[i("preview-image",{class:[e.wrap?"is-wrap":"is-nowrap"],attrs:{src:e.getOnePicture,index:1,"show-preview":""},on:{preview:e.handlePreview}})]],2)},j=[],A=i("3835"),U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return!e.showPreview&&e.src?i("div",{staticClass:"adapter-image img-wrapper",on:{click:e.handlePreview}},[i("img",{staticClass:"small-img",attrs:{src:e.dataSrc,alt:""}})]):e.showPreview&&e.src?i("div",{staticClass:"img-popover adapter-image"},[i("div",{staticClass:"img-wrapper img-core",on:{click:e.handlePreview}},[i("img",{staticClass:"small-img",attrs:{src:e.dataSrc,alt:""}})]),e._v(" "),e.popoverFlag?i("el-popover",{attrs:{placement:"right",width:"200",trigger:"hover"},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[i("div",{staticClass:"middle-img img-wrapper",on:{click:function(t){return t.stopPropagation(),e.handleClick(t)}}},[e.popoverVisible?i("img",{staticClass:"middle-img-core",attrs:{src:e.dataSrc,alt:""}}):e._e()]),e._v(" "),i("div",{staticClass:"reference",attrs:{slot:"reference"},on:{click:e.handlePreview},slot:"reference"})]):e._e()],1):i("div",{staticClass:"adapter-image img-wrapper",staticStyle:{"background-color":"unset"},on:{click:function(e){e.stopPropagation()}}})},P=[],B={name:"PreviewImage",props:{src:{type:String,default:""},showPreview:{type:Boolean,default:!1},index:Number},data:function(){return{popoverVisible:!1,popoverFlag:!0,backgroundStyle:{}}},computed:{dataSrc:function(){return this.src?""+this.src:""}},methods:{handlePreview:function(){this.$emit("preview",this.index)},handleClick:function(e){var t=this;this.popoverFlag=!1,this.popoverVisible=!1,this.$nextTick((function(){t.popoverFlag=!0}))}}},W=B,H=(i("3fe8"),Object(h["a"])(W,U,P,!1,null,"cc7349e8",null)),R=H.exports,z=i("6bfe"),M={name:"WkPicturePreview",components:{PreviewImage:R},props:{wrap:{type:Boolean,default:!1},pictureUrl:[Array,String]},data:function(){return{}},computed:{showMorePicture:function(){return!!(Object(z["a"])(this.pictureUrl)||Object(z["e"])(this.pictureUrl)&&(this.pictureUrl.includes(",")||this.pictureUrl.includes("&")))},getPictureArray:function(){var e=this.pictureUrl;return Object(z["a"])(e)?e.map((function(e,t){return{url:Object(d["u"])(e.url),name:"preview".concat(t+1,".png")}})):Object(z["e"])(e)?e.split(",").map((function(e,t){return{url:Object(d["u"])(e),name:"preview".concat(t+1,".png")}})):[]},getOnePicture:function(){return Object(d["u"])(this.pictureUrl)}},methods:{handlePreview:function(e){this.$wkPreviewFile.preview({index:e,data:this.getBigPicInfo()})},getBigPicInfo:function(){var e=this.pictureUrl;return Object(z["a"])(e)?e.map((function(e,t){return e.name="preview".concat(t+1,".png"),e})):Object(z["e"])(e)&&e?e.split(",").map((function(e,t){if(e.includes("&")){var i=e.split("&"),n=Object(A["a"])(i,1),a=n[0];return{url:a,name:"preview".concat(t+1,".png")}}return{url:e,name:"preview".concat(t+1,".png")}})):[]}}},q=M,G=(i("0add"),Object(h["a"])(q,E,j,!1,null,"16914144",null)),X=G.exports,J=i("8ed6"),K=(i("a15b"),i("7403")),Z=i("2046"),Q=i("8c73"),Y=i("4360");function ee(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"--";if("position"===e){if(Object(z["a"])(t))return t.map((function(e){return null===e||void 0===e?void 0:e.name})).join()||i;if("string"===typeof t&&t)try{var n=JSON.parse(t);return Object(z["a"])(n)?n.map((function(e){return e.name})).join():i}catch(r){return i}return i}if("floatnumber"===e)return Object(z["c"])(t)?"":isNaN(t)?t:Object(Q["h"])(t);if("date"===e)return Object(d["w"])(t);if("location"===e)return Object(z["d"])(t)?t.address:i;if("date_interval"===e)return Object(z["a"])(t)?t.join("-"):i;if("percent"===e)return Object(z["c"])(t)?i:"".concat(t,"%");if("single_user"===e)return Object(z["d"])(t)?window.app.$getUserName(t)||i:t||i;if("select"===e){var a=Z["a"].methods.getRealParams({formType:e},t);return Object(z["c"])(a)?i:a}if("checkbox"===e){var s=Z["a"].methods.getRealParams({formType:e},t);return Object(z["c"])(s)?i:s}if("structure"===e){if(Object(z["a"])(t))return t.map((function(e){return e.name||e.deptName})).join()||i;if("string"===typeof t&&t){var o=Y["a"].getters.userDeptMap;if(o["dept-".concat(t)])return o["dept-".concat(t)].name}return t||i}if("user"===e){if(Object(z["a"])(t))return t.map((function(e){return window.app.$getUserName(e)||e.employeeName})).join()||i;if(Object(z["d"])(t))return window.app.$getUserName(t)||t.employeeName||i;if("string"===typeof t&&t){var l=Y["a"].getters.userDeptMap;if(l["user-".concat(t)])return window.app.$getUserName(l["user-".concat(t)])}return t||i}return"check_status"===e?K["a"].methods.getStatusName(t):Object(z["c"])(t)?i:t}var te={signatureHeight:"26px"},ie={name:"WkFieldView",components:{WkSignatureImage:o["a"],WkDescText:l["a"],MapView:m,FileListView:y,WkDetailTableView:T,WkGroup:N["a"],TagView:I,WkPicturePreview:X},props:{props:Object,formType:String,value:[String,Object,Array,Number],ignoreFields:{type:Array,default:function(){return[]}}},data:function(){return{mapViewShow:!1}},computed:{config:function(){return Object(J["a"])(Object(s["a"])({},te),this.props||{})},isEmpty:function(){return!["field_group","detail_table"].includes(this.formType)&&Object(z["c"])(this.value)&&!(this.ignoreFields.includes(this.props.field)||this.ignoreFields.includes(this.props.fieldName))},isCommonType:function(){return["text","textarea","select","checkbox","number","percent","mobile","email","date","datetime","date_interval","user","structure","position"].includes(this.formType)},isModule:function(){return["customer","business","contract","contacts"].includes(this.formType)},isInline:function(){return["website","category","field_attention"].includes(this.formType)}},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{objectHasValue:function(e,t){return!!Object(z["d"])(e)&&!Object(z["c"])(e[t])},openUrl:function(e){e.match(/^https?:\/\//i)||(e="http://"+e),window.open(e)},getCommonShowValue:function(){return ee(this.formType,this.value,"",this.props)}}},ne=ie,ae=(i("d3c6"),Object(h["a"])(ne,n,a,!1,null,"d2d6a2c4",null));t["default"]=ae.exports},"8a10":function(e,t,i){"use strict";i("f36d")},"8a40":function(e,t,i){"use strict";i("8b06")},"8b06":function(e,t,i){},"8c67":function(e,t,i){},"8cf0":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"elclickoutside",rawName:"v-elclickoutside",value:e.handleClose,expression:"handleClose"}],ref:"reference",staticClass:"wk-user-dep-select xh-form-border",class:[e.disabled?"is_disabled":"is_valid",{is_focus:e.visible}],attrs:{wrap:"wrap"},on:{click:e.containerClick}},[i("div",{staticClass:"el-select__tags"},[e._l(e.showUserSelects,(function(t,n){return i("span",{key:"user"+n,staticClass:"user-item text-one-line"},[e._v(e._s(e.$getUserName(t,e.userPropsValue.label))+"\n      "),i("i",{staticClass:"delete-icon el-icon-close",on:{click:function(t){t.stopPropagation(),e.deleteuser(n)}}})])})),e._v(" "),e._l(e.showDepSelects,(function(t,n){return i("span",{key:"dep"+n,staticClass:"user-item text-one-line"},[e._v(e._s(e.$getDeptName(t,e.depPropsValue.label))+"\n      "),i("i",{staticClass:"delete-icon el-icon-close",on:{click:function(t){t.stopPropagation(),e.deleteDep(n)}}})])}))],2),e._v(" "),e.depSelects.length+e.userSelects.length>e.max?i("el-tooltip",{attrs:{content:e.getTooltipText(),effect:"dark",placement:"top"}},[i("i",{staticClass:"el-icon-more"})]):e._e(),e._v(" "),i("i",{class:["el-icon-arrow-up"]}),e._v(" "),e.depSelects.length+e.userSelects.length==0?i("div",{staticClass:"user-placeholder text-one-line"},[e._v(e._s(e.placeholder))]):e._e(),e._v(" "),i("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":e.handleMenuEnter,"after-leave":e.doDestroy}},[i("wk-select-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.visible&&!e.disabled,expression:"visible && !disabled"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"popper",attrs:{"append-to-body":e.popperAppendToBody}},[i("wk-user-dep",{ref:"userDep",attrs:{radio:e.radio,"user-props":e.userPropsValue,"user-value":e.userDataValue,props:e.props,"dep-props":e.depPropsValue,"dep-value":e.depDataValue,disabled:e.disabled},on:{userChange:e.userChange,depChange:e.depChange,close:function(t){e.visible=!1}}})],1)],1)],1)},a=[],s=i("5530"),o=(i("a9e3"),i("fb6a"),i("4de4"),i("d3b7"),i("caad"),i("2532"),i("159b"),i("14d9"),i("d81d"),i("a434"),i("a15b"),i("f363")),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"xh-user"},[e.headerShow?i("div",{staticClass:"xh-user__hd"},[e._v("\n    "+e._s(e.title)+"\n  ")]):e._e(),e._v(" "),i("div",{staticClass:"xh-user__bd"},[i("el-autocomplete",{attrs:{disabled:e.disabled,"popper-append-to-body":!1,"fetch-suggestions":e.searchListUser,placeholder:"请输入内容"},on:{select:e.searchSelect},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[i("span",[e._v(e._s(e.$getUserName(n,e.userConfig.label)))]),e._v(" "),i("span",{staticStyle:{color:"#6b778c"}},[e._v(e._s("("+(e.$getDeptName(n)||"")+(e.$getDeptName(n)?"-":"")+(n.post||"无")+")"))])]}}]),model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}}),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"search-list"},[e.breadcrumbList.length>0&&!e.config.isList?i("el-breadcrumb",{staticStyle:{padding:"5px 0"},attrs:{"separator-class":"el-icon-arrow-right"}},e._l(e.breadcrumbList,(function(t,n){return i("el-breadcrumb-item",{key:n},[i("a",{attrs:{href:"javascript:;"},on:{click:function(i){e.breadcrumbBtn(t,n)}}},[e._v(e._s(t.label))])])}))):e._e(),e._v(" "),e.currentBreadcrumbItem?i("div",{staticClass:"xh-user__list"},[e.radio?e._e():i("el-checkbox",{staticStyle:{"line-height":"30px"},attrs:{disabled:e.disabled},on:{change:e.handleCheckAllChange},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}},[e._v("全选")]),e._v(" "),i("wk-dep-checkbox",{ref:"depCheckbox",class:"is-select-"+e.config.selectType,attrs:{radio:e.radio,data:e.currentBreadcrumbItem.deptList,props:e.depConfig,disabled:e.disabled||"user"===e.config.selectType},on:{next:e.nextDebounceClick,change:e.depCheckboxChange,"all-select":e.depAllSelect},model:{value:e.depDataValue,callback:function(t){e.depDataValue=t},expression:"depDataValue"}}),e._v(" "),i("wk-user-checkbox",{ref:"userCheckbox",class:"is-select-"+e.config.selectType,attrs:{radio:e.radio,data:e.currentBreadcrumbItem.employeeList,props:e.userConfig,disabled:e.disabled||"dep"===e.config.selectType},on:{change:e.userCheckboxChange,"all-select":e.userAllSelect},model:{value:e.userDataValue,callback:function(t){e.userDataValue=t},expression:"userDataValue"}})],1):e._e()],1)],1),e._v(" "),e.config.showFooter?i("flexbox",{staticClass:"xh-user__ft"},[i("flexbox-item",{staticClass:"select-info"},[e._v("已选择"),i("span",{staticClass:"select-info--num"},[e._v(e._s((e.depDataValue.length||0)+(e.userDataValue.length||0)))]),e._v("项")]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.clearAll}},[e._v("清空")]),e._v(" "),e.config.showSureBtn?i("el-button",{attrs:{type:"text"},on:{click:e.sureClick}},[e._v("确定")]):e._e()],1):e._e()],1)},r=[],c=(i("ac1f"),i("466d"),i("b0c0"),i("e17e")),d=i("7078"),u=i("2934"),p=i("7195"),h=i("aa59"),f=i("5956"),m=i("d22a"),v=i("8ed6"),b=i("7a1a"),g=i("ed08"),w=i("8122"),_=i("9608"),y={value:"userId",label:"realname"},x={value:"deptId",label:"name"},k={request:null,params:null,searchParams:null,dataType:"manage",isList:!1,showFooter:!0,showSureBtn:!1,selectType:"all"},C={name:"WkUserDep",components:{WkDepCheckbox:h["a"],WkUserCheckbox:f["a"]},inheritAttrs:!1,props:{headerShow:{type:Boolean,default:!0},options:Array,radio:Boolean,props:{type:Object,default:function(){return{}}},userProps:{type:Object,default:function(){return{}}},userValue:Array,depProps:{type:Object,default:function(){return{}}},depValue:Array,disabled:{type:Boolean,default:!1}},data:function(){return{loading:!1,searchInput:"",searchUserList:[],breadcrumbList:[],currentBreadcrumbItem:null,allChecked:!1,userAllChecked:!1,depAllChecked:!1,userDataValue:[],depDataValue:[]}},computed:{userConfig:function(){return Object(v["a"])(Object(s["a"])({},y),this.userProps||{})},depConfig:function(){return Object(v["a"])(Object(s["a"])({},x),this.depProps||{})},config:function(){return Object(v["a"])(Object(s["a"])({},k),this.props||{})},title:function(){return{all:"员工/部门",user:"员工",dep:"部门"}[this.config.selectType]}},watch:{breadcrumbList:function(){this.config.isList||(this.currentBreadcrumbItem=this.breadcrumbList[this.breadcrumbList.length-1])},options:{handler:function(){this.config.isList&&(this.currentBreadcrumbItem={employeeList:this.options})},immediate:!0},userValue:{handler:function(){Object(w["valueEquals"])(this.userValue,this.userDataValue)||(this.userDataValue=Object(g["z"])(this.userValue))},immediate:!0},depValue:{handler:function(){Object(w["valueEquals"])(this.depValue,this.depDataValue)||(this.depDataValue=Object(g["z"])(this.depValue))},immediate:!0}},created:function(){this.config.isList?this.nextDebounceClick=function(){}:(this.getDepUserList(0),this.nextDebounceClick=Object(b["debounce"])(300,this.nextClick))},methods:{searchListUser:function(e,t){var i=this;if(this.searchUserList&&this.searchUserList.length||this.options){var n=this.options||this.searchUserList;t(e?n.filter((function(t){return m["a"].match(t[i.userConfig.label]||"",e)||m["a"].match(i.$getDeptName(t)||"",e)})):n)}else{var a=this.getSearchRequest(),o={pageType:0};this.config.searchParams&&(o=Object(s["a"])(Object(s["a"])({},o),this.config.searchParams)),a(o).then((function(n){var a=n.data;i.searchUserList=a.hasOwnProperty("list")?a.list||[]:a||[],t(e?i.searchUserList.filter((function(t){return m["a"].match(t[i.userConfig.label]||"",e)})):i.searchUserList)})).catch((function(){}))}},getSearchRequest:function(){return this.props.isKpi?p["D"]:"hrm"===this.config.dataType?d["F"]:Object(_["a"])(this.config.request)||u["k"]},searchSelect:function(e){this.$refs.userCheckbox.searchSelect(e)},depCheckboxChange:function(e){var t=this;"user"!==this.config.selectType&&(this.radio&&(this.userDataValue&&this.userDataValue.length>0&&(this.userDataValue=[],this.config.showSureBtn||this.$emit("update:userValue",[])),this.$emit("close")),this.config.showSureBtn||(this.$emit("update:depValue",e),this.$nextTick((function(){t.$emit("depChange",e),t.$emit("change",t.userDataValue,e,"dep")}))))},userCheckboxChange:function(e){var t=this;"dep"!==this.config.selectType&&(this.radio&&(this.depDataValue&&this.depDataValue.length>0&&(this.depDataValue=[],this.config.showSureBtn||this.$emit("update:depValue",[])),this.$emit("close")),this.config.showSureBtn||(this.$emit("update:userValue",e),this.$nextTick((function(){t.$emit("userChange",e),t.$emit("change",e,t.depDataValue,"user")}))))},handleCheckAllChange:function(e){this.$refs.userCheckbox&&this.$refs.userCheckbox.handleCheckAllChange(e),this.$refs.depCheckbox&&this.$refs.depCheckbox.handleCheckAllChange(e)},userAllSelect:function(e){this.userAllChecked=e,!this.depAllChecked&&this.currentBreadcrumbItem.deptList&&0!==this.currentBreadcrumbItem.deptList.length&&"user"!==this.config.selectType||!this.userAllChecked?this.allChecked=!1:this.allChecked=!0},depAllSelect:function(e){this.depAllChecked=e,!this.depAllChecked||!this.userAllChecked&&this.currentBreadcrumbItem.employeeList&&0!==this.currentBreadcrumbItem.employeeList.length&&"dep"!==this.config.selectType?this.allChecked=!1:this.allChecked=!0},clearAll:function(){this.config.showSureBtn?(this.depDataValue=[],this.userDataValue=[]):(this.$emit("update:depValue",[]),this.$emit("update:userValue",[]),this.$emit("depChange",[]),this.$emit("userChange",[]))},sureClick:function(){this.$emit("update:depValue",this.depDataValue),this.$emit("update:userValue",this.userDataValue),this.$emit("depChange",this.depDataValue),this.$emit("userChange",this.userDataValue),this.$emit("change",this.userDataValue,this.userDataValue),this.$emit("close")},getDepUserList:function(e,t){var i=this;this.loading=!0;var n=this.props.isKpi?p["E"]:"hrm"===this.config.dataType?d["C"]:this.config.request||c["a"];n(e).then((function(n){var a=n.data||{},s=a.deptList||[],o=a.employeeList||a.userList||[];0==e?i.breadcrumbList=[{label:"全部",deptList:s,employeeList:o}]:i.breadcrumbList.push({label:t.name,deptList:s,employeeList:o}),i.loading=!1})).catch((function(){i.loading=!1}))},nextClick:function(e){this.getDepUserList(e.deptId,e)},breadcrumbBtn:function(e,t){t+1<=this.breadcrumbList.length-1&&this.breadcrumbList.splice(t+1,this.breadcrumbList.length-1)}}},S=C,L=(i("f4c9"),i("2877")),T=Object(L["a"])(S,l,r,!1,null,"3e1a0355",null),N=T.exports,O=i("d010"),D=i.n(O),F=i("2f62"),V={request:null,params:null,dataType:"manage",isList:!1},$={name:"WkUserDepSelect",components:{WkSelectDropdown:o["a"],WkUserDep:N},mixins:[D.a],props:{radio:Boolean,max:{type:Number,default:2},props:{type:Object,default:function(){return{}}},depProps:{type:Object,default:function(){return{}}},userProps:{type:Object,default:function(){return{}}},placeholder:{type:String,default:function(){return"请选择"}},depValue:{required:!0},userValue:{required:!0},depOptions:Array,userOptions:Array,disabled:{type:Boolean,default:!1},popperAppendToBody:{type:Boolean,default:!0}},data:function(){return{visible:!1,tabType:"user",depDataValue:[],userDataValue:[],loading:!1}},computed:Object(s["a"])(Object(s["a"])({},Object(F["b"])(["userList","deptList","hrmUserList","hrmDeptList"])),{},{showUserSelects:function(){return this.userSelects&&this.userSelects.length>this.max?this.userSelects.slice(0,this.max):this.userSelects},showDepSelects:function(){var e=0;return(this.userSelects&&this.userSelects.length<this.max||!this.userSelects)&&(e=this.max-this.userSelects.length),e>0&&this.depSelects?this.depSelects.slice(0,this.max):[]},userOptionsList:function(){return"manage"===this.config.dataType?this.userList:"hrm"===this.config.dataType?this.hrmUserList:[]},depOptionsList:function(){return"manage"===this.config.dataType?this.deptList:"hrm"===this.config.dataType?this.hrmDeptList:[]},depSelects:function(){return this.depOptionsList.length?this.getSelectList():[]},userSelects:function(){var e=this;return this.userOptionsList.length?this.userOptionsList.filter((function(t){return e.userDataValue.includes(t[e.userPropsValue.value])})):[]},config:function(){return Object(v["a"])(Object(s["a"])({},V),this.props||{})},depPropsValue:function(){var e={value:"deptId",label:"name"};return"hrm"===this.config.dataType&&(e.value="deptId",e.label="name"),this.depProps?Object(s["a"])(Object(s["a"])({},e),this.depProps):e},userPropsValue:function(){var e={value:"userId",label:"realname"};return"hrm"===this.config.dataType&&(e.value="employeeId",e.label="employeeName"),this.userProps?Object(s["a"])(Object(s["a"])({},e),this.userProps):e}}),watch:{visible:function(e){e?this.broadcast("WkSelectDropdown","updatePopper"):this.broadcast("WkSelectDropdown","destroyPopper"),this.$emit("visible-change",e)},depValue:function(){this.depVerifyValue()},depDataValue:function(e,t){Object(w["valueEquals"])(e,this.depValue)||(this.radio?this.$emit("update:depValue",this.depDataValue&&this.depDataValue.length?this.depDataValue[0]:""):this.$emit("update:depValue",this.depDataValue))},userValue:function(){this.userVerifyValue()},userDataValue:function(e,t){Object(w["valueEquals"])(e,this.userValue)||(this.radio?this.$emit("update:userValue",this.userDataValue&&this.userDataValue.length?this.userDataValue[0]:""):this.$emit("update:userValue",this.userDataValue))},depProps:{handler:function(){this.requestDepList()},immediate:!0},userProps:{handler:function(){this.requestUserList()},immediate:!0}},created:function(){this.debounceUserDeptChange=Object(b["debounce"])(300,this.userDeptChange)},mounted:function(){this.depVerifyValue(),this.userVerifyValue()},methods:{getSelectList:function(){var e=[];return this.recursionOptions(this.depOptionsList,this.depDataValue,e),e},recursionOptions:function(e,t,i){var n=this;e.forEach((function(e){t.includes(e[n.depPropsValue.value])&&i.push(e),e.children&&n.recursionOptions(e.children,t,i)}))},depVerifyValue:function(){var e=this;if(this.radio||Array.isArray(this.depValue)||this.$emit("update:depValue",[]),this.radio&&(Array.isArray(this.depValue)||null===this.depValue||void 0===this.depValue)&&this.$emit("update:depValue",""),this.radio)this.depValue!==this.depDataValue&&(this.depValue?this.depDataValue=[this.depValue]:this.depDataValue=[]);else if(!Object(w["valueEquals"])(this.depValue,this.depDataValue))if(this.depValue&&this.depValue.length){var t=this.depValue[0];t[this.depPropsValue.value]?this.depDataValue=this.depValue.map((function(t){return t[e.depPropsValue.value]})):this.depDataValue=Object(g["z"])(this.depValue)}else this.depDataValue=[]},requestDepList:function(){return"manage"===this.config.dataType?this.$store.dispatch("debounceGetDeptList"):"hrm"===this.config.dataType&&this.$store.dispatch("debounceGetHrmDeptList"),[]},handleClose:function(){this.visible=!1},handleMenuEnter:function(){},doDestroy:function(){this.$refs.popper&&this.$refs.popper.doDestroy()},deleteDep:function(e){if(!this.disabled){var t=Object(g["z"])(this.depDataValue);t.splice(e,1),this.depDataValue=t,this.wkDepChange()}},focusClick:function(){this.$emit("focus")},wkDepChange:function(){var e=this;this.$nextTick((function(){e.radio?e.dispatch("ElFormItem","el.form.change",e.depDataValue&&e.depDataValue.length?e.depDataValue[0]:""):e.dispatch("ElFormItem","el.form.change",e.depDataValue),e.debounceUserDeptChange("dep")}))},containerClick:function(){this.disabled||(this.visible=!this.visible)},userVerifyValue:function(){var e=this;if(this.radio||Array.isArray(this.userValue)||this.$emit("update:userValue",[]),this.radio&&(Array.isArray(this.userValue)||null===this.userValue||void 0===this.userValue)&&this.$emit("update:userValue",""),this.radio)this.userValue!==this.userDataValue&&(this.userValue?this.userDataValue=[this.userValue]:this.userDataValue=[]);else if(!Object(w["valueEquals"])(this.userValue,this.userDataValue))if(this.userValue&&this.userValue.length){var t=this.userValue[0];t[this.userPropsValue.value]?this.userDataValue=this.userValue.map((function(t){return t[e.userPropsValue.value]})):this.userDataValue=Object(g["z"])(this.userValue)}else this.userDataValue=[]},requestUserList:function(){"manage"===this.config.dataType?this.$store.dispatch("debounceGetUserList"):"hrm"===this.config.dataType&&this.$store.dispatch("debounceGetHrmUserList")},deleteuser:function(e){this.disabled||(this.userDataValue.splice(e,1),this.wkUserChange())},wkUserChange:function(){var e=this;this.$nextTick((function(){e.radio?e.dispatch("ElFormItem","el.form.change",e.userDataValue&&e.userDataValue.length?e.userDataValue[0]:""):e.dispatch("ElFormItem","el.form.change",e.userDataValue),e.debounceUserDeptChange("user")}))},getTooltipText:function(){var e=this,t=this.depSelects||[],i=t.map((function(t){return e.$getDeptName(t,e.depPropsValue.label)})).join("、"),n=this.userSelects||[],a=n.map((function(t){return e.$getUserName(t,e.userPropsValue.label)})).join("、");return i&&a&&(i+="、"),i+a},userChange:function(e){this.userDataValue=e,this.wkUserChange()},depChange:function(e){this.depDataValue=e,this.wkDepChange()},userDeptChange:function(e){this.$emit("change",this.userDataValue,this.depDataValue,this.userSelects,this.depSelects,e)}}},I=$,E=(i("989d"),Object(L["a"])(I,n,a,!1,null,"55c50a12",null));t["a"]=E.exports},"8d09":function(e,t,i){"use strict";i("90f4")},"8e93":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"xr-table-header"},[i("flexbox",{directives:[{name:"show",rawName:"v-show",value:!e.handleShow,expression:"!handleShow"}],staticClass:"xr-table-header__body",attrs:{align:"center"}},[e._t("default")],2),e._v(" "),i("flexbox",{directives:[{name:"show",rawName:"v-show",value:e.handleShow,expression:"handleShow"}],staticClass:"xr-table-header__handle"},[i("div",{staticClass:"selected—title"},[e._v("已选中 "),i("span",{staticClass:"selected—count"},[e._v(e._s(e.selects.length))]),e._v(" 项")]),e._v(" "),i("flexbox",{staticClass:"selection-items-box"},[e._t("prefix"),e._v(" "),e._l(e.handles,(function(t,n){return i("el-button",{key:n,attrs:{icon:e._f("wkIconPre")(t.icon),size:"medium"},on:{click:function(i){e.selectionBarClick(t.command)}}},[e._v(e._s(t.label))])})),e._v(" "),e._t("suffix")],2)],1),e._v(" "),e._t("append")],2)},a=[],s={name:"XrTableHeader",components:{},props:{selects:{type:Array,default:function(){return[]}},handles:{type:Array,default:function(){return[]}}},data:function(){return{}},computed:{handleShow:function(){return this.selects&&this.selects.length>0}},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{selectionBarClick:function(e){this.$emit("command",e)}}},o=s,l=(i("6641"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"4a1d5a74",null);t["a"]=r.exports},"8f37":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{staticClass:"reminder-wrapper"},[i("flexbox",{staticClass:"reminder-body",attrs:{align:"stretch"}},[i("i",{staticClass:"wk wk-warning reminder-icon"}),e._v(" "),i("div",{staticClass:"reminder-content",style:{"font-size":e.fontSize+"px"},domProps:{innerHTML:e._s(e.content)}}),e._v(" "),e._t("default"),e._v(" "),e.closeShow?i("i",{staticClass:"el-icon-close close",on:{click:e.close}}):e._e()],2)],1)},a=[],s={name:"Reminder",components:{},props:{closeShow:{type:Boolean,default:!1},content:{type:String,default:"内容"},fontSize:{type:String,default:"14"}},data:function(){return{}},computed:{},mounted:function(){},destroyed:function(){},methods:{close:function(){this.$emit("close")}}},o=s,l=(i("b694"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"82904f82",null);t["a"]=r.exports},"8f7f":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-base-detail"},e._l(e.list,(function(t,n){return i("create-sections",{key:n,staticClass:"wk-base-detail__section",attrs:{title:t.name,"dropdown-items":e.dropdownItems,"content-height":"auto"},on:{"command-select":e.sectionCommandSelect}},[i("wk-base-detail-section",{attrs:{list:t.list}}),e._v(" "),i("div",{staticClass:"wk-base-detail__more",attrs:{slot:"header"},slot:"header"},[e._t("more")],2),e._v(" "),e._t("default")],2)})))},a=[],s=i("10ff"),o=i("94c8"),l={name:"WkBaseDetail",components:{CreateSections:s["a"],WkBaseDetailSection:o["a"]},props:{list:Array,dropdownItems:Array},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{sectionCommandSelect:function(e){this.$emit("top-command-select",e)}}},r=l,c=(i("ff1b"),i("2877")),d=Object(c["a"])(r,n,a,!1,null,"cbb3fbb2",null);t["a"]=d.exports},9011:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-popover",e._g(e._b({staticClass:"wk-popover-filter",on:{hide:e.hide},model:{value:e.popverShow,callback:function(t){e.popverShow=t},expression:"popverShow"}},"el-popover",e.$attrs,!1),e.$listeners),[i("div",{staticStyle:{padding:"3px 12px"}},[i("wk-form",{staticClass:"wk-filter-form",attrs:{"field-from":e.from,"field-list":e.fieldList,"custom-class":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return[n&&"range"==n.formType?i("div",{staticClass:"wk-range-select"},[i("flexbox",{staticClass:"wk-range-select__top"},[i("el-input-number",{attrs:{precision:n.hasOwnProperty("precision")?n.precision:void 0,maxlength:"100",controls:!1},model:{value:e.from[n.field][0],callback:function(t){e.$set(e.from[n.field],0,t)},expression:"from[data.field][0]"}}),e._v(" "),i("span",{staticClass:"range-separator"},[e._v("至")]),e._v(" "),i("el-input-number",{attrs:{precision:n.hasOwnProperty("precision")?n.precision:void 0,maxlength:"100",controls:!1},model:{value:e.from[n.field][1],callback:function(t){e.$set(e.from[n.field],1,t)},expression:"from[data.field][1]"}})],1)],1):e._e(),e._v(" "),e._t("default",null,{data:n})]}}])}),e._v(" "),i("div",[i("el-button",{attrs:{type:"primary"},on:{click:e.sureClick}},[e._v("确定")]),e._v(" "),i("el-button",{on:{click:e.resetClick}},[e._v("重置")])],1)],1),e._v(" "),i("el-button",{staticClass:"filter-button",attrs:{slot:"reference",type:e.popverShow?"selected":"",icon:"wk wk-screening"},slot:"reference"},[e._v("高级筛选")])],1)},a=[],s=(i("d3b7"),i("159b"),i("5067")),o=i("ed08"),l={name:"WkPopoverFilter",components:{WkForm:s["a"]},inheritAttrs:!1,props:{hasContent:{type:Boolean,default:!1},fieldFrom:Object,fieldList:Array},data:function(){return{popverShow:!1,from:{}}},computed:{},watch:{popverShow:function(e){this.$emit(e?"show":"hide")},fieldFrom:{handler:function(){var e=Object(o["z"])(this.fieldFrom);this.fieldList.forEach((function(t){"range"==t.formType&&(e[t.field]=e[t.field]?e[t.field]:["",""])})),this.from=e},immediate:!0}},mounted:function(){},beforeDestroy:function(){},methods:{sureClick:function(){this.$emit("update:fieldFrom",this.from),this.$emit("sure",Object(o["z"])(this.from)),this.popverShow=!1},resetClick:function(){this.$emit("reset")},hide:function(){var e=Object(o["z"])(this.fieldFrom);this.fieldList.forEach((function(t){"range"==t.formType&&(e[t.field]=e[t.field]?e[t.field]:["",""])})),this.from=e}}},r=l,c=(i("59fc"),i("2877")),d=Object(c["a"])(r,n,a,!1,null,"1de31dfd",null);t["a"]=d.exports},"90f4":function(e,t,i){},9187:function(e,t,i){"use strict";i("7c26")},"933c":function(e,t,i){"use strict";i("32dc")},"940c":function(e,t,i){},"94c8":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{staticClass:"wk-base-detail-section",attrs:{gutter:e.gutter,align:"stretch",wrap:"wrap"}},[e._l(e.list,(function(t,n){return i("flexbox-item",{key:n,attrs:{span:t.span?t.span:.5}},[i("div",{staticClass:"wk-base-detail-section__item"},[i("div",{staticClass:"item-name"},[e._v(e._s(t.label))]),e._v(" "),i("div",{staticClass:"item-value"},[e._v(e._s(t.value))])])])})),e._v(" "),e.dropdownItems&&e.dropdownItems.length>0?i("el-dropdown",{staticClass:"wk-base-detail-section__more",attrs:{trigger:"hover"},on:{command:e.handleTypeClick}},[i("i",{staticClass:"el-icon-more",staticStyle:{cursor:"pointer"}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.dropdownItems,(function(t,n){return i("el-dropdown-item",{key:n,attrs:{icon:t.icon,command:t.command}},[e._v(e._s(t.label))])})))],1):e._e(),e._v(" "),e._t("default")],2)},a=[],s=(i("a9e3"),{name:"WkBaseDetailSection",components:{},props:{list:Array,gutter:{type:Number,default:0},dropdownItems:Array},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{handleTypeClick:function(e){this.$emit("command-select",e)}}}),o=s,l=(i("8a40"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"55afd113",null);t["a"]=r.exports},"961b":function(e,t,i){},"987e":function(e,t,i){},"989d":function(e,t,i){"use strict";i("3b0f")},"9c1d":function(e,t,i){"use strict";i("273f")},a0dd:function(e,t,i){},a2d1:function(e,t,i){"use strict";i("4859")},a303:function(e,t,i){},b592:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("wk-tags-view",{staticClass:"wk-user-dep-dialog-select",attrs:{selected:e.selected,visible:e.visible,disabled:e.disabled,placeholder:e.placeholder,"collapse-tags":e.collapseTags,"value-key":["nickname","realname","name"]},on:{"remove-tag":e.removeTag},nativeOn:{click:function(t){return e.click(t)}}},[i("wk-dep-user-dialog",e._b({ref:"depUserDialog",attrs:{"user-value":e.selectUserValue,"dep-value":e.selectDepValue,"sub-dept-contain":e.selectSubDeptContain,props:e.props,visible:e.visible,radio:e.radio,disabled:e.disabled},on:{"update:visible":function(t){e.visible=t},change:e.depUserDialogChange}},"wk-dep-user-dialog",e.$attrs,!1))],1)},a=[],s=i("5530"),o=(i("a9e3"),i("d3b7"),i("159b"),i("14d9"),i("99af"),i("a434"),i("2581")),l=i("58fa"),r=i("2f62"),c=i("8ed6"),d=i("d010"),u=i.n(d),p=i("ed08"),h={value:"deptId",label:"name"},f={name:"WkUserDepDialogSelect",components:{WkDepUserDialog:o["a"],WkTagsView:l["a"]},mixins:[u.a],props:{radio:Boolean,userValue:{type:Array,default:function(){return[]}},depValue:{type:Array,default:function(){return[]}},subDeptContain:[Number,Boolean],placeholder:{type:String,default:function(){return"请选择"}},collapseTags:Boolean,disabled:{type:Boolean,default:!1},props:{type:Object,default:function(){return{showDisableUser:!1}}}},data:function(){return{visible:!1,selectUserValue:[],selectDepValue:[],selectSubDeptContain:!1,dataValue:[]}},computed:Object(s["a"])(Object(s["a"])({},Object(r["b"])(["userDeptMap"])),{},{userSelectData:function(){var e=this,t=[];return this.selectUserValue.forEach((function(i){var n=e.userDeptMap["user-".concat(i)];n&&t.push(n)})),t},deptSelectData:function(){var e=this,t=[];return this.selectDepValue.forEach((function(i){var n=e.userDeptMap["dept-".concat(i)];n&&t.push(n)})),t},selected:function(){return this.userSelectData.concat(this.deptSelectData)},config:function(){return Object(c["a"])(Object(s["a"])({},h),this.props||{})}}),watch:{userValue:{handler:function(){this.selectUserValue=Object(p["z"])(this.userValue)},immediate:!0},depValue:{handler:function(){this.selectDepValue=Object(p["z"])(this.depValue)},immediate:!0},subDeptContain:{handler:function(){this.selectSubDeptContain=this.subDeptContain},immediate:!0}},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{removeTag:function(e){e<this.selectUserValue.length?this.selectUserValue.splice(e,1):this.selectDepValue.splice(e-this.selectUserValue.length,1),this.depUserDialogChange(this.selectUserValue,this.selectDepValue)},depUserDialogChange:function(e,t,i,n,a){var s=this;this.selectUserValue=e,this.selectDepValue=t,this.selectSubDeptContain=a,this.$emit("update:userValue",this.selectUserValue),this.$emit("update:depValue",this.selectDepValue),this.$emit("update:subDeptContain",this.selectSubDeptContain),this.$nextTick((function(){s.dispatch("ElFormItem","el.form.change",e.concat(t)),s.$emit("change",e,t,s.userSelectData,s.deptSelectData,s.selectSubDeptContain)}))},click:function(){this.disabled||(this.visible=!0)}}},m=f,v=i("2877"),b=Object(v["a"])(m,n,a,!1,null,"224c1725",null);t["a"]=b.exports},b694:function(e,t,i){"use strict";i("fd75")},bb22:function(e,t,i){},bb2e:function(e,t,i){},bd2f:function(e,t,i){e.exports={colorPrimary:"#0052cc",colorBlack:"#172b4d",colorSuccess:"#36b37e",colorWarning:"#ffab00",colorDanger:"#ff5630",colorN40:"#dfe1e6",axisLineColor:"#dfe1e6",axisLabelFontWeight:"500"}},bda2:function(e,t,i){"use strict";i("2a90")},be09:function(e,t,i){e.exports={colorPrimary:"#0052cc",colorBlack:"#172b4d",colorSuccess:"#36b37e",colorWarning:"#ffab00",colorDanger:"#ff5630",colorN40:"#dfe1e6",axisLineColor:"#dfe1e6",axisLabelFontWeight:"500"}},be40:function(e,t,i){"use strict";i("987e")},c681:function(e,t,i){},d165:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-base-detail"},e._l(e.list,(function(t,n){return i("create-sections",{key:n,staticClass:"wk-base-detail__section",attrs:{title:t.name,"dropdown-items":e.dropdownItems,"content-height":"auto"},on:{"command-select":e.sectionCommandSelect}},[i("wk-custom-base-detail-section",{attrs:{list:t.list},scopedSlots:e._u([{key:"data",fn:function(t){var i=t.data;return[e._t("data",null,{data:i})]}}])}),e._v(" "),i("div",{staticClass:"wk-base-detail__more",attrs:{slot:"header"},slot:"header"},[e._t("more")],2),e._v(" "),e._t("default")],2)})))},a=[],s=i("10ff"),o=i("4445"),l={name:"WkCustomBaseDetail",components:{CreateSections:s["a"],WkCustomBaseDetailSection:o["a"]},props:{list:Array,dropdownItems:Array},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{sectionCommandSelect:function(e){this.$emit("top-command-select",e)}}},r=l,c=(i("2d2d"),i("2877")),d=Object(c["a"])(r,n,a,!1,null,"5b9ae480",null);t["a"]=d.exports},d1d1:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.examineFlowList&&e.examineFlowList.length>0?i("wk-head-section",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{label:"审批流信息"}},[i("el-popover",{ref:"popover",attrs:{slot:"right",placement:e.placement,width:"300",trigger:"click"},slot:"right",model:{value:e.showFlowPopover,callback:function(t){e.showFlowPopover=t},expression:"showFlowPopover"}},[i("check-flow",{ref:"checkFlow",attrs:{id:e.recordId,"type-id":e.id,show:e.showFlowPopover,"examine-type":e.examineType},on:{close:function(t){e.showFlowPopover=!1}}}),e._v(" "),i("el-button",{staticStyle:{"margin-right":"8px"},attrs:{slot:"reference",type:"text"},on:{click:function(e){e.stopPropagation()}},slot:"reference"},[e._v("查看历史审批流程")])],1),e._v(" "),i("el-timeline",e._l(e.examineFlowList,(function(t,n){return i("el-timeline-item",{key:n,attrs:{"hide-timestamp":""}},[7!=t.examineType?i("i",{staticClass:"examine-item-icon",class:e.getStatusIcon(t.examineStatus),style:{color:e.getStatusColor(t.examineStatus)},attrs:{slot:"dot"},slot:"dot"}):i("i",{staticClass:"examine-item-icon wk wk-source-line",staticStyle:{color:"#5e6c84"},attrs:{slot:"dot"},slot:"dot"}),e._v(" "),i("div",{staticClass:"examine-item"},[i("div",{staticClass:"examine-item__hd ei"},[i("div",[i("span",{staticClass:"ei-status"},[e._v(e._s(e.examineNodeName(t)))]),e._v(" "),e.examineCategory(t.type)&&7!=t.examineType&&t.userList&&t.userList.length>1?i("el-tag",{attrs:{"disable-transitions":!0}},[e._v(e._s(e.examineCategory(t.type)))]):e._e(),e._v(" "),e.singleNodeDisableUserShow(t)?i("flexbox",{staticStyle:{"margin-top":"10px"}},[i("xr-avatar",{attrs:{name:e.getDetailName(t),size:20}}),e._v(" "),i("span",{staticClass:"ei-name"},[e._v("\n                "+e._s(e.getDetailName(t))+"\n                "+e._s(7==t.examineType&&0==t.userList[0].userStatus?"(已停用)":"")+"\n                "),t.userList[0].hasOwnProperty("seekUser")&&t.userList[0].seekUser?i("span",{staticClass:"other-people"},[i("i",{staticClass:"wk wk-new-employee"}),e._v("\n                  已征求他人意见")]):e._e()]),e._v(" "),11!=t.userList[0].examineStatus&&7!=t.examineType&&13!=t.userList[0].examineStatus&&8!=t.userList[0].examineStatus?i("span",{staticClass:"ei-status"},[e._v(e._s(e.getShowStatusName(t.userList[0].examineStatus,t.isAdminSkip)))]):e._e()],1):e._e()],1),e._v(" "),1===t.userList.length?i("div",{staticClass:"ei-time"},[i("span",[e._v(e._s(t.userList[0].examineTime))]),e._v(" "),t.isAdminSkip?i("div",{staticClass:"examine-error"},[e._v(e._s(t.userList[0].remarks))]):e._e(),e._v(" "),e.showOneUserExamine(t)?i("div",{staticClass:"examine-error"},[i("i",{staticClass:"el-icon-warning"}),e._v("\n              "+e._s(e.showOneUserExamine(t))+"\n            ")]):e._e(),e._v(" "),(t.userList[0].duration||t.userList[0].passFlag)&&e.examineAdvancedConfigVO.advancedLimitTimeVO&&1!=e.examineAdvancedConfigVO.advancedLimitTimeVO.handleType&&0!=t.userList[0].userStatus?i("div",{staticClass:"ei-time-limit",style:e.autoExamineText(t.userList[0].duration,t.userList[0].examineStatus,t.userList[0].passFlag,t.userList[0])["class"]},[e._v(e._s(e.autoExamineText(t.userList[0].duration,t.userList[0].examineStatus,t.userList[0].passFlag,t.userList[0])["text"])+"\n            ")]):e._e(),e._v(" "),t.userList[0].duration&&0==t.userList[0].userStatus&&e.timeLimitStyleShow?i("div",{staticClass:"examine-error"},[i("i",{staticClass:"el-icon-warning"}),e._v("\n              "+e._s(e.limitDisableShow())+"\n            ")]):e._e()]):e._e(),e._v(" "),1===t.userList.length&&e.canCheckEditFieldData(t)&&!t.isAdminSkip?i("div",[i("el-button",{attrs:{type:"primary-text"},on:{click:function(i){e.checkEditFieldDataClick(t)}}},[e._v("查看节点编辑信息")])],1):e._e()]),e._v(" "),t.userList.length>1?i("div",{staticClass:"examine-item__bd"},[e._l(t.userList,(function(n,a){return i("div",{key:a,staticClass:"examine-item__hd ei"},[e.disableAvatarUserShow(n)?i("flexbox",{class:n.hasOwnProperty("handlerType")&&[1,3].includes(n.handlerType)?"examine-care-of":""},[n.hasOwnProperty("handlerType")&&[1,3].includes(n.handlerType)?i("i",{staticClass:"wk wk-icon-reply",class:n.hasOwnProperty("handlerType")&&[1,3].includes(n.handlerType)?"care-of":""}):e._e(),e._v(" "),i("xr-avatar",{attrs:{name:e.$getUserName(n),size:20}}),e._v(" "),i("span",{staticClass:"ei-name"},[e._v("\n                "+e._s(e.$getUserName(n)||n.outerUserEmail)+"\n                "+e._s(7==t.examineType&&0==n.userStatus?"(已停用)":"")+"\n                "),n.hasOwnProperty("seekUser")&&n.seekUser?i("span",{staticClass:"other-people"},[i("i",{staticClass:"wk wk-new-employee"}),e._v("\n                  已征求他人意见")]):e._e()]),e._v(" "),11!=n.examineStatus&&17!=n.examineStatus&&7!=t.examineType&&13!=n.examineStatus&&8!=n.examineStatus?i("span",{staticClass:"ei-status"},[e._v(e._s(e.getShowStatusName(n.examineStatus,t.isAdminSkip)))]):7==t.examineType&&[18,19,14,15].includes(Number(n.examineStatus))?i("span",{staticClass:"ei-status"},[e._v(e._s(e.getShowStatusName(n.examineStatus)))]):e._e(),e._v(" "),11==n.examineStatus?i("span",{staticClass:"ei-status"},[e._v("已转审")]):17==n.examineStatus?i("span",{staticClass:"ei-status"},[e._v("已委托")]):e._e()],1):e._e(),e._v(" "),0!=n.userStatus&&102!=n.passFlag&&202!=n.passFlag?i("div",{staticClass:"ei-time"},[e._v(e._s(n.examineTime))]):e._e(),e._v(" "),(n.duration||n.passFlag)&&e.examineAdvancedConfigVO.advancedLimitTimeVO&&1!=e.examineAdvancedConfigVO.advancedLimitTimeVO.handleType&&0!=n.userStatus?i("div",{staticClass:"ei-time-limit",style:e.autoExamineText(n.duration,n.examineStatus,n.passFlag,n)["class"]},[e._v("\n              "+e._s(e.autoExamineText(n.duration,n.examineStatus,n.passFlag,n)["text"])+"\n            ")]):e._e(),e._v(" "),e.disableUserShow(n.passFlag,n.examineStatus,n)?i("div",{staticClass:"examine-error"},[i("i",{staticClass:"el-icon-warning"}),e._v("\n              "+e._s(e.disableUserShow(n.passFlag,n.examineStatus,n))+"\n            ")]):e._e()],1)})),e._v(" "),302==t.passFlag?i("div",{staticClass:"examine-error"},[i("i",{staticClass:"el-icon-warning"}),e._v("\n            转交人不存在已自动终止\n          ")]):e._e(),e._v(" "),e.showMultiplayerExamine(t.passFlag,t.userList,!0)&&7!=t.examineType?i("div",{staticClass:"examine-error"},[i("i",{staticClass:"el-icon-warning"}),e._v("\n            "+e._s(e.showMultiplayerExamine(t.passFlag,t.userList))+"\n          ")]):e._e(),e._v(" "),e.canCheckEditFieldData(t)&&!t.isAdminSkip?i("div",[i("el-button",{attrs:{type:"primary-text"},on:{click:function(i){e.checkEditFieldDataClick(t)}}},[e._v("查看节点编辑信息")])],1):e._e()],2):e._e()])])}))),e._v(" "),i("div",{staticClass:"examine-config"},[i("span",{on:{click:e.checkExamineConfig}},[e._v("查看审批配置")])]),e._v(" "),e.isFieldAuthExamine&&!e.externalMailbox?[!e.isOptionalNode&&(1==e.examineInfo.isCheck||1==e.examineInfo.isRecheck)||e.isOptionalNode||!e.isOptionalNode&&e.superRestoreHandleShow||e.examineMoreHandle.length?i("div",{staticClass:"examine-footer"},[e.isOptionalNode||1!=e.examineInfo.isCheck?e._e():i("el-button",{attrs:{type:"primary"},on:{click:e.examineClick}},[e._v("审批")]),e._v(" "),e.isOptionalNode?i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.examineHandleClick("selectExamineUser")}}},[e._v(e._s(e.isOptionalNode.addBtnName))]):e._e(),e._v(" "),!e.isOptionalNode&&e.superRestoreHandleShow?i("el-button",{staticStyle:{"margin-left":"auto"},attrs:{type:"primary"},on:{click:function(t){e.examineHandleClick(19)}}},[e._v("恢复")]):e._e(),e._v(" "),e.examineMoreHandle.length?i("el-dropdown",{staticClass:"more-handle",style:e.isStageFlow?"margin-left: 10px;":"",on:{command:e.moreHandlerClick}},[i("el-button",[e._v("更多操作")]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.examineMoreHandle,(function(t,n){return i("el-dropdown-item",{key:n,attrs:{command:t.value},on:{click:function(e){e.stopPropagation()}}},["forwardOthers"==t.value?[e.isStageFlow?i("span",{on:{click:function(t){t.stopPropagation(),e.moreHandlerClick("selectUser")}}},[e._v("转他人处理")]):i("el-dropdown",{staticClass:"more-handle",on:{command:e.moreHandlerClick}},[i("div",[e._v("转他人处理")]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"selectUser"}},[e._v("选择员工")]),e._v(" "),i("el-dropdown-item",{attrs:{command:"external"}},[e._v("选择外部联系人")])],1)],1)]:[e._v("\n              "+e._s(t.label)+"\n            ")]],2)})))],1):e._e()],1):e._e()]:i("examine-btn-bar",{staticStyle:{padding:"16px 0"},attrs:{"examine-info":e.examineInfo,"examine-more-handle":e.examineMoreHandle,"is-optional-node":e.isOptionalNode,"is-stage-flow":e.isStageFlow,"super-handle-show":e.superRestoreHandleShow},on:{examineHandle:e.examineHandleClick,moreHandler:e.moreHandlerClick}}),e._v(" "),i("examine-handle",{ref:"examineHandleRef",attrs:{id:e.id,show:e.examineHandleShow,"record-id":e.recordId,"examine-type":e.examineType,"flow-id":e.flowId,status:e.examineHandleInfo.status,props:e.examineHandleProps,"get-post-fields":e.getAuthFieldsParams},on:{close:function(t){e.examineHandleShow=!1},emailExamine:e.emailExamineHandleClick,save:e.examineHandleSuccess}}),e._v(" "),e.userViewDialogShow?i("wk-dep-user-dialog",{attrs:{props:e.selectUserProps,radio:"",visible:e.userViewDialogShow},on:{"update:visible":function(t){e.userViewDialogShow=t},change:e.selectUserChange}}):e._e(),e._v(" "),e.solicitOthersShow?i("solicit-others",{on:{submitParams:e.solicitOthersHandler},model:{value:e.solicitOthersShow,callback:function(t){e.solicitOthersShow=t},expression:"solicitOthersShow"}}):e._e(),e._v(" "),e.externalDialogShow?i("el-dialog",{attrs:{visible:e.externalDialogShow,"close-on-click-modal":!1,"append-to-body":!0,title:"外部联系人",width:"30%"},on:{"update:visible":function(t){e.externalDialogShow=t}}},[i("span",[e._v("请输入外部联系人邮箱")]),e._v(" "),i("el-input",{staticStyle:{"margin-top":"10px"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.externalDialogShow=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.verifyEmail}},[e._v("确定")])],1)],1):e._e(),e._v(" "),e.examineOptionalShow?i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],attrs:{visible:e.examineOptionalShow,"close-on-click-modal":!1,"append-to-body":!0,title:e.isOptionalNode.addBtnName,width:"40%"},on:{"update:visible":function(t){e.examineOptionalShow=t}}},[i("flexbox",{staticClass:"user-wrap",attrs:{wrap:"wrap"}},[e._l(e.optionalUserList,(function(t,n){return i("el-tooltip",{key:n,staticClass:"item",attrs:{effect:"dark",offset:10,content:t.realname||t.email||t.outerUserEmail,placement:"top"}},[i("div",{staticClass:"user"},[i("xr-avatar",{attrs:{name:t.realname||t.email||t.outerUserEmail,size:40,src:t.img}}),e._v(" "),i("div",{staticClass:"user__name"},[e._v(e._s(t.realname||t.email||t.outerUserEmail))]),e._v(" "),i("i",{staticClass:"user__delete el-icon-close",on:{click:function(t){e.deleteUserClick(n)}}})],1)])})),e._v(" "),i("div",{staticClass:"user"},[e.isAddUser?[e.isStageFlow?i("el-button",{on:{click:function(t){e.addingMode("selectUser")}}},[e._v("选择员工")]):i("el-dropdown",{attrs:{trigger:"click",placement:"right"},on:{command:e.addingMode}},[i("span",{staticClass:"el-dropdown-link"},[i("el-button",{staticClass:"user__img",staticStyle:{"margin-bottom":"8px"},attrs:{icon:"el-icon-plus",circle:""}}),e._v(" "),i("div",{staticClass:"user__name"},[e._v("选择人员")])],1),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"selectUser"}},[e._v("选择员工")]),e._v(" "),i("el-dropdown-item",{attrs:{command:"external"}},[e._v("选择外部联系人")])],1)],1)]:e._e()],2)],2),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.selectExamineUserClose}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.submitExamineUser}},[e._v("确定")])],1)],1):e._e(),e._v(" "),e.editDetailVisible?i("examine-edit-data-detail",{attrs:{id:e.id,visible:e.editDetailVisible,"examine-info":e.examineInfo,"item-data":e.editDetailItem},on:{"update:visible":function(t){e.editDetailVisible=t}}}):e._e(),e._v(" "),e.configShow?i("xr-create",{attrs:{"card-style":{width:"auto",marginRight:"80px",marginLeft:"80px"},loading:e.loading,title:"配置审批流","show-cancel":!1,"show-confirm":!1},on:{close:function(t){e.configShow=!1}}},[i("wk-approve-flow",{ref:"wkApproveFlow",attrs:{props:e.configFlowProps,list:e.configFlowList,"send-node":e.sendNode}})],1):e._e()],2):e._e()},a=[],s=i("2909"),o=i("c7eb"),l=i("1da1"),r=i("5530"),c=(i("a9e3"),i("14d9"),i("caad"),i("2532"),i("4d90"),i("d3b7"),i("25f0"),i("159b"),i("4de4"),i("b0c0"),i("99af"),i("a15b"),i("d81d"),i("a434"),i("bcbc")),d=i("ffce"),u=i("7bab"),p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{ref:"wkDialog",attrs:{title:e.title,"append-to-body":!0,"close-on-click-modal":!1,visible:e.showDialog,width:"600px"},on:{"update:visible":function(t){e.showDialog=t},close:e.hiddenView}},[e.tips?i("div",{staticClass:"title-tips"},[e._v(e._s(e.tips))]):e._e(),e._v(" "),e.config.setBackNodeShow?i("el-form",{ref:"form",attrs:{"label-position":"top",model:e.form}},[i("el-form-item",{staticClass:"wk-form-item",attrs:{label:e.backNodeLabel}},[i("el-select",{model:{value:e.form.flowId,callback:function(t){e.$set(e.form,"flowId",t)},expression:"form.flowId"}},e._l(e.nodeList,(function(e){return i("el-option",{key:e.flowId,attrs:{label:e.name,value:e.flowId}})})))],1)],1):e._e(),e._v(" "),i("el-input",{attrs:{rows:8,maxlength:200,placeholder:e.placeholder,type:"textarea",resize:"none","show-word-limit":""},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleClick("confirm")}}},[e._v("确定")]),e._v(" "),i("el-button",{attrs:{disabled:e.loading},on:{click:function(t){e.handleClick("cancel")}}},[e._v("取消")])],1)],1)},h=[],f=i("9dba"),m=i("2f62"),v=i("8ed6"),b={setBackNodeShow:!1},g={name:"ExamineHandle",components:{},mixins:[f["a"]],props:{show:{type:Boolean,default:!1},status:{type:[String,Number],default:1},id:[String,Number],recordId:[String,Number],examineType:{type:String,default:""},flowId:{type:[String,Number],default:""},props:Object,getPostFields:Function},data:function(){return{loading:!1,showDialog:!1,nodeList:[],form:{flowId:"",content:""}}},computed:Object(r["a"])(Object(r["a"])({},Object(m["b"])(["userInfo"])),{},{config:function(){return Object(v["a"])(Object(r["a"])({},b),this.props||{})},statusType:function(){return{isSuccess:1==this.status,isReject:2==this.status,isWithdraw:4==this.status,isTermination:13==this.status,isArchive:14==this.status,isInvalid:8==this.status,isSkip:18==this.status,isRecovery:19==this.status}},title:function(){return this.statusType.isSuccess?"审批通过":this.statusType.isReject?"审批拒绝":this.statusType.isWithdraw?"撤回审批":this.statusType.isTermination?"审批终止":this.statusType.isArchive?"归档":this.statusType.isInvalid?"作废":this.statusType.isSkip?"跳过":this.statusType.isRecovery?"恢复":""},tips:function(){return this.statusType.isSkip?"由流程管理员和超级管理员操作。跳过至哪一节点，则此节点之前的节点自动通过，在此节点继续审批流程。":this.statusType.isRecovery?"由流程管理员和超级管理员操作。恢复至哪一节点，从哪一节点开始重新审批，如果恢复至发起人节点，则发起人可以编辑数据重新发起审批。":""},isSuperAuth:function(){return this.statusType.isSkip||this.statusType.isRecovery},placeholder:function(){return this.statusType.isSuccess?"请输入审批意见（选填）":this.statusType.isReject?"请输入审批意见（必填）":this.statusType.isWithdraw?"请输入撤回理由（必填）":this.statusType.isTermination?"请输入终止理由（必填）":this.statusType.isArchive?"请输入归档意见（选填）":this.statusType.isInvalid?"请输入作废意见（选填）":this.statusType.isSkip?"请输入跳过理由（必填）":this.statusType.isRecovery?"请输入恢复理由（必填）":""},backNodeLabel:function(){return this.statusType.isReject?"驳回至哪一节点":this.statusType.isSkip?"跳过至哪一节点":this.statusType.isRecovery?"恢复至哪一节点":""}}),watch:{show:{handler:function(e){this.showDialog=e,e&&this.config.setBackNodeShow&&this.getNodeList()},deep:!0,immediate:!0}},methods:{getNodeList:function(){var e=this,t=null;this.statusType.isSkip?t=d["e"]:(this.statusType.isRecovery||this.statusType.isReject)&&(t=d["g"]),t({recordId:this.recordId}).then((function(t){e.nodeList=t.data,e.nodeList&&e.nodeList.length>0&&e.$nextTick((function(){e.form.flowId=e.nodeList[0].flowId}))})).catch((function(){}))},submitInfo:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var i,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.statusType.isReject||e.statusType.isWithdraw||e.statusType.isTermination||e.statusType.isSkip||e.statusType.isRecovery)||e.form.content){t.next=4;break}e.$message.error(e.placeholder),t.next=25;break;case 4:if(!e.$listeners.confirm){t.next=8;break}e.$emit("confirm",e.form.content),t.next=25;break;case 8:if(e.loading=!0,i=null,n=null,e.statusType.isTermination?(n=d["d"],i={recordId:e.recordId,flowId:e.flowId,status:e.status,remarks:e.form.content,examineUserId:e.userInfo.userId}):(n=e.isSuperAuth?d["a"]:d["b"],i={typeId:e.id,recordId:e.recordId,status:e.status,remarks:e.form.content}),e.config.setBackNodeShow&&(i.flowId=e.form.flowId),!e.getPostFields){t.next=24;break}return t.prev=14,t.next=17,e.getPostFields();case 17:i.flowFieldUpdateLogs=t.sent,t.next=24;break;case 20:return t.prev=20,t.t0=t["catch"](14),e.loading=!1,t.abrupt("return");case 24:n(i).then((function(t){e.loading=!1,e.$message.success("操作成功"),"crm_contract"!=e.examineType&&"crm_invoice"!=e.examineType&&"crm_receivables"!=e.examineType||e.$store.dispatch("GetMessageNum"),e.resetInfo(),e.$emit("save",{type:e.status}),e.hiddenView()})).catch((function(){e.loading=!1}));case 25:case"end":return t.stop()}}),t,null,[[14,20]])})))()},handleClick:function(e){if("cancel"==e)this.hiddenView(),this.resetInfo();else if("confirm"==e)if("batch_audit"===this.examineType){if(this.statusType.isReject&&!this.form.content)return void this.$message.error(this.placeholder);this.$emit("save",{examineType:"batch_audit",content:this.form.content})}else{if(!this.recordId&&"link"==this.$route.name){var t=(this.statusType.isReject||this.statusType.isWithdraw||this.statusType.isTermination)&&!this.form.content;return void this.$emit("emailExamine",this.form.content,t)}this.submitInfo()}},hiddenView:function(){this.$emit("close")},resetInfo:function(){this.form.content="",this.form.flowId=""}}},w=g,_=(i("be40"),i("2877")),y=Object(_["a"])(w,p,h,!1,null,"c7d86d7e",null),x=y.exports,k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"empty",rawName:"v-empty",value:e.list,expression:"list"}],attrs:{"xs-empty-icon":"none","xs-empty-text":"暂无记录"}},[i("flexbox",{staticClass:"flow-head"},[i("div",{staticClass:"flow-head-name"},[e._v("审批流程")]),e._v(" "),i("i",{staticClass:"el-icon-close flow-head-close",on:{click:e.close}})]),e._v(" "),i("div",{staticClass:"flow-body"},e._l(e.list,(function(t,n){return i("flexbox",{key:n,staticClass:"cf-flow-item",attrs:{align:"stretch",justify:"flex-start"}},[i("i",{staticClass:"cf-flow-item-img",class:[11,17].includes(t.examineStatus)?"wk wk-icon-success":e.getStatusIcon(t.examineStatus),style:{color:[11,17].includes(t.examineStatus)?"#00875A":e.getStatusColor(t.examineStatus)}}),e._v(" "),i("div",[i("flexbox",{staticClass:"cf-flow-item-head"},[i("div",[e._v(e._s(t.examineTime))])]),e._v(" "),i("flexbox",{staticClass:"cf-flow-item-info"},[i("div",{staticClass:"cf-flow-item-name"},[e._v(e._s(e.getLogUserName(t)))]),e._v(" "),11!=t.examineStatus&&17!=t.examineStatus&&12!=t.examineStatus?i("div",[i("span",[e._v(e._s(e.getLogContent(t)))])]):11==t.examineStatus?i("div",[i("span",[e._v("已转审")])]):17==t.examineStatus?i("div",[i("span",[e._v("已委托")])]):12==t.examineStatus?i("div",[i("span",[e._v("已征求他人意见")])]):e._e()]),e._v(" "),t.remarks?i("div",{staticClass:"cf-flow-item-content"},[e._v(e._s(t.remarks)+"\n          "),i("div",{staticClass:"cf-flow-item-content-arrow"})]):e._e()],1),e._v(" "),i("div",{staticClass:"cf-flow-item-line"})])})))],1)},C=[],S=i("7403"),L={name:"CheckFlow",components:{},filters:{},mixins:[S["a"]],props:{examineType:{type:String,default:""},id:[String,Number],typeId:[String,Number],show:Boolean},data:function(){return{loading:!1,list:[]}},computed:{},watch:{show:function(e){e&&(this.list=[],this.getDetail())}},mounted:function(){},methods:{getDetail:function(){var e=this,t=this.$route,i=t.name,n=t.query;this.id?(this.loading=!0,Object(d["c"])({recordId:this.id,typeId:this.typeId}).then((function(t){e.loading=!1,e.list=t.data})).catch((function(){e.loading=!1}))):"link"===i&&n.k&&(this.loading=!0,Object(u["e"])({emailToken:n.k}).then((function(t){e.loading=!1,e.list=t.data})).catch((function(){e.loading=!1})))},getLogUserName:function(e){return e.examineUserName},getLogContent:function(e){return 16!=e.examineStatus?this.getStatusName(e.examineStatus)+"此申请":""},close:function(){this.$emit("close")}}},T=L,N=(i("799f"),Object(_["a"])(T,k,C,!1,null,"16e2c34e",null)),O=N.exports,D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wk-head-section wrap",class:{"is-no-border":!e.config.border}},[i("div",{staticClass:"section-head",class:{"is-unfold":e.unfold},style:{"background-color":e.config.headBgColor},on:{click:function(t){e.unfold=!e.unfold}}},["left"===e.config.arrows?i("i",{staticClass:"el-icon-arrow-down"}):e._e(),e._v(" "),i("div",{staticClass:"section-title text-one-line"},[e._v(e._s(e.label))]),e._v(" "),e._t("otherLabel"),e._v(" "),i("div",{staticClass:"section-right"},[e._t("right"),e._v(" "),"right"===e.config.arrows?i("i",{staticClass:"el-icon-arrow-down"}):e._e()],2)],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.unfold,expression:"unfold"}],staticClass:"section-body",style:{padding:e.config.bodyPadding}},[e._t("default")],2)])},F=[],V={headBgColor:"transparent",arrows:"right",border:!0,bodyPadding:"16px"},$={name:"WkHeadSection",components:{},props:{props:Object,label:[String,Number]},data:function(){return{unfold:!0}},computed:{config:function(){return Object(v["a"])(Object(r["a"])({},V),this.props||{})}},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{}},I=$,E=(i("a2d1"),Object(_["a"])(I,D,F,!1,null,"9b6264e8",null)),j=E.exports,A=i("2581"),U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("el-dialog",{attrs:{title:"征求他人意见",visible:e.value,"append-to-body":!0,"close-on-click-modal":!1,"before-close":e.close,width:"40%"},on:{"update:visible":function(t){e.value=t}}},[i("el-form",{ref:"form",staticClass:"examine-node-form",attrs:{model:e.solicitOthersForm,"label-position":"top"}},[i("el-form-item",{attrs:{label:"意见审批人",rules:{required:!0}}},[i("flexbox",{staticClass:"user-wrap",attrs:{wrap:"wrap"}},[e._l(e.solicitOthersForm.userList,(function(t,n){return i("div",{key:n,staticClass:"user"},[i("xr-avatar",{attrs:{name:t.realname||t.email,size:40,src:t.img}}),e._v(" "),i("div",{staticClass:"user__name"},[e._v(e._s(t.realname||t.email))]),e._v(" "),i("i",{staticClass:"user__delete el-icon-close",on:{click:function(t){e.deleteUserClick(n,e.solicitOthersForm.userList)}}})],1)})),e._v(" "),0===e.solicitOthersForm.userList.length||e.solicitOthersForm.userList.length<20?i("div",{staticClass:"user"},[i("span",{staticClass:"el-dropdown-link"},[i("el-button",{staticClass:"user__img",staticStyle:{"margin-bottom":"8px"},attrs:{icon:"el-icon-plus",circle:""},on:{click:function(t){e.addingMode(e.solicitOthersForm,"selectUser")}}}),e._v(" "),i("div",{staticClass:"user__name"},[e._v("选择员工")])],1)]):e._e()],2)],1),e._v(" "),i("el-form-item",{attrs:{label:"审批方式",prop:"examineType",rules:{required:!0,message:"请选择审批方式",trigger:"blur"}}},[i("el-radio",{staticClass:"radio",attrs:{label:"1"},model:{value:e.solicitOthersForm.examineType,callback:function(t){e.$set(e.solicitOthersForm,"examineType",t)},expression:"solicitOthersForm.examineType"}},[e._v("\n          在我之前\n          "),i("span",[e._v("流程先经过意见审批人，再由我审批")])]),e._v(" "),i("el-radio",{staticClass:"radio",attrs:{label:"2"},model:{value:e.solicitOthersForm.examineType,callback:function(t){e.$set(e.solicitOthersForm,"examineType",t)},expression:"solicitOthersForm.examineType"}},[e._v("\n          在我之后\n          "),i("span",[e._v("在我之后审批，即表示我同意该申请并增加审批人员")])])],1),e._v(" "),e.solicitOthersForm.userList.length>1?i("el-form-item",{attrs:{label:"多人审批方式",prop:"moreExamineType",rules:{required:!0,message:"请选择审批方式",trigger:"blur"}}},[i("el-radio",{attrs:{label:"1"},model:{value:e.solicitOthersForm.moreExamineType,callback:function(t){e.$set(e.solicitOthersForm,"moreExamineType",t)},expression:"solicitOthersForm.moreExamineType"}},[e._v("依次审批")]),e._v(" "),i("el-radio",{attrs:{label:"2"},model:{value:e.solicitOthersForm.moreExamineType,callback:function(t){e.$set(e.solicitOthersForm,"moreExamineType",t)},expression:"solicitOthersForm.moreExamineType"}},[e._v("会签")]),e._v(" "),i("el-radio",{attrs:{label:"3"},model:{value:e.solicitOthersForm.moreExamineType,callback:function(t){e.$set(e.solicitOthersForm,"moreExamineType",t)},expression:"solicitOthersForm.moreExamineType"}},[e._v("或签")])],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"审证求意见说明"}},[i("wk-textarea",{attrs:{rows:3,autosize:{minRows:3},maxlength:200,placeholder:"请输入加签意见",resize:"none",type:"textarea"},model:{value:e.solicitOthersForm.remark,callback:function(t){e.$set(e.solicitOthersForm,"remark",t)},expression:"solicitOthersForm.remark"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.close}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handlerClick}},[e._v("确定")])],1)],1),e._v(" "),e.depUserViewDialogShow?i("wk-dep-user-dialog",{attrs:{props:{showUser:!0,showDept:!1,showDisableUser:!1,disableUserLabel:"员工"},radio:"",visible:e.depUserViewDialogShow},on:{"update:visible":function(t){e.depUserViewDialogShow=t},change:e.selectUserChange}}):e._e(),e._v(" "),e.externalDialogShow?i("el-dialog",{attrs:{visible:e.externalDialogShow,"close-on-click-modal":!1,"append-to-body":!0,title:"外部联系人",width:"30%"},on:{"update:visible":function(t){e.externalDialogShow=t}}},[i("span",[e._v("请输入外部联系人邮箱")]),e._v(" "),i("el-input",{staticStyle:{"margin-top":"10px"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.externalDialogShow=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.verifyEmail}},[e._v("确定")])],1)],1):e._e()],1)},P=[],B=i("5824"),W=i("ed08"),H={name:"SolicitOthers",components:{WkDepUserDialog:A["a"],WkTextarea:B["a"]},props:{value:{type:Boolean,default:!1}},data:function(){return{solicitOthersForm:{userList:[],examineType:"1"},depUserViewDialogShow:!1,externalDialogShow:!1,email:""}},watch:{value:function(e){e&&(this.solicitOthersForm.userList=[])}},methods:{handlerClick:function(){var e=this;this.$refs.form.validate((function(t){if(t&&e.solicitOthersForm.userList.length){var i=[];e.solicitOthersForm.userList.forEach((function(e){i.push({userId:e.userId,email:e.email})}));var n={insertFlag:e.solicitOthersForm.examineType,remark:e.solicitOthersForm.remark||"",userList:i};e.solicitOthersForm.moreExamineType&&(n.type=e.solicitOthersForm.moreExamineType),e.$emit("submitParams",n),e.close()}else e.$message.error("请完善基本信息")}))},deleteUserClick:function(e,t){t.splice(e,1)},selectUserChange:function(e,t,i){if(i.length){var n=this.solicitOthersForm.userList.map((function(e){return e.userId}));n.includes(i[0].userId)||this.solicitOthersForm.userList.push(i[0])}},addingMode:function(e,t){"selectUser"==t?this.depUserViewDialogShow=!0:"external"==t&&(this.externalDialogShow=!0,this.email=null)},verifyEmail:function(){if(Object(W["A"])(this.email)){var e=this.solicitOthersForm.userList.map((function(e){return e.email}));e.includes(this.email)?this.$message.error("请勿重复添加"):(this.solicitOthersForm.userList.push({email:this.email}),this.externalDialogShow=!1)}else this.$message.error("邮箱格式有误")},close:function(){this.$emit("input",!1)}}},R=H,z=(i("933c"),Object(_["a"])(R,U,P,!1,null,"dec8564a",null)),M=z.exports,q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"examine-btn-bar",style:!e.examineMoreHandle.length||e.isStageFlow?"justify-content: start;":""},[1==e.examineInfo.isCheck?i("el-button",{attrs:{type:"success",icon:"wk wk-success"},on:{click:function(t){e.examineHandle(1)}}},[e._v("通过")]):e._e(),e._v(" "),1==e.examineInfo.isCheck?i("el-button",{style:!e.examineMoreHandle.length||e.isStageFlow?"margin-left: 10px;":"",attrs:{type:"danger",icon:"wk wk-close"},on:{click:function(t){e.examineHandle(2)}}},[e._v("拒绝")]):e._e(),e._v(" "),e.isOptionalNode?i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.examineHandle("selectExamineUser")}}},[e._v(e._s(e.isOptionalNode.addBtnName))]):e._e(),e._v(" "),!e.isOptionalNode&&e.superHandleShow?i("el-button",{staticStyle:{"margin-left":"auto"},attrs:{type:"primary"},on:{click:function(t){e.examineHandle(19)}}},[e._v("恢复")]):e._e(),e._v(" "),e.examineMoreHandle.length&&!e.isOptionalNode?i("el-dropdown",{staticClass:"more-handle",style:e.isStageFlow?"margin-left: 10px;":"",on:{command:e.moreHandler}},[i("el-button",[e._v("更多操作")]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.examineMoreHandle,(function(t,n){return i("el-dropdown-item",{key:n,attrs:{command:t.value},on:{click:function(e){e.stopPropagation()}}},["forwardOthers"==t.value?[e.isStageFlow?i("span",{on:{click:function(t){t.stopPropagation(),e.moreHandler("selectUser")}}},[e._v("转他人处理")]):i("el-dropdown",{staticClass:"more-handle",on:{command:e.moreHandler}},[i("div",[e._v("转他人处理")]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"selectUser"}},[e._v("选择员工")]),e._v(" "),i("el-dropdown-item",{attrs:{command:"external"}},[e._v("选择外部联系人")])],1)],1)]:[e._v("\n          "+e._s(t.label)+"\n        ")]],2)})))],1):e._e()],1)},G=[],X={name:"ExamineBtnBar",props:{examineInfo:Object,examineMoreHandle:Array,isOptionalNode:Object,isStageFlow:Boolean,superHandleShow:Boolean},methods:{examineHandle:function(e){this.$emit("examineHandle",e)},moreHandler:function(e){this.$emit("moreHandler",e)}}},J=X,K=(i("eef2"),Object(_["a"])(J,q,G,!1,null,"54c90081",null)),Z=K.exports,Q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{ref:"wkDialog",attrs:{title:"查看节点编辑信息",visible:e.visible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{close:e.close}},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.list,expression:"list"}],staticClass:"rc-cont"},e._l(e.list,(function(t,n){return i("flexbox",{key:n,staticClass:"ha-cont",attrs:{align:"stretch",justify:"flex-start"}},[i("div",{staticClass:"ha-week"},[e._v(e._s(e._f("filterTimestampToFormatTime")(t.createTime,"MM-DD dddd")))]),e._v(" "),i("div",{staticClass:"ha-circle"}),e._v(" "),i("div",{staticClass:"ha-time"},[e._v(e._s(e._f("filterTimestampToFormatTime")(t.createTime,"HH:mm")))]),e._v(" "),i("xr-avatar",{staticClass:"ha-img",attrs:{id:t.createUserId,name:t.realname,size:32,src:t.img,disabled:!1}}),e._v(" "),i("div",{staticClass:"ha-name"},[e._v(e._s(t.realname))]),e._v(" "),i("div",{staticClass:"ha-content"},e._l(t.content,(function(t,n){return i("p",{key:n},[e._v(e._s(t))])}))),e._v(" "),i("div",{staticClass:"ha-line"})],1)})))])},Y=[],ee={name:"ExamineEditDataDetail",mixins:[f["a"]],props:{visible:{type:Boolean,required:!0,default:!1},id:[String,Number],examineInfo:{type:Object,default:function(){return{}}},itemData:Object},data:function(){return{loading:!1,list:[]}},computed:{},mounted:function(){this.getDetail()},methods:{getDetail:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading=t,Object(d["h"])({typeId:this.id,label:this.examineInfo.label,examineId:this.examineInfo.examineAdvancedConfigVO.examineId,flowId:this.itemData.flowId}).then((function(t){e.loading=!1,e.list=t.data.map((function(e){return e.createTime=new Date(e.createTime).getTime(),e}))})).catch((function(){e.loading=!1}))},close:function(){this.$emit("update:visible",!1)}}},te=ee,ie=(i("7296"),Object(_["a"])(te,Q,Y,!1,null,"e4088982",null)),ne=ie.exports,ae=i("43b6"),se=i("8156"),oe=i("eecc"),le=i("6bfe"),re=i("c1df"),ce=i.n(re),de=i("da92"),ue=i("53ca"),pe=(i("7db0"),i("e9c4"),i("eea9")),he=i("2046"),fe={methods:{flowGetAuthPostFields:function(e,t,i,n){return new Promise((function(a,s){i&&i.getCustomFieldPostParams().then((function(i){var s=i.entity,o=i.field,l=n.batchId,r=[];t.forEach((function(t,i){if(3===t.authLevel){var n=null;if(1==t.fieldType)n=s?s[t.fieldName]:null;else{var a=o.find((function(e){return e.fieldName===t.fieldName}));n=a?a.value:null}var c=null;if(["detail_table"].includes(t.formType))if(Array.isArray(t.value)){var d=Object(W["z"])(t.value);d.forEach((function(e){e.forEach((function(e){e.value=he["a"].methods.getRealParams(e,e.value)}))})),c=d}else c=t.value;else c=he["a"].methods.getRealParams(t,t.value);r.push({batchId:l,label:e,fieldName:t.fieldName,fieldId:t.fieldId,type:t.type,fieldType:t.fieldType,name:t.name,newValue:n&&"object"===Object(ue["a"])(n)?JSON.stringify(n):n,oldValue:c&&"object"===Object(ue["a"])(c)?JSON.stringify(c):c})}})),a(r)})).catch((function(e){s(e)}))}))},flowGetFlowStepList:function(e){return new Promise((function(t,i){Object(c["i"])({recordId:e}).then((function(e){t(e)})).catch((function(e){i(e)}))}))},flowGetAuthFields:function(e){return new Promise((function(t,i){Object(d["f"])(e).then((function(e){t(e)})).catch((function(e){i(e)}))}))},flowGetCurrentFlowId:function(e){var t="";return e.forEach((function(e){3==e.examineStatus&&(t=e.flowId)})),t},flowGetCRMDetailRequestFun:function(e){return{}[e]},flowGetOADetailRequestFun:function(){return pe["a"]}}},me=i("3817"),ve={name:"ExamineInfoSection",components:{ExamineHandle:x,CheckFlow:O,WkHeadSection:j,WkDepUserDialog:A["a"],SolicitOthers:M,ExamineBtnBar:Z,ExamineEditDataDetail:ne,WkApproveFlow:ae["a"],XrCreate:se["a"]},filters:{},mixins:[S["a"],fe,me["a"]],provide:function(){return{examineInfoSection:this}},props:{examineType:{type:String,default:""},id:[String,Number],recordId:[String,Number],examineRecord:{type:Object,default:function(){}},externalMailbox:{type:Boolean,default:!1},isStageFlow:{type:Boolean,default:!1},placement:{type:String,default:"bottom"},ignoreAction:{type:Array,default:function(){return[]}}},data:function(){return{dialogLoading:!1,loading:!1,examineInfo:{},showFlowPopover:!1,examineHandleInfo:{status:1},examineHandleProps:{setBackNodeShow:!1},examineHandleShow:!1,userViewDialogShow:!1,solicitOthersShow:!1,externalDialogShow:!1,email:"",flowId:"",examineAdvancedConfigVO:{},selectUserProps:{showUser:!0,showDept:!1,showDisableUser:!1,disableUserLabel:"员工"},examineOptionalShow:!1,optionalUserList:[],addUserType:"default",createType:"",authFields:[],crmCreateShow:!1,editDetailItem:null,editDetailVisible:!1,configShow:!1,configFlowList:[],configFlowProps:{conditionAddShow:!1,examineAddShow:!1,copyAddShow:!1},sendNode:{name:"发起人",content:"具有新建权限的员工"}}},computed:Object(r["a"])(Object(r["a"])({},Object(m["b"])(["userInfo"])),{},{sendLevelOption:function(){for(var e=[],t=1;t<=20;t++){var i="第".concat(t,"级上级");1===t?e.push({label:"直属上级",value:t}):e.push({label:i,value:t})}return e},examineFlowList:function(){return this.examineInfo.examineFlowList?this.examineInfo.examineFlowList:[]},superRestoreHandleShow:function(){var e;return 1==(null===(e=this.examineInfo)||void 0===e?void 0:e.isRestore)&&!this.isStageFlow&&!this.ignoreAction.includes("recovery")},superSkipHandleShow:function(){var e;return 1==(null===(e=this.examineInfo)||void 0===e?void 0:e.isSkip)},isFieldAuthExamine:function(){return!1},isOAExamine:function(){if(this.examineInfo){var e=this.examineInfo.label;return 0===e}return!1},examineMoreHandle:function(){var e,t=this;if(this.isOptionalNode)return[];var i=1==this.examineInfo.isCheck,n=1==this.examineInfo.isRecheck,a=1==this.examineInfo.isSuperAdmin,s=this.examineInfo.createUser,o=null===(e=this.examineAdvancedConfigVO)||void 0===e?void 0:e.privilege,l=isNaN(o)?"000":o.toString(2).padStart(3,"0"),r="1"==l[0],c="1"==l[1],d="1"==l[2],u=[];if(this.externalMailbox)u=i&&r?[{label:"终止",value:"termination"}]:[];else{var p,h;if(i){var f,m,v=null===(f=this.examineAdvancedConfigVO)||void 0===f?void 0:f.isTransferable,b=null===(m=this.examineAdvancedConfigVO)||void 0===m?void 0:m.isConsult;v&&u.push({label:"转他人处理",value:"forwardOthers"}),b&&u.push({label:"征求他人意见",value:"solicitOthers"}),r&&u.push({label:"终止",value:"termination"})}var g=this.examineInfo,w=g.examineFlowList,_=void 0===w?[]:w,y=g.examineStatus,x=(null===(p=this.userInfo)||void 0===p?void 0:p.userId)===s.userId||a||1==(null===(h=this.userInfo)||void 0===h?void 0:h.isAdmin),k=x&&_.some((function(e){return 3===e.examineStatus}));k&&u.push({label:"邮件催办",value:"emailReminder"}),(i||x)&&14!==y&&8!==y&&13!==y&&(d&&u.push({label:"归档",value:"archive"}),c&&u.push({label:"作废",value:"cancellation"})),n&&u.push({label:"撤回",value:"retract"})}if(this.superSkipHandleShow&&u.push({label:"跳过",value:"skip"}),"hrm_salary"==this.examineType){var C=[],S=["archive","cancellation"];u.forEach((function(e,t){S.includes(e.value)||C.push(e)})),u=C}if(this.isStageFlow){var L=[],T=["termination","emailReminder","archive","cancellation"];u.forEach((function(e){T.includes(e.value)||L.push(e)})),u=L}return u.filter((function(e){return!t.ignoreAction.includes(e.value)}))},examineCategory:function(){return function(e){return oe["b"][e]}},examineNodeName:function(){var e=this;return function(t){var i=t.name?12==t.examineStatus?t.name:t.name+"：":"",n="";return n=7!=t.examineType||[18,19,14,15].includes(Number(t.examineStatus))?105==t.passFlag?"管理员干涉跳过":e.getShowStatusName(t.examineStatus,t.isAdminSkip):"抄送","".concat(i).concat(n)}},passFlagNumText:function(){return function(e,t){var i,n,a,s=this,o={1:"审批人不存在，",2:"审批人不存在，",102:"未找到审批人，",202:"未找到审批人，",104:"审批人不存在，",204:"审批人不存在，"},l={1:"自动同意",2:"自动转交给 ".concat(null===(i=this.examineAdvancedConfigVO.nodeHandleUser)||void 0===i?void 0:i.map((function(e){return s.$getUserName(e)})).join()),102:"自动同意",202:"自动转交给 ".concat(null===(n=this.examineAdvancedConfigVO.nodeHandleUser)||void 0===n?void 0:n.map((function(e){return s.$getUserName(e)})).join()),104:"自动同意",204:"自动转交给 ".concat(null===(a=this.examineAdvancedConfigVO.nodeHandleUser)||void 0===a?void 0:a.map((function(e){return s.$getUserName(e)})).join())};return 0!=t?o[e]+"已"+l[e]:o[e]+"将"+l[e]}},showOneUserExamine:function(){return function(e){var t=e.passFlag,i=e.userList,n=e.examineType,a=i[0];if(7==n)return"";if((!t||[101,201,103,203,205].includes(t))&&!a.hasOwnProperty("isAdvance"))return"";var s=a.isAdvance||null;return[104,204].includes(t)?this.passFlagNumText(t,a.examineStatus):102==t||s&&1==s?this.passFlagNumText(102,a.examineStatus):202==t||s&&2==s?this.passFlagNumText(202,3,i):[402].includes(t)?"审批人不存在":void 0}},showMultiplayerExamine:function(){return function(e,t){var i=t.map((function(e){return e.isAdvance})).includes(2);if([101,201,103,203,205,401].includes(e)||!e&&!i)return"";var n=t.map((function(e){return e.passFlag})).includes(104)||t.map((function(e){return e.passFlag})).includes(204),a=t.map((function(e){return e.hasOwnProperty("duration")})).includes(!0);return i?this.passFlagNumText(202,1,t):a||n?"":this.passFlagNumText(e,1,t)}},disableUserShow:function(){return function(e,t,i){return 104!=e&&204!=e?"":204==e&&11==i.examineStatus||104==e&&1==t?this.passFlagNumText(e,t):void 0}},limitDisableShow:function(){return function(){var e=this.examineAdvancedConfigVO.nodeHandleType;return this.passFlagNumText(e,3,0)}},timeLimitStyleShow:function(){var e=this.examineAdvancedConfigVO.advancedLimitTimeVO||{};if(Object(le["c"])(e))return!1;var t=e.handleType;return 1!=t},isOptionalNode:function(){var e=this.examineInfo,t=e.examineFlowList,i=e.createUser;if(!this.userInfo||i.userId!==this.userInfo.userId)return null;var n=t[t.length-1],a=n.examineType,s=n.isAdd,o=n.userList;return 7==a&&1==s&&!o.length||4==a&&!o.length?{examineType:a,addBtnName:{7:"选择抄送人",4:"选择审批人"}[a]}:null},isAddUser:function(){var e=this.examineInfo.examineFlowList,t=e[e.length-1],i=t.chooseType;return!(1==i&&1==this.optionalUserList.length||1!=i&&20==this.optionalUserList.length)},canCheckEditFieldData:function(){var e=this;return function(t){var i=e.isFieldAuthExamine&&7!=t.examineType&&!!t.examineType&&6!=t.examineStatus;return i&&(1===t.userList.length?i=!e.showOneUserExamine(t):t.userList.length>1&&(i=!e.showMultiplayerExamine(t.passFlag,t.userList))),i&&(1===t.userList.length?i=1==t.examineStatus:t.userList.length>1&&(i=t.userList.some((function(e){return 1==e.examineStatus})))),i}}}),watch:{loading:function(e){this.$emit("on-loading",e)},recordId:{handler:function(e){e&&this.refreshData()},deep:!0,immediate:!0},examineFlowList:{handler:function(e){this.flowId=this.flowGetCurrentFlowId(e)},immediate:!0,deep:!0},examineRecord:{handler:function(e){Object(le["c"])(e)||this.updateExamineInfo(this.examineRecord)},deep:!0,immediate:!0}},methods:{refreshData:function(){this.examineInfo={},this.getFlowStepOAList(),this.$refs.checkFlow&&this.$refs.checkFlow.getDetail()},getShowStatusName:function(e,t){return 18===e?t?"跳过":"节点被跳过":this.getStatusName(e)},emailExamineHandleClick:function(e,t){var i=this;t?this.$message.error("请输入审批意见（必填）"):Object(u["c"])({emailToken:this.$route.query.k,status:this.examineHandleInfo.status,remarks:e}).then((function(e){i.$message.success("操作成功"),i.$refs.examineHandleRef.resetInfo(),i.examineHandleShow=!1,i.$emit("success")})).catch((function(e){}))},getFlowStepOAList:function(){var e=this;this.loading=!0,this.flowGetFlowStepList(this.recordId).then((function(t){e.loading=!1;var i=t.data||{};e.updateExamineInfo(i)})).catch((function(){e.loading=!1}))},updateExamineInfo:function(e){this.examineAdvancedConfigVO=e.examineAdvancedConfigVO,this.examineInfo=e,this.getUserFieldList(this.examineInfo.label,this.examineAdvancedConfigVO.examineId)},examineClick:function(){return Object(l["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},moreHandlerClick:function(e){this.addUserType="default","selectUser"==e?(this.selectUserProps={showUser:!0,showDept:!1,showDisableUser:!1,disableUserLabel:"员工"},this.userViewDialogShow=!0):"external"==e?this.externalDialogShow=!0:"solicitOthers"==e?this.solicitOthersShow=!0:"termination"==e?this.examineHandleClick(13):"emailReminder"==e?this.emailReminder():"archive"==e?this.examineHandleClick(14):"cancellation"==e?this.examineHandleClick(8):"retract"==e?this.examineHandleClick(4):"skip"==e&&this.examineHandleClick(18)},examineHandleClick:function(e){if("selectExamineUser"!=e){var t=this.examineAdvancedConfigVO.isRejectChooseFlow;this.examineHandleProps.setBackNodeShow=(t&&2==e||this.superRestoreHandleShow&&19==e||this.superSkipHandleShow&&18==e)&&!this.externalMailbox,this.examineHandleInfo.status=e,this.examineHandleShow=!0}else this.examineOptionalShow=!0},getAuthFieldsParams:function(){return this.isFieldAuthExamine,null},archivedObsolete:function(e,t){var i=this,n={archiveOrVoidFlag:e,recordId:this.recordId};Object(c["a"])(n).then((function(e){i.$message.success("操作成功"),i.getFlowStepOAList(),i.$emit("on-handle",t)}))},emailReminder:function(){var e=this;Object(c["k"])({examineRecordId:this.recordId}).then((function(t){e.$message.success("操作成功"),e.getFlowStepOAList()}))},examineHandleSuccess:function(e){this.closeFieldView(),this.getFlowStepOAList(),this.$refs.checkFlow&&this.$refs.checkFlow.getDetail(),this.$emit("on-handle",e)},getDetailName:function(e){return e.userList&&0!==e.userList.length?1===e.userList.length?this.$getUserName(e.userList[0])?this.$getUserName(e.userList[0]):e.userList[0].outerUserEmail:5===e.examineType?"".concat(e.userList.length,"人").concat(oe["b"][1]):"".concat(e.userList.length,"人").concat(oe["b"][e.type]):"XX"},selectUserChange:function(e,t,i){var n=this;if("optional"!=this.addUserType){var a={examineFlowFinalUser:{userId:e[0]},flowFinalId:this.flowId,recordId:this.recordId};Object(c["d"])(a).then((function(e){n.closeFieldView(),n.getFlowStepOAList()}))}else{var o;this.optionalUserList.map((function(e){return e.userId})).includes(i[0].userId)||(o=this.optionalUserList).push.apply(o,Object(s["a"])(i))}},verifyEmail:function(){var e=this;if(Object(W["A"])(this.email)){if("optional"==this.addUserType)return this.optionalUserList.map((function(e){return e.email})).includes(this.email)||this.optionalUserList.push({email:this.email}),this.email=null,void(this.externalDialogShow=!1);var t={examineFlowFinalUser:{email:this.email},flowFinalId:this.flowId,recordId:this.recordId};Object(c["d"])(t).then((function(t){e.getFlowStepOAList()})),this.email=null,this.externalDialogShow=!1}else this.$message.error("邮箱格式有误")},solicitOthersHandler:function(e){var t=this,i=Object(r["a"])(Object(r["a"])({},e),{},{insertTarget:this.flowId,recordId:this.recordId});Object(c["h"])(i).then((function(){t.closeFieldView(),t.getFlowStepOAList()}))},autoExamineText:function(e,t,i,n){var a,s=Number(e||0),o=null===(a=this.examineAdvancedConfigVO)||void 0===a?void 0:a.advancedLimitTimeVO;if(!o||0==n.userStatus||!s)return{};var l=o.handleType,r=o.handleUserList,c=o.limitTime,d=o.limitTimeUnit,u={minute:Number(de["a"].minus(de["a"].times(c,60,1e3),s)),hour:Number(de["a"].minus(de["a"].times(c,60,60,1e3),s)),day:Number(de["a"].minus(de["a"].times(c,24,60,60,1e3),s))},p={minute:"分钟",hour:"小时",day:"天"};if(103==i)return{text:"【限时审批】流程在审批人处停留超过".concat(c).concat(p[d],"，系统已自动同意"),class:"background-color: #EBECF0;color:#999"};if(203==i)return{text:"【限时审批】流程在审批人处停留超过".concat(c).concat(p[d],"，系统已【自动转交】给").concat(this.getHandleUserList(r)),class:"background-color: #EBECF0;color:#999"};if(u[d]>0){var h=ce.a.duration(u[d]).days()?ce.a.duration(u[d]).days()+"天":"",f=ce.a.duration(u[d]).hours()?ce.a.duration(u[d]).hours()+"小时":"",m=ce.a.duration(u[d]).minutes()?ce.a.duration(u[d]).minutes()+"分钟":"";if(3==l)return{text:h||f||m?h+f+m+"后自动同意":"1分钟后自动同意",class:"color: red"};if(2==l)return{text:h||f||m?h+f+m+"后自动转交给"+this.getHandleUserList(r):"1分钟后自动转交给"+this.getHandleUserList(r),class:"color: red"}}else{if(2==l)return{text:"【限时审批】流程在审批人处停留超过".concat(c).concat(p[d],"，系统").concat(1==t?"已":"将","【自动转交】给").concat(this.getHandleUserList(r)),class:"background-color: #EBECF0;color:#999"};if(3==l)return{text:"【限时审批】流程在审批人处停留超过".concat(c).concat(p[d],"，系统").concat(1==t?"已":"将","自动同意"),class:"background-color: #EBECF0;color:#999"}}},getHandleUserList:function(e){var t=this;return e.map((function(e){var i=e.type,n=e.dataList;return 1==i?n.map((function(e){var i;return null===(i=t.sendLevelOption[e.parentLevel-1])||void 0===i?void 0:i.label})).join():n.map((function(e){return t.$getUserName(e)})).join()})).join()},singleNodeDisableUserShow:function(e){var t=e.userList;if(1!==(null===t||void 0===t?void 0:t.length))return!1;var i=t[0];return!(!this.$getUserName(i)&&!i.outerUserEmail||i.hasOwnProperty("userStatus")&&0==i.userStatus&&7!=e.examineType&&[104,204].includes(i.passFlag))||void 0},disableAvatarUserShow:function(e){var t=e.passFlag,i=e.examineStatus;return(104!=t||1!=i)&&(204!=t||11!=i)},submitExamineUser:function(){var e=this;if(0!=this.optionalUserList.length){this.dialogLoading=!0;var t=this.examineInfo.examineFlowList,i=t[t.length-1],n=i.flowId,a=i.examineType,s={flowId:n,examineType:a,recordId:this.recordId,userList:this.optionalUserList};Object(c["c"])(s).then((function(){e.dialogLoading=!1,e.selectExamineUserClose(),e.getFlowStepOAList()})).catch((function(){e.dialogLoading=!1}))}},selectExamineUserClose:function(){this.optionalUserList=[],this.examineOptionalShow=!1},deleteUserClick:function(e){this.optionalUserList.splice(e,1)},addingMode:function(e){this.addUserType="optional","selectUser"==e?this.selectUserClick():"external"==e&&(this.externalDialogShow=!0,this.email=null)},selectUserClick:function(){var e=this.examineInfo.examineFlowList,t=e[e.length-1],i=t.chooseUserList,n=t.rangeType,a=t.examineType,s=null;4==a&&(2!=n&&3!=n||(s=i)),this.selectUserProps={showUser:!s,showDept:!1,showDisableUser:!!s,disableUserList:s,disableUserLabel:"员工"},this.userViewDialogShow=!0},checkEditFieldDataClick:function(e){this.editDetailItem=e,this.editDetailVisible=!0},closeFieldView:function(){},checkExamineConfig:function(){var e=this;this.configShow=!0;var t=this.examineFlowList.map((function(e){return e.flowId})),i=this.examineFlowList.length>0?this.examineFlowList[this.examineFlowList.length-1].flowId:null,n=null;this.loading=!0,Object(d["l"])({examineId:this.examineAdvancedConfigVO.examineId}).then((function(a){var s=a.data||[],o=[];e.getListInfo(s,o,{additionalInfoFun:function(e,a,s,o,l){e.disabled=!0,e.conditionName?(e.modal=!(i&&!n)||!a.examineDataList.some((function(e){return t.includes(e.flowId)})),a.flowId==i&&(n=a.flowId)):e.modal=!t.includes(a.flowId)},cycleFun:function(e,t){if("conditionList"===e&&t.conditionWrap.conditionList.length-1===t.index&&t.conditionWrapInfo.conditionList.every((function(e){return e.modal})))if((null===t||void 0===t?void 0:t.conditionIndex)>0){if(t.newList.length>0){var i=t.newList[t.newList.length-1];if(!i.modal&&!n)for(var a=0;a<t.conditionWrapInfo.conditionList.length;a++){var s=t.conditionWrapInfo.conditionList[a];if(!s.examineDataList.length){s.modal=!1;break}}}}else if(!n){var o;(null===(o=t.conditionWrapInfo)||void 0===o?void 0:o.conditionList.length)>0&&(t.conditionWrapInfo.conditionList[0].modal=!1)}}}),e.configFlowList=o,e.loading=!1})).catch((function(){e.loading=!1}))}}},be=ve,ge=(i("2682"),Object(_["a"])(be,n,a,!1,null,"b1cdf1c2",null));t["a"]=ge.exports},d302:function(e,t,i){},d3c6:function(e,t,i){"use strict";i("f3ed")},d76d:function(e,t,i){"use strict";i("bb2e")},db54:function(e,t,i){"use strict";i("545c")},e0f0:function(e,t,i){},e1e1:function(e,t,i){"use strict";i("67ba")},e2d9:function(e,t,i){e.exports={colorPrimary:"#0052cc",colorBlack:"#172b4d",colorSuccess:"#36b37e",colorWarning:"#ffab00",colorDanger:"#ff5630",colorN40:"#dfe1e6",axisLineColor:"#dfe1e6",axisLabelFontWeight:"500"}},eecc:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n={1:"指定成员",2:"上级",3:"角色",4:"发起人自选",5:"连续多级上级"},a={1:"依次审批",2:"会签",3:"或签"}},eef2:function(e,t,i){"use strict";i("c681")},eff5:function(e,t,i){"use strict";i("bd2f")},f36d:function(e,t,i){},f3ed:function(e,t,i){},f468:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{staticClass:"xr-header"},[e.iconClass?i("div",{staticClass:"xr-header__icon",style:{backgroundColor:e.iconColor}},[i("i",{class:e.iconClass})]):e._e(),e._v(" "),i("div",{staticClass:"xr-header__label"},[e.$slots.label?e._t("label"):[e._v(e._s(e.label)),e._t("otherLabel")]],2),e._v(" "),e.showSearch?i("el-input",e._b({staticClass:"xr-header__search",style:{"margin-top":e.ftTop},attrs:{placeholder:e.placeholder},on:{input:e.inputChange},nativeOn:{keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchClick(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},"el-input",e.inputAttr,!1),[i("el-button",{attrs:{slot:"suffix",type:"icon",icon:"wk wk-sousuo"},on:{click:e.searchClick},slot:"suffix"})],1):e._e(),e._v(" "),i("div",{staticClass:"xr-header__ft",style:{top:e.ftTop}},[e._t("ft")],2)],1)},a=[],s=(i("a9e3"),i("ac1f"),i("841c"),{name:"XrHeader",components:{},props:{iconClass:[String,Array],iconColor:String,label:String,showSearch:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入内容"},ftTop:{type:String,default:"0"},content:[String,Number],inputAttr:{type:Object,default:function(){}}},data:function(){return{search:""}},computed:{},watch:{content:{handler:function(){this.search!=this.content&&(this.search=this.content)},immediate:!0}},mounted:function(){},beforeDestroy:function(){},methods:{inputChange:function(){this.$emit("update:content",this.search)},searchClick:function(){this.$emit("search",this.search)}}}),o=s,l=(i("f9b7"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"20e1a242",null);t["a"]=r.exports},f4c9:function(e,t,i){"use strict";i("fb7a")},f9b7:function(e,t,i){"use strict";i("5a5d")},fa73:function(e,t,i){"use strict";i("961b")},fb7a:function(e,t,i){},fd75:function(e,t,i){},fdca:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{staticClass:"wk-page-header",attrs:{justify:"space-between"}},[i("div",{staticClass:"wk-page-header__left"},[e.title||e.$slots.title?i("span",{staticClass:"wk-page-header-title"},[e._t("title",[e._v(e._s(e.title))])],2):e._e(),e._v(" "),e.help?i("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":e.help.type,"data-id":e.help.id}}):e._e(),e._v(" "),e._t("left")],2),e._v(" "),i("div",{staticClass:"wk-page-header__center"},[e._t("center")],2),e._v(" "),i("div",{staticClass:"wk-page-header__right"},[e._t("right"),e._v(" "),e.dropdowns&&e.dropdowns.length>0?i("el-dropdown",{class:{"margin-left-interval":e.$slots.right},attrs:{trigger:"click"},on:{command:e.dropdownCommand}},[i("el-button",{staticClass:"dropdown-btn",attrs:{icon:"el-icon-more"}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.dropdowns,(function(t,n){return i("el-dropdown-item",{key:n,attrs:{icon:t.icon,command:t.command}},[e._v(e._s(t.name))])})))],1):e._e()],2)])},a=[],s={name:"WkPageHeader",components:{},props:{title:String,dropdowns:Array,help:Object},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{dropdownCommand:function(e){this.$emit("command",e)}}},o=s,l=(i("2309"),i("2877")),r=Object(l["a"])(o,n,a,!1,null,"985b7582",null);t["a"]=r.exports},ff1b:function(e,t,i){"use strict";i("940c")}}]);