(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dba6e328"],{"0178":function(e,t,i){"use strict";i("4118")},"01b45":function(e,t,i){},"02c3":function(e,t,i){"use strict";i("0356")},"0356":function(e,t,i){},"0481":function(e,t,i){"use strict";var n=i("23e7"),a=i("a2bf"),r=i("7b0b"),s=i("07fa"),o=i("5926"),l=i("65f0");n({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=r(this),i=s(t),n=l(t,0);return n.length=a(n,t,t,i,0,void 0===e?1:o(e)),n}})},"04e6":function(e,t,i){},"1a38":function(e,t,i){},"1b1a":function(e,t,i){"use strict";i("bd99")},2050:function(e,t,i){},"314c":function(e,t,i){"use strict";i("dbb1")},3176:function(e,t,i){"use strict";i("04e6")},"372d":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"achivement-set"},[i("xr-header",{ref:"xrHeader",attrs:{"show-search":![2,3].includes(e.menuIndex),"search-icon-type":"icon",placeholder:"请输入考勤组名称/班次名称",label:"考勤规则设置"},on:{search:e.searchClick}}),e._v(" "),i("div",{staticClass:"achivement-content"},[i("div",{staticClass:"system-view-nav"},[i("div",{staticClass:"nav-sections-wrap"},e._l(e.menuList,(function(t,n){return i("div",{key:n,staticClass:"menu-item",class:{"is-select":t.tableId==e.menuIndex},on:{click:function(i){e.menuClick(t.tableId)}}},[e._v("\n          "+e._s(t.tableName)+"\n        ")])})))]),e._v(" "),i("keep-alive",[i(e.menuList[e.menuIndex].componentName,{ref:"componentRef",tag:"component",staticClass:"system-view-content"})],1)],1)],1)},a=[],r=(i("ac1f"),i("841c"),i("f468")),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{staticClass:"content-title"},[i("span",[e._v("考勤组设置")]),e._v(" "),i("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:e.addHandleClick}},[e._v("新建考勤组")])],1),e._v(" "),i("div",{staticClass:"content-body"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,height:e.tableHeight}},[e._l(e.fieldList,(function(t,n){return i("el-table-column",{key:n,attrs:{prop:t.prop,label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,a=t.column;return["attendanceDate"==a.property?[i("attendanceDate",{attrs:{"attendance-value":n.attendanceDate}})]:[e._v("\n            "+e._s(e.formatter(n,a))+"\n          ")]]}}])})})),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-button",{attrs:{type:"primary-text"},on:{click:function(t){e.updateHandler(n)}}},[e._v("修改")]),e._v(" "),e.delShow(n)?i("el-button",{attrs:{type:"primary-text"},on:{click:function(t){e.deleteHandler(n.attendanceGroupId)}}},[e._v("删除")]):e._e()]}}])})],2),e._v(" "),i("div",{staticClass:"p-contianer"},[i("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),e.createShow?i("create",{attrs:{id:e.id,action:e.createAction},on:{close:function(t){e.createShow=!1},"save-success":e.saveSuccess}}):e._e()],1)},o=[],l=i("2909"),c=(i("99af"),i("a15b"),i("d81d"),i("4e82"),i("cccc")),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("xr-create",{attrs:{loading:e.loading,title:"prev"==e.step?e.title:"出勤日设置","show-confirm":e.showConfirm,"show-cancel":!e.showConfirm},on:{close:e.close,save:e.saveClick}},[i("el-form",{directives:[{name:"show",rawName:"v-show",value:"prev"==e.step,expression:"step=='prev'"}],ref:"form",staticClass:"wk-form",attrs:{model:e.fieldForm,rules:e.fieldRules,"validate-on-rule-change":!1,"label-position":"top"}},e._l(e.fieldList,(function(t,n){return i("wk-form-items",{key:n,attrs:{"field-from":e.fieldForm,"field-list":t},on:{change:e.formChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return[n&&"punch_card"==n.formType?i("punch-card-field",{ref:"punchCard",refInFor:!0,model:{value:e.fieldForm[n.fieldName],callback:function(t){e.$set(e.fieldForm,n.fieldName,t)},expression:"fieldForm[data.fieldName]"}}):e._e(),e._v(" "),n&&"structure_employee"==n.formType?i("wk-user-dep-select",{staticStyle:{width:"100%"},attrs:{"dep-value":e.fieldForm[n.fieldName]["deptIds"],"user-value":e.fieldForm[n.fieldName]["employeeIds"],props:{dataType:"hrm"}},on:{"update:depValue":function(t){e.$set(e.fieldForm[n.fieldName],"deptIds",t)},"update:userValue":function(t){e.$set(e.fieldForm[n.fieldName],"employeeIds",t)}}}):e._e()]}}])})}))),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"last"==e.step,expression:"step=='last'"}],staticClass:"last-step"},[i("p",[e._v("设置员工周一到周日的出勤日和休息日。若是大小周或单休，需要进行特殊日期设置。")]),e._v(" "),i("div",{staticClass:"last-step-firstSet"},[i("span",[e._v("快速设置班次：")]),e._v(" "),i("el-select",{attrs:{size:"mini"},on:{change:e.quickSettingChange},model:{value:e.quickSetting,callback:function(t){e.quickSetting=t},expression:"quickSetting"}},e._l(e.options,(function(e){return i("el-option",{key:e.shiftId,attrs:{label:e.label,value:e.shiftId}})})))],1),e._v(" "),i("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.workData},on:{select:e.selectionChange,"select-all":e.selectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"week",label:"工作日",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"timeRange",label:"当天班次",width:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"prop",label:"更改班次",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-select",{attrs:{size:"mini"},on:{change:function(t){e.selectShiftChange(n)}},model:{value:n.shiftId,callback:function(t){e.$set(n,"shiftId",t)},expression:"row.shiftId"}},e._l(e.options,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.shiftId}})})))]}}])})],1),e._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0,label:"法定节假日休息"},model:{value:e.isRest,callback:function(t){e.isRest=t},expression:"isRest"}}),e._v(" "),i("p",[e._v("法定节假日将自动设为休息；若法定节假日有调班，请进行特殊日期设置。")])],1),e._v(" "),i("span",[e._v("特殊日期设置")]),e._v(" "),i("p",[e._v("如大小周或单休、调休、调班，需要设置出勤日或休息日的具体日期。")]),e._v(" "),i("el-popover",{ref:"popoverRef",attrs:{placement:"top",title:"添加日期",width:"310",trigger:"click"}},[i("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.selectedDate,callback:function(t){e.selectedDate=t},expression:"selectedDate"}}),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.addDate}},[e._v("确定")]),e._v(" "),i("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[e._v("+添加日期")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.technicalDate}},[i("el-table-column",{attrs:{prop:"date",label:"日期",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"timeRange",label:"当日班次",width:"width"}}),e._v(" "),i("el-table-column",{attrs:{prop:"prop",label:"更改班次",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-select",{attrs:{size:"mini"},on:{change:function(t){e.selectShiftChange(n)}},model:{value:n.shiftId,callback:function(t){e.$set(n,"shiftId",t)},expression:"row.shiftId"}},e._l(e.options,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.shiftId}})})))]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"prop",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.$index;return[i("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteTechnicalDate(n)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),i("el-button",{staticClass:"handle-button",attrs:{slot:"footer",type:"primary"},on:{click:e.handleClick},slot:"footer"},[e._v(e._s(e.buttonContent))])],1)},d=[],f=i("ade3"),h=i("5530"),m=(i("a9e3"),i("d3b7"),i("159b"),i("a434"),i("14d9"),i("7db0"),i("4de4"),i("caad"),i("2532"),i("d9e2"),i("8156")),p=i("215e"),v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"punch-card-field"},[i("div",{staticClass:"relation"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.checkGroup.isOpenPointCard,callback:function(t){e.$set(e.checkGroup,"isOpenPointCard",t)},expression:"checkGroup.isOpenPointCard"}},[e._v("关联打卡地址")]),e._v(" "),i("div",{staticClass:"relation__table"},[i("el-button",{on:{click:e.addPunchAddress}},[e._v("+新建打卡地址")]),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.punchCardAddressTable}},[i("el-table-column",{attrs:{prop:"name",label:"地址名称",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"打卡地址",width:"width"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v("\n            "+e._s(i.address+" | 有效范围"+i.pointRange+"米")+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,a=t.$index;return[i("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteAddress(n,a)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),i("div",{staticClass:"relation"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.checkGroup.isOpenWifiCard,callback:function(t){e.$set(e.checkGroup,"isOpenWifiCard",t)},expression:"checkGroup.isOpenWifiCard"}},[e._v("关联打卡WIFI")]),e._v(" "),i("div",{staticClass:"relation__table"},[i("el-button",{on:{click:e.addPunchWifi}},[e._v("+新建打卡WIFI")]),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.punchCardWifiTable}},[i("el-table-column",{attrs:{prop:"ssid",label:"WIFI名称",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"mac",label:"MAC地址",width:"width"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,a=t.$index;return[i("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteWifi(n,a)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.addressVisible,title:"新建打卡地址","append-to-body":"",width:"600px"},on:{"update:visible":function(t){e.addressVisible=t}}},[i("div",{staticClass:"map-search"},[i("div",{staticClass:"search-input"},[i("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"popper-class":"clock-adress-search","fetch-suggestions":e.querySearchAsync,size:"mini",placeholder:"请输入详细位置名称"},on:{blur:e.inputBlur,focus:e.inputFocus,select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.item;return[e._v("\n            "+e._s(i.address+i.title)+"\n          ")]}}]),model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}}),e._v(" "),i("el-select",{attrs:{size:"mini"},on:{change:e.radiusChange},model:{value:e.punchCardAddress.radius,callback:function(t){e.$set(e.punchCardAddress,"radius",t)},expression:"punchCardAddress.radius"}},e._l(e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1),e._v(" "),e.searchCopyInput?i("div",{staticClass:"search-info"},[e._v("\n        "+e._s(e.searchCopyInput)+"\n      ")]):e._e()]),e._v(" "),i("div",{ref:"myMap",staticClass:"map"},[e._v("地图")]),e._v(" "),i("p",[e._v("打卡地址 : "+e._s(e.punchCardAddress.address||""))]),e._v(" "),i("p",[e._v("地址名称 : "),i("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:25},model:{value:e.punchCardAddress.addressName,callback:function(t){e.$set(e.punchCardAddress,"addressName",t)},expression:"punchCardAddress.addressName"}})],1),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addressVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmAddress}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{attrs:{visible:e.wifiVisible,title:"新建打卡Wifi","append-to-body":"",width:"450px"},on:{"update:visible":function(t){e.wifiVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.wifiForm,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"WiFi名称"}},[i("el-input",{attrs:{placeholder:"建议与WiFi名一致，避免员工连错WiFi"},model:{value:e.wifiForm.ssid,callback:function(t){e.$set(e.wifiForm,"ssid",t)},expression:"wifiForm.ssid"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"MAC地址"}},[i("div",{staticClass:"input-group"},[e._l(6,(function(t,n){return[i("el-input",{key:n,ref:"mac",refInFor:!0,attrs:{placeholder:""},on:{input:function(t){e.macChange(n)}},model:{value:e.wifiForm.mac[n],callback:function(t){e.$set(e.wifiForm.mac,n,t)},expression:"wifiForm.mac[index]"}}),e._v("\n            "+e._s(5===n?"":":")+"\n          ")]}))],2),e._v(" "),i("div",[e._v("请前往手机端关于悟空查看可连接WiFiMac地址")])])],1),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.wifiVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmWifi}},[e._v("确 定")])],1)],1)],1)},g=[],b=(i("b64b"),i("00b4"),i("ed08")),y={props:{value:{type:Object,default:function(){}}},data:function(){return{loading:!1,addressVisible:!1,wifiVisible:!1,wifiForm:{mac:[],ssid:""},punchCardWifiTable:[],punchCardAddress:{radius:300,address:"",addressName:""},punchCardAddressTable:[],checkGroup:{isOpenPointCard:0,isOpenWifiCard:0},map:null,searchInput:"",searchCopyInput:"",pointAddress:null,options:[{label:"100",value:100},{label:"200",value:200},{label:"300",value:300},{label:"400",value:400},{label:"500",value:500},{label:"600",value:600},{label:"700",value:700},{label:"800",value:800},{label:"900",value:900},{label:"1000",value:1e3},{label:"2000",value:2e3},{label:"3000",value:3e3}],circle:null,centerPoint:{}}},watch:{addressVisible:function(e){var t=this;e?this.$nextTick((function(){Object(b["k"])().then((function(){var e=new BMap.Map(t.$refs.myMap,{enableMapClick:!0}),i=new BMap.Point(116.404,39.915);e.centerAndZoom(i,14),e.enableScrollWheelZoom(),t.map=e,t.addMarkerLabel(i),t.centerPoint=i}))})):(this.punchCardAddress={radius:300,address:"",addressName:""},this.pointAddress=null,this.searchInput="")},wifiVisible:function(e){e||(this.wifiForm={mac:[],ssid:""})},checkGroup:{handler:function(){this.emitEvent()},deep:!0,immediate:!0},punchCardAddressTable:function(){this.emitEvent()},punchCardWifiTable:function(){this.emitEvent()}},created:function(){},mounted:function(){if(Object.keys(this.value).length){var e=Object(b["z"])(this.value);this.punchCardAddressTable=e.pointList,this.punchCardWifiTable=e.wifiList;var t=e.isOpenPointCard,i=e.isOpenWifiCard;this.checkGroup={isOpenPointCard:t,isOpenWifiCard:i}}},methods:{radiusChange:function(){this.setCircle()},emitEvent:function(){var e=this.checkGroup,t=e.isOpenPointCard,i=e.isOpenWifiCard,n=e.isAutoCard;this.$emit("input",{isOpenPointCard:t,isOpenWifiCard:i,isAutoCard:n,wifiList:this.punchCardWifiTable,pointList:this.punchCardAddressTable})},deleteWifi:function(e,t){this.punchCardWifiTable.splice(t,1)},deleteAddress:function(e,t){this.punchCardAddressTable.splice(t,1)},confirmWifi:function(){var e=/^((([a-f0-9]{2}:){5})|(([a-f0-9]{2}-){5}))[a-f0-9]{2}$/i,t=this.wifiForm.ssid,i=this.wifiForm.mac.join(":")||"";t?i?e.test(i)?(this.punchCardWifiTable.push({ssid:t,mac:i}),this.wifiVisible=!1,this.wifiForm={mac:[],ssid:""}):this.$message.error("mac地址输入有误"):this.$message.error("请输入mac地址"):this.$message.error("请输入wifi名字")},confirmAddress:function(){if(this.punchCardAddress.address)if(this.punchCardAddress.addressName){var e=this.getAddressParams();this.punchCardAddressTable.push(e),this.punchCardAddress={radius:300,address:"",addressName:""},this.searchInput="",this.addressVisible=!1}else this.$message.error("请输入地址名称");else this.$message.error("请选择打卡地址")},getAddressParams:function(){var e=this.punchCardAddress.addressName,t=this.pointAddress,i=t.address,n=t.point,a=n.lat,r=n.lng,s=this.punchCardAddress.radius;return{address:i,lat:a,lng:r,name:e,pointRange:s}},querySearchAsync:function(e,t){if(e){var i={onSearchComplete:function(e){if(n.getStatus()==BMAP_STATUS_SUCCESS){for(var i=[],a=0;a<e.getCurrentNumPois();a++)i.push(e.getPoi(a));t(i)}else t([])},pageCapacity:20},n=new BMap.LocalSearch(this.map,i);n.search(e)}else t([])},handleSelect:function(e){this.searchInput=e.address+e.title,this.searchCopyInput=this.searchInput,this.centerPoint=e.point,this.addMarkerLabel(e.point),this.pointAddress=e,this.punchCardAddress.address=e.address,e.title.length>25?this.punchCardAddress.addressName=e.title.subString(0,25):this.punchCardAddress.addressName=e.title},inputBlur:function(){this.searchCopyInput!==this.searchInput&&(this.searchInput=this.searchCopyInput)},inputFocus:function(){this.searchCopyInput=this.searchInput},addMarkerLabel:function(e){this.map.clearOverlays(),this.map.centerAndZoom(e,14),this.map.addOverlay(new BMap.Marker(e));var t=new BMap.Circle(e,this.punchCardAddress.radius,{strokeColor:"#2362FB",fillColor:"#2362FB",strokeWeight:2,fillOpacity:.05,strokeOpacity:.5,strokeStyle:"solid"});this.circle=t,this.map.addOverlay(t)},getMapInfo:function(){this.loading=!0,this.map.clearOverlays(),this.addMarkerLabel(),this.setCircle(),this.loading=!1},addPunchAddress:function(){this.addressVisible=!0},addPunchWifi:function(){this.wifiVisible=!0},setCircle:function(){this.circle&&this.removeOverlay(this.circle);var e=new BMap.Circle(this.centerPoint,this.punchCardAddress.radius,{strokeColor:"#2362FB",fillColor:"#2362FB",strokeWeight:2,fillOpacity:.05,strokeOpacity:.5,strokeStyle:"solid"});e.setCenter(this.centerPoint),this.circle=e,this.circle.type="circle",this.map.addOverlay(e),this.map.setCenter(this.centerPoint),this.map.panTo(this.centerPoint),this.map.setViewport(this.markerArr)},removeOverlay:function(e){for(var t=this.map.getOverlays(),i=0;i<t.length;i++)t[i].type==e.type&&this.map.removeOverlay(t[i])},macChange:function(e){var t=this.$refs["mac"];2==this.wifiForm.mac[e].length&&(t[e].blur(),e<5&&t[e+1].focus())}}},T=y,C=(i("3b3e"),i("314c"),i("2877")),k=Object(C["a"])(T,v,g,!1,null,"19e0256c",null),_=k.exports,S=i("8cf0"),w=[[{name:"考勤组名称",formType:"text",fieldName:"name",placeholder:"请输入",isNull:1,isUnique:1,stylePercent:50,maxlength:50},{tipType:"tooltip",inputTips:"用于折算迟到、早退、旷工时长，方便计算应出勤天数",name:"考勤标注时长",formType:"number",fieldName:"dailyTime",placeholder:"请输入",isNull:1,precisions:2,maxNumRestrict:24,minNumRestrict:.01,stylePercent:50}],[{name:"考勤使用范围",formType:"structure_employee",fieldName:"structure_employee",placeholder:"请输入",isNull:1,stylePercent:50,defaultValue:{}}],[{name:"选择考勤打卡方式",formType:"punch_card",fieldName:"punch_card",isNull:1,stylePercent:100,defaultValue:{}}],[{name:"扣款规则",formType:"select",fieldName:"attendanceRuleId",isNull:1,stylePercent:50,setting:[]}]],I=i("2046"),N={components:{XrCreate:m["a"],WkFormItems:p["default"],PunchCardField:_,WkUserDepSelect:S["a"]},mixins:[I["a"]],props:{id:{type:[String,Number],default:""},action:{type:Object,default:function(){return{id:"",type:"save",data:{}}}}},data:function(){return{loading:!1,step:"prev",fieldList:[],fieldRules:{},fieldForm:{},visible:!1,quickSetting:"",selectedDate:"",workData:[{week:"星期一",type:"Monday",timeRange:"",shiftId:"",shiftType:""},{week:"星期二",type:"Tuesday",timeRange:"",shiftId:"",shiftType:""},{week:"星期三",type:"Wednesday",timeRange:"",shiftId:"",shiftType:""},{week:"星期四",type:"Thursday",timeRange:"",shiftId:"",shiftType:""},{week:"星期五",type:"Friday",timeRange:"",shiftId:"",shiftType:""},{week:"星期六",type:"Saturday",timeRange:"",shiftId:"",shiftType:""},{week:"星期日",type:"Sunday",timeRange:"",shiftId:"",shiftType:""}],shiftList:[],technicalDate:[],isRest:1,selectList:[]}},computed:{title:function(){return this.id?"编辑考勤组":"新建考勤组"},showConfirm:function(){return"prev"!=this.step},buttonContent:function(){return"prev"==this.step?"下一步":"上一步"},options:function(){var e=this;return this.shiftList.map((function(t){return{label:t.shiftName,value:t.shiftType,shiftId:t.shiftId,timeRange:e.getTimeRange(t)}}))}},watch:{step:function(e){var t=this;"last"==e&&this.workData.forEach((function(e){0!=e.shiftType?t.$refs.table.toggleRowSelection(e,!0):t.$refs.table.toggleRowSelection(e,!1)}))}},created:function(){this.getDeductionSetting()},methods:{userDepChange:function(e,t,i,n,a){this.$set(this.fieldForm,e.fieldName,{deptIds:n,employeeIds:a})},deleteTechnicalDate:function(e){this.technicalDate.splice(e,1)},addDate:function(){this.selectedDate&&(this.$refs.popoverRef.showPopper=!1,this.technicalDate.push({date:this.selectedDate,timeRange:"",shiftId:"",shiftType:""}),this.selectedDate="")},quickSettingChange:function(e){var t=this,i=this.options.find((function(t){return t.shiftId==e}));if(i){this.selectList.length||0==i.value||(this.selectList=this.workData.filter((function(e){return!["Saturday","Sunday"].includes(e.type)})));var n=this.selectList.map((function(e){return e.type}));this.workData.forEach((function(e){n.includes(e.type)&&(e.timeRange=i.timeRange,e.shiftType=i.value,e.shiftId=i.shiftId)})),i&&0==i.value&&(this.selectList=[]),this.workData.forEach((function(e){0!=e.shiftType?t.$refs.table.toggleRowSelection(e,!0):t.$refs.table.toggleRowSelection(e,!1)}))}},selectShiftChange:function(e){var t=this.options.find((function(t){return t.shiftId==e.shiftId}));t&&(this.$set(e,"timeRange",t.timeRange),this.$set(e,"shiftType",t.value),0==t.value?this.$refs.table.toggleRowSelection(e,!1):this.$refs.table.toggleRowSelection(e,!0),this.selectList=this.workData.filter((function(e){return 0!=e.shiftType})))},getTimeRange:function(e){for(var t=[],i=e.shiftType,n=1;n<=3;n++)e["start"+n]&&t.push(a=e["start"+n]+"-"+e["end"+n]);var a="";return e.restTimeStatus&&(a=" 休息：".concat(e.restStartTime,"-").concat(e.restEndTime)),"".concat({0:"休息",1:e.shiftName,2:"分段打卡"}[i]," ").concat(t.join("  ")," ").concat(a)},UniquePromise:function(e){e.field;var t=e.value;return Object(c["L"])({name:t,attendanceGroupId:this.id})},saveClick:function(){var e=this;this.loading=!0;var t=this.$refs.form;t.validate((function(t){if(t){var i=e.getSubmiteParams([].concat.apply([],e.fieldList),e.fieldForm);if(i=e.getAttendanceSet(i),!i.isOpenPointCard&&!i.isOpenWifiCard)return e.$message.error("请选择考勤打卡方式"),void(e.loading=!1);if(i.isOpenPointCard&&!i.pointList.length)return e.$message.error("请设置考勤打卡地址"),void(e.loading=!1);if(i.isOpenWifiCard&&!i.wifiList.length)return e.$message.error("请设置考勤打卡wiff"),void(e.loading=!1);e.submitData(i)}else e.loading=!1}))},submitData:function(e){var t=this,i=this.id?c["u"]:c["a"];this.id&&(e.attendanceGroupId=this.id),i(e).then((function(e){t.loading=!1,t.$message.success(t.id?"编辑成功，次日生效":"添加成功"),t.close(),t.$emit("save-success")})).catch((function(){t.loading=!1}))},getSubmiteParams:function(e,t){for(var i={},n=0;n<e.length;n++){var a=e[n],r=t[a.fieldName];if("structure_employee"==a.formType){var s=r.deptIds,o=void 0===s?[]:s,l=r.employeeIds,c=void 0===l?[]:l;i=Object(h["a"])({deptIds:o,employeeIds:c},i)}else if("punch_card"==a.formType){var u=r.isOpenPointCard,d=r.isOpenWifiCard,m=r.pointList,p=r.wifiList;i=Object(h["a"])(Object(h["a"])({},i),{},{isOpenPointCard:u,isOpenWifiCard:d,pointList:m,wifiList:p})}else i=Object(h["a"])(Object(h["a"])({},i),{},Object(f["a"])({},a.fieldName,r))}return i},getAttendanceSet:function(e){return Object(h["a"])(Object(h["a"])({},e),{},{shiftSetting:this.workData.map((function(e){return e.shiftId})),isRest:this.isRest,specialDateSetting:this.technicalDate.map((function(e){return{shift:e.shiftId,date:e.date}}))})},formChange:function(){},getField:function(e){var t=this,i=[],n=[],a={},r={};w.forEach((function(s){var o=[];s.forEach((function(n){"name"==n.fieldName&&(t.id?n.isUnique=0:n.isUnique=1),"attendanceRuleId"==n.fieldName&&(n.setting=e);var s=t.getFormItemDefaultProperty(n);"structure_employee"==s.field?a[s.field]=[{validator:function(e,i,n){var a=t.fieldForm.structure_employee;a.deptIds.length||a.employeeIds.length?n():n(new Error("请选择考核使用范围"))}}]:a[s.field]=t.getRules(n),r[s.field]=t.getItemValue(n,t.action.data,t.action.type),o.push(s),i.push(n)})),n.push(o)})),this.baseFields=i,this.fieldList=n,this.fieldForm=r,this.fieldRules=a,this.getShiftList(),this.id&&(this.isRest=this.action.data.isRest)},fullTechnicalDate:function(){var e=this,t=this.action.data;if(t){var i=this.action.data.specialDateSetting,n=void 0===i?[]:i;this.technicalDate=n.map((function(t){var i=e.getShiftObjById(t.shift,e.shiftList);return{date:t.date,timeRange:i&&i.timeRange,shiftId:t.shift}}))}},getItemValue:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if("structure_employee"==e.fieldName){if("update"==i){var n=t.deptList,a=t.employeeList;return{deptIds:n||[],employeeIds:a||[]}}return{}}if("attendanceRuleId"==e.fieldName){if("update"!==i){var r=e.setting;return r[0].value}return t[e.fieldName]}if("punch_card"==e.fieldName){if("update"==i){var s=t.isAutoCard,o=t.isOpenPointCard,l=t.isOpenWifiCard,c=t.pointList,u=t.wifiList;return{isAutoCard:s,isOpenPointCard:o,isOpenWifiCard:l,pointList:c||[],wifiList:u||[]}}return{}}return t[e.fieldName]},close:function(){this.$emit("close")},handleClick:function(){var e=this;"prev"==this.step?this.$refs.form.validate((function(t){if(t){var i=e.fieldForm.punch_card;if(!i.isOpenPointCard&&!i.isOpenWifiCard)return void e.$message.error("请至少选择一种打卡方式");if(i.isOpenPointCard){var n=i.pointList;if(!n.length)return void e.$message.error("请至少添加一个打卡点")}if(i.isOpenWifiCard){var a=i.wifiList;if(!a.length)return void e.$message.error("请至少添加一个打卡wifi")}e.step="last"}else e.$message.error("请完善表单信息")})):this.step="prev"},getDeductionSetting:function(){var e=this;Object(c["B"])({pageType:0}).then((function(t){var i=[];i=t.data.list.map((function(e){return{label:e.attendanceRuleName,value:e.attendanceRuleId}})),e.getField(i)})).catch((function(){}))},getShiftList:function(){var e=this;Object(c["C"])({pageType:0}).then((function(t){e.shiftList=t.data.list;var i=e.shiftList.find((function(e){return 1==e.isDefaultSetting&&1==e.shiftType}));if(e.id){var n=e.action.data.shiftSetting;e.workData.forEach((function(t,i){var a=e.getShiftObjById(n[i],e.shiftList);t.timeRange=a.timeRange,t.shiftId=a.shiftId,t.shiftType=a.shiftType,0!=t.shiftType&&e.selectList.push(t)}))}else i&&e.workData.forEach((function(t){var n=e.getShiftObjById(i.shiftId,e.shiftList);if(["Saturday","Sunday"].includes(t.type)){var a=e.shiftList.filter((function(e){return 1==e.isDefaultSetting&&0==e.shiftType}))[0],r=e.getShiftObjById(a.shiftId,e.shiftList);t.timeRange=r.timeRange,t.shiftId=r.shiftId,t.shiftType=r.shiftType}else t.timeRange=n.timeRange,t.shiftId=n.shiftId,t.shiftType=n.shiftType,e.selectList.push(t)}));e.fullTechnicalDate()}))},getShiftObjById:function(e,t){if(!t.length)return{};var i=t.find((function(t){return t.shiftId==e}));return i?{shiftId:i.shiftId,shiftType:Number(i.shiftType),timeRange:this.getTimeRange(i)}:{}},selectionChange:function(e){var t=this;this.selectList=e;var i=this.shiftList.filter((function(e){return 1==e.isDefaultSetting&&0==e.shiftType}))[0],n=this.getShiftObjById(i.shiftId,this.shiftList),a=e.map((function(e){return e.type}));this.workData.forEach((function(e){if(a.includes(e.type)){if(0==e.shiftType)if(t.quickSetting){var i=t.getShiftObjById(t.quickSetting,t.shiftList);t.$set(e,"shiftId",i.shiftId),t.$set(e,"shiftType",i.shiftType),t.$set(e,"timeRange",i.timeRange)}else{var r=t.shiftList.filter((function(e){return 1==e.isDefaultSetting&&1==e.shiftType}))[0],s=t.getShiftObjById(r.shiftId,t.shiftList);t.$set(e,"shiftId",s.shiftId),t.$set(e,"shiftType",s.shiftType),t.$set(e,"timeRange",s.timeRange)}}else t.$set(e,"shiftId",n.shiftId),t.$set(e,"shiftType",n.shiftType),t.$set(e,"timeRange",n.timeRange)}))}}},O=N,x=(i("a447"),Object(C["a"])(O,u,d,!1,null,"f7760562",null)),R=x.exports,F=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"attendance-date"},[i("div",{staticClass:"attendance-date-work"},[i("p",[e._v(e._s(e.dataValue.work))])]),e._v(" "),i("div",e._l(e.dataValue.shiftList,(function(t,n){return i("p",{key:n},[e._v("\n      "+e._s(t.shiftDetail)+"\n    ")])})))])},j=[],M=(i("c740"),{props:{attendanceValue:{type:Object}},computed:{dataValue:function(){var e=[],t=[],i=["一","二","三","四","五","六","日"],n=[];for(var a in this.attendanceValue)0==this.attendanceValue[a]["shiftType"]?e.push(i[a-1]):t.push(i[a-1]),n.push(this.attendanceValue[a]);var r=n.filter((function(e,t,i){return i.findIndex((function(t){return t.shiftId==e.shiftId}))===t&&e.shiftType}));return{rest:e.join(" 、"),work:t.join(" 、"),shiftList:r}}},methods:{}}),$=M,A=(i("3176"),Object(C["a"])($,F,j,!1,null,"2c6a6868",null)),L=A.exports,E=i("e297"),P=i.n(E),W=i("c9d9"),D={components:{Create:R,attendanceDate:L},props:{search:String},data:function(){return{createAction:{},currentPage:1,pageSizes:[15,30,60,100],pageSize:P.a.get(W["i"])||15,total:0,list:[],loading:!1,fieldList:[{label:"考勤组名称",prop:"name"},{label:"出勤时间",prop:"attendanceDate",width:300},{label:"考勤规则",prop:"attendanceRuleName"},{label:"适用范围",prop:"applyScope"}],id:"",createShow:!1,tableHeight:document.documentElement.clientHeight-275}},created:function(){this.getList()},methods:{formatter:function(e,t){if("applyScope"==t.property){var i=e.employeeList,n=void 0===i?[]:i,a=e.deptList,r=void 0===a?[]:a,s=[].concat(Object(l["a"])(n),Object(l["a"])(r));return s.map((function(e){return e.deptName||e.employeeName})).join("、")}return e[t.property]||"--"},getList:function(){var e=this;this.loading=!0,Object(c["A"])({limit:this.pageSize,page:this.currentPage,name:this.$parent.search}).then((function(t){e.loading=!1,t.data.list.sort((function(e,t){return 1===e.isDefaultSetting&&0===t.isDefaultSetting?-1:0===e.isDefaultSetting&&1===t.isDefaultSetting?1:0})),e.list=t.data.list,e.total=t.data.totalRow})).catch((function(){e.loading=!1}))},addHandleClick:function(){this.id="",this.createAction={},this.createShow=!0},saveSuccess:function(){this.handleRefresh()},handleSizeChange:function(e){P.a.set(W["i"],e),this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},deleteHandler:function(e){var t=this;this.$confirm("确定删除","提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((function(i){Object(c["f"])({attendanceGroupId:e}).then((function(){t.$message.success("操作成功"),t.handleRefresh()})).catch((function(){}))})).catch((function(){t.$message.info("取消操作")}))},updateHandler:function(e){this.createAction={id:e.attendanceGroupId,type:"update",data:e},this.createShow=!0,this.id=e.attendanceGroupId},handleRefresh:function(){this.currentPage=1,this.getList()},delShow:function(e){return!e.isDefaultSetting}}},H=D,V=(i("e1de"),Object(C["a"])(H,s,o,!1,null,"6e22a270",null)),z=V.exports,U=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{staticClass:"content-title"},[i("span",[e._v("班次设置")]),e._v(" "),i("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:e.addClasses}},[e._v("新建班次")])],1),e._v(" "),i("div",{staticClass:"content-body"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,height:e.tableHeight}},[e._l(e.fieldList,(function(t,n){return i("el-table-column",{key:n,attrs:{prop:t.prop,label:t.label},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.row,r=n.column;return["shiftType"==t.prop?[i("span",[e._v(e._s(e._f("shiftType")(a[t.prop])))])]:"shiftTime"==t.prop?[e._l(e.getShiftTime(a).timeRange,(function(t){return i("p",{key:t},[e._v("\n              "+e._s(t)+"\n            ")])})),e._v(" "),a.restTimeStatus?i("p",[e._v("休息:"+e._s(e.getShiftTime(a).restTime))]):e._e()]:[i("span",[e._v(e._s(e.formatter(a,r,a[r.property])))])]]}}])})})),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["休息"!==n.shiftName?i("el-button",{attrs:{type:"primary-text"},on:{click:function(t){e.updateHandler(n)}}},[e._v("修改")]):e._e(),e._v(" "),e.isDelShow(n)?i("el-button",{attrs:{type:"primary-text"},on:{click:function(t){e.deleteHandler(n.shiftId)}}},[e._v("删除")]):e._e()]}}])})],2),e._v(" "),i("div",{staticClass:"p-contianer"},[i("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),e.createShow?i("create",{attrs:{id:e.id,"data-value":e.dataValue},on:{close:function(t){e.createShow=!1},"save-success":e.saveSuccess}}):e._e()],1)},q=[],B=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("xr-create",{attrs:{loading:e.loading,title:e.title},on:{close:e.close,save:e.saveClick}},[i("el-form",{ref:"formRef",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"top"}},[i("el-form-item",{staticClass:"wk-form-item",attrs:{label:"班次名称",prop:"shiftName"}},[i("el-input",{staticStyle:{width:"325px"},attrs:{placeholder:"请输入"},model:{value:e.form.shiftName,callback:function(t){e.$set(e.form,"shiftName",t)},expression:"form.shiftName"}})],1),e._v(" "),i("el-form-item",{staticClass:"wk-form-item",attrs:{label:"打卡类型"}},[i("el-radio-group",{model:{value:e.form.shiftType,callback:function(t){e.$set(e.form,"shiftType",t)},expression:"form.shiftType"}},[i("el-radio",{attrs:{label:1,checked:""}},[e._v("早晚打卡 "),i("span",{staticClass:"input_tips"},[e._v("(午休无需打卡)")])])],1)],1),e._v(" "),i("div",{staticClass:"time-set-item-wrap"},[i("div",{staticClass:"time-set-item"},[i("el-row",{attrs:{type:"flex"}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{staticClass:"small-label",attrs:{label:"上班时间",prop:"workTime"}},[i("range-time-picker",{attrs:{"selectable-range":e.workTimeRange},on:{change:function(t){e.workTimeChange(t,"workTime")}},model:{value:e.form.workTime,callback:function(t){e.$set(e.form,"workTime",t)},expression:"form.workTime"}})],1)],1)],1),e._v(" "),i("el-row",{attrs:{type:"flex"}},[i("el-col",{attrs:{span:18}},[i("el-form-item",{staticClass:"time-range-el-form-item",attrs:{label:"上班打卡时间段",prop:"workTimeRange"}},[i("flexbox",{staticClass:"time-range"},[i("range-time-picker",{attrs:{"selectable-range":e.workTimeStartRange},model:{value:e.form.workTimeStart,callback:function(t){e.$set(e.form,"workTimeStart",t)},expression:"form.workTimeStart"}}),e._v(" "),i("span",{staticClass:"division"},[e._v("至")]),e._v(" "),i("range-time-picker",{attrs:{"selectable-range":e.workTimeEndRange},model:{value:e.form.workTimeEnd,callback:function(t){e.$set(e.form,"workTimeEnd",t)},expression:"form.workTimeEnd"}})],1)],1)],1)],1),e._v(" "),i("el-row",{attrs:{type:"flex"}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{staticClass:"small-label",attrs:{label:"下班时间",prop:"offWorkTime"}},[i("range-time-picker",{attrs:{"selectable-range":e.offWorkTimeRange},on:{change:function(t){e.workTimeChange(t,"offWorkTime")}},model:{value:e.form.offWorkTime,callback:function(t){e.$set(e.form,"offWorkTime",t)},expression:"form.offWorkTime"}})],1)],1)],1),e._v(" "),i("el-row",{attrs:{type:"flex"}},[i("el-col",{attrs:{span:18}},[i("el-form-item",{staticClass:"time-range-el-form-item time",attrs:{label:"下班打卡时间段",prop:"offWorkRange"}},[i("flexbox",{staticClass:"time-range"},[i("range-time-picker",{attrs:{"selectable-range":e.offWorkTimeStartRange},model:{value:e.form.offWorkTimeStart,callback:function(t){e.$set(e.form,"offWorkTimeStart",t)},expression:"form.offWorkTimeStart"}}),e._v(" "),i("span",{staticClass:"division"},[e._v("至")]),e._v(" "),i("range-time-picker",{attrs:{"selectable-range":e.offWorkTimeEndRange},model:{value:e.form.offWorkTimeEnd,callback:function(t){e.$set(e.form,"offWorkTimeEnd",t)},expression:"form.offWorkTimeEnd"}})],1)],1)],1)],1),e._v(" "),i("el-row",{attrs:{type:"flex"}},[i("el-col",{attrs:{span:14}},[i("el-form-item",{staticClass:"small-label",attrs:{label:"休息时间"}},[i("flexbox",{staticClass:"time-range"},[i("range-time-picker",{attrs:{"selectable-range":e.restTimeStartRange},model:{value:e.form.restStartTime,callback:function(t){e.$set(e.form,"restStartTime",t)},expression:"form.restStartTime"}}),e._v(" "),i("span",{staticClass:"division"},[e._v("至")]),e._v(" "),i("range-time-picker",{attrs:{"selectable-range":e.restTimeEndRange},model:{value:e.form.restEndTime,callback:function(t){e.$set(e.form,"restEndTime",t)},expression:"form.restEndTime"}})],1)],1)],1),e._v(" "),i("el-col",{attrs:{span:10}},[i("el-form-item",{staticClass:"small-label restTimeStatusCheckbox"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.form.restTimeStatus,callback:function(t){e.$set(e.form,"restTimeStatus",t)},expression:"form.restTimeStatus"}})],1)],1)],1),e._v(" "),i("span",{staticStyle:{color:"#999"}},[e._v("未选中参与工作时长计算，选中不参与工作时长计算")])],1)]),e._v(" "),i("p",{staticClass:"total"},[e._v("合计工作时长： "),i("span",{staticStyle:{color:"#2362fb"}},[e._v(e._s(e.shiftHoursShow))])])],1)],1)},G=[],Z=(i("5319"),i("cc78")),X=i("6bfe"),J=i("c1df"),K=i.n(J),Q={components:{XrCreate:m["a"],RangeTimePicker:Z["a"]},props:{id:{type:[String,Number],default:""},dataValue:{type:Object,default:function(){}}},data:function(){var e=this;return{loading:!1,form:{shiftType:1,shiftName:"",workTime:"9:00",offWorkTime:"18:00",workTimeStart:"05:00",workTimeEnd:"17:59",offWorkTimeStart:"09:01",offWorkTimeEnd:"28:59",restStartTime:"12:00",restEndTime:"18:00",restTimeStatus:0},rules:{shiftName:[{required:!0,message:"请输入班次名称",trigger:"blur"},{validator:function(t,i,n){Object(X["c"])(i)?n():e.verifyAttendanceShiftName({value:i}).then((function(){n()})).catch((function(e){n(new Error("班次名称验证出错"))}))},trigger:["blur"]}]}}},computed:{title:function(){return this.id?"编辑班次":"新建班次"},workTimeRange:function(){var e=this.timeAddSubtractMinute(this.form.offWorkTime,"subtract"),t=parseFloat(e.replace(/:/g,""));return["00:00",t>=2400?"23:59":e]},workTimeStartRange:function(){var e=this.timeAddSubtractMinute(this.form.workTime,"add"),t=this.timeAddSubtractHour(e,"subtract",8);return[t,this.timeAddSubtractMinute(this.form.workTime,"subtract")]},workTimeEndRange:function(){return[this.timeAddSubtractMinute(this.form.workTime,"add"),this.timeAddSubtractMinute(this.form.offWorkTime,"subtract")]},offWorkTimeStartRange:function(){return[this.timeAddSubtractMinute(this.form.workTime,"add"),this.timeAddSubtractMinute(this.form.offWorkTime,"subtract")]},offWorkTimeEndRange:function(){var e=this.timeAddSubtractMinute(this.form.workTimeStart,"subtract"),t=this.processingTime(e);return t[0]+=24,[this.timeAddSubtractMinute(this.form.offWorkTime,"add"),t.join(":")]},offWorkTimeRange:function(){return[this.timeAddSubtractMinute(this.form.workTime,"add",2),this.getOffWorkEndTime()]},restTimeStartRange:function(){var e=this.$moment("2022/3/16 ".concat(this.form.restEndTime)).subtract(1,"m").format("HH:mm");return[this.form.workTime,e]},restTimeEndRange:function(){var e="2022/3/16 ".concat(this.form.restStartTime),t=this.$moment(e).add(1,"m").format("HH:mm");return[t,this.form.offWorkTime]},shiftHours:function(){var e=0,t=0;if(this.form.restTimeStatus)if(2==this.form.shiftType)t=0;else if(this.form.restStartTime&&this.form.restEndTime){var i=this.processingTime(this.form.restEndTime)[0]>23,n=this.form.restStartTime,a=this.form.restEndTime;i?(t+=this.difference(n,"23:59"),t+=this.difference("00:00",a)):t=this.difference(n,a)}else t=0;else t=0;var r=this.processingTime(this.form.offWorkTime)[0]>23,s=this.form.workTime,o=this.form.offWorkTime;return r?(e+=this.difference(s,"23:59"),e+=this.difference("00:00",o)):e+=this.difference(s,o),e=Math.abs(e-t),e},shiftHoursShow:function(){var e=this.shiftHours,t=e%60>9?e%60:"0"+e%60;return Math.floor(e/60)+"小时"+t+"分钟"}},watch:{},created:function(){this.init()},methods:{init:function(){if(this.id){var e=this.dataValue,t=e.shiftName,i=e.shiftType,n=e.start1,a=e.end1,r=e.restEndTime,s=e.restStartTime,o=e.lateCard1,l=e.advanceCard1,c=e.postponeCard1,u=e.earlyCard1,d=e.restTimeStatus;this.form.shiftName=t,this.form.shiftType=i,this.form.workTime=n,this.form.offWorkTime=a,this.form.workTimeStart=l,this.form.workTimeEnd=o,this.form.offWorkTimeStart=u,this.form.offWorkTimeEnd=c,this.form.restTimeStatus=d,this.form.restStartTime=s,this.form.restEndTime=r}},verifyAttendanceShiftName:function(e){var t=e.value;return Object(c["N"])({shiftId:this.id,shiftName:t})},close:function(){this.$emit("close")},saveClick:function(){var e=this;this.loading=!0,this.$refs.formRef.validate((function(t){if(t){var i=e.getParams();Object(c["c"])(i).then((function(t){e.loading=!1;var i=e.id?"班次次日生效,且关联班次的考勤组次日生效":"班次管理列表刷新数据";e.$message.success(i),e.close(),e.$emit("save-success")})).catch((function(){e.loading=!1}))}else e.loading=!1}))},getParams:function(){var e={shiftType:this.form.shiftType,shiftName:this.form.shiftName,shiftHours:this.shiftHours,restStartTime:this.form.restStartTime,restEndTime:this.form.restEndTime};return this.id&&(e["shiftId"]=this.id),e.start1=this.form.workTime,e.end1=this.form.offWorkTime,e.advanceCard1=this.form.workTimeStart,e.lateCard1=this.form.workTimeEnd,e.earlyCard1=this.form.offWorkTimeStart,e.postponeCard1=this.form.offWorkTimeEnd,e.restTimeStatus=this.form.restTimeStatus,e},difference:function(e,t){if(!e||!t)return 0;var i=this.processingTime(e),n=this.processingTime(t);i[0]>23&&(i[0]=i[0]-24,e=i.join(":")),n[0]>23&&(n[0]=n[0]-24,t=n.join(":"));var a=this.$moment(e,"HH:mm"),r=this.$moment(t,"HH:mm");return a.diff(r,"minute")},timeAddSubtractMinute:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.split(":"),a=parseInt(n[0]),r=parseInt(n[1]);return"add"===t?(r+=i,r>59&&(a++,r-=60)):"subtract"===t&&(r-=i,r<0&&(a--,r+=60)),"".concat(this.fillZero(a),":").concat(this.fillZero(r))},timeAddSubtractHour:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.split(":"),a=parseInt(n[0]),r=parseInt(n[1]);return"add"===t?a+=i:"subtract"===t&&(a-=i),"".concat(this.fillZero(a),":").concat(this.fillZero(r))},fillZero:function(e){var t;if(e<0){var i=Math.abs(e);t=e<10?"-0".concat(i):"-".concat(i)}else t=e<10?"0".concat(e):e;return t},getOffWorkTimeEnd:function(){if(this.form.workTime){var e=this.form.workTime.split(":"),t=parseInt(e[0]),i=parseInt(e[1]),n=t+24,a=i;return t>0||i>0?(0===i?(n-=1,a=59):a-=1,"".concat(this.fillZero(n),":").concat(this.fillZero(a))):"23:59"}return"23:59"},getOffWorkEndTime:function(){var e=this.form.workTimeStart.split(":"),t=parseInt(e[0]),i=parseInt(e[1]);return i<2?(t-=1,i=60+i-2):i-=2,"".concat(this.fillZero(t+24),":").concat(this.fillZero(i))},processingTime:function(e){return e.split(":").map((function(e,t){return Number(e)}))},workTimeChange:function(e,t){var i=this,n=this.form,a=n.restStartTime,r=n.restEndTime,s=n.workTime,o=n.offWorkTime,l=K()(e,"HH:mm"),c=K()(a,"HH:mm"),u=K()(r,"HH:mm"),d=l.isBefore(c),f=l.isBefore(u);"offWorkTime"==t?(d&&this.$nextTick((function(){i.$set(i.form,"restStartTime",s),setTimeout((function(){i.$set(i.form,"restEndTime",o)}),0)})),f&&this.$nextTick((function(){i.$set(i.form,"restEndTime",e)}))):"workTime"==t&&(d||this.$nextTick((function(){i.$set(i.form,"restStartTime",e),setTimeout((function(){i.$set(i.form,"restEndTime",o)}),0)})))}}},Y=Q,ee=(i("b900"),Object(C["a"])(Y,B,G,!1,null,"01f5ba3c",null)),te=ee.exports,ie={filters:{shiftType:function(e){return{1:"早晚打卡",2:"分段打卡"}[e]}},components:{Create:te},data:function(){return{currentPage:1,pageSizes:[15,30,60,100],pageSize:P.a.get(W["i"])||15,total:0,list:[],otherParams:{},loading:!1,id:"",dataValue:{},fieldList:[{label:"班次名称",prop:"shiftName"},{label:"打卡类型",prop:"shiftType"},{label:"出勤时段",prop:"shiftTime"},{label:"出勤时长",prop:"shiftHours"}],createShow:!1,tableHeight:document.documentElement.clientHeight-275}},created:function(){this.getList()},methods:{formatter:function(e,t,i){if("shiftHours"===t.property){if(!e[t.property])return"--";var n=e[t.property],a=n%60>9?n%60:"0"+n%60;return Math.floor(n/60)+"小时"+a+"分钟"}return e[t.property]||"--"},addClasses:function(){this.id="",this.createShow=!0},deleteHandler:function(e){var t=this;this.$confirm("确定删除!","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(i){Object(c["h"])({attendanceShiftId:e}).then((function(e){t.$message.success("删除成功"),t.handleRefresh()}))})).catch((function(){t.$message.info("取消操作")}))},saveSuccess:function(){this.handleRefresh()},getShiftTime:function(e){var t={};if(e.restEndTime&&null!=e.restEndTime&&(t.restTime="".concat(e.restStartTime,"-").concat(e.restEndTime)),1==e.shiftType)t.timeRange=["".concat(e.start1,"-").concat(e.end1)];else{for(var i=[],n=1;n<=3;n++)e["start"+n]&&null!=e["start"+n]&&i.push("".concat(e["start"+n],"-").concat(e["end"+n]));t.timeRange=i}return t},updateHandler:function(e){this.id=e.shiftId,this.dataValue=e,this.createShow=!0},handleSizeChange:function(e){P.a.set(W["i"],e),this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},handleRefresh:function(){this.currentPage=1,this.getList()},getList:function(){var e=this;this.loading=!0,Object(c["C"])({limit:this.pageSize,page:this.currentPage,shiftName:this.$parent.search}).then((function(t){e.loading=!1,e.list=t.data.list.filter((function(e){return![0].includes(e.shiftType)})),e.total=t.data.totalRow})).catch((function(){e.loading=!1}))},isDelShow:function(e){return!e.isDefaultSetting}}},ne=ie,ae=(i("aadd"),Object(C["a"])(ne,U,q,!1,null,"2c0da350",null)),re=ae.exports,se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main"},[i("xr-header",{attrs:{label:"考勤规则设置"}},[i("el-button",{attrs:{slot:"ft",type:"primary"},on:{click:e.addHandlerClick},slot:"ft"},[e._v("新建扣款规则")])],1),e._v(" "),i("div",{staticClass:"main-body"},[i("el-tabs",{attrs:{value:"active"}},[i("el-tab-pane",{attrs:{label:"扣款规则",name:"active"}},[i("div",{staticClass:"reminder-content"},[i("p",[e._v("1、用于管理企业员工迟到、早退、旷工、缺卡时的扣款规则。")]),e._v(" "),i("p",[e._v("2、您可以根据企业的情况进行方案自定义。")])]),e._v(" "),i("el-table",{class:e.WKConfig.tableStyle.class,staticStyle:{width:"100%"},attrs:{data:e.list,stripe:e.WKConfig.tableStyle.stripe,height:e.tableHeight,"highlight-current-row":""}},[e._l(e.fieldList,(function(t){return i("el-table-column",{key:t.label,attrs:{prop:t.prop,label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.row,r=n.column;return[["lateRuleMethod","earlyRuleMethod","absenteeismRuleMethod","misscardRuleMethod"].includes(t.prop)?i("div",[i("p",[e._v(e._s(e.getRuleName(t.prop,a).ruleName))]),e._v(" "),i("p",[e._v(e._s(e.getRuleName(t.prop,a).releTimeUnit))])]):[e._v("\n                "+e._s(a[r.property])+"\n              ")]]}}])})})),e._v(" "),i("el-table-column",{attrs:{prop:"prop",label:"操作",width:"width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-button",{attrs:{type:"primary-text"},on:{click:function(t){e.updateHandler(n)}}},[e._v("修改")]),e._v(" "),e.isDelShow(n)?i("el-button",{attrs:{type:"primary-text"},on:{click:function(t){e.deleteHandler(n.attendanceRuleId)}}},[e._v("删除")]):e._e()]}}])})],2)],1)],1)],1),e._v(" "),e.createShow?i("create",{attrs:{id:e.id,action:e.createAction},on:{close:function(t){e.createShow=!1},"save-success":e.saveSuccess}}):e._e()],1)},oe=[],le=(i("b0c0"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("xr-create",{attrs:{loading:e.loading,title:e.title},on:{close:e.close,save:e.saveClick}},[i("el-form",{ref:"form",staticClass:"wk-form",attrs:{model:e.fieldForm,rules:e.fieldRules,"validate-on-rule-change":!1,"label-position":"top"}},e._l(e.fieldList,(function(t,n){return i("wk-form-items",{key:n,attrs:{"field-from":e.fieldForm,"field-list":t},on:{change:e.formChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return[n&&"personalized"==n.formType?i("div",{staticClass:"personalized",attrs:{value:n}},[i("div",[e._v("个性设置\n            "),i("el-switch",{attrs:{disabled:e.personalitySetting,"active-value":1,"inactive-value":0},model:{value:e.fieldForm[n.fieldName].isPersonalization,callback:function(t){e.$set(e.fieldForm[n.fieldName],"isPersonalization",t)},expression:"fieldForm[data.fieldName].isPersonalization"}})],1),e._v(" "),e.fieldForm[n.fieldName].isPersonalization?i("div",{staticClass:"interval-top"},[e._v("每月累计迟到\n            "),i("el-input",{attrs:{type:"number"},model:{value:e.fieldForm[n.fieldName].lateMinutesOrCounts,callback:function(t){e.$set(e.fieldForm[n.fieldName],"lateMinutesOrCounts",e._n(t))},expression:"fieldForm[data.fieldName].lateMinutesOrCounts"}},[i("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(1==e.fieldForm.lateRuleMethod?"分钟":"次"))])]),e._v(" 后不扣款 ")],1):e._e(),e._v(" "),e.fieldForm[n.fieldName].isPersonalization?i("div",{staticClass:"interval-top"},[e._v("每月累计早退\n            "),i("el-input",{attrs:{type:"number"},model:{value:e.fieldForm[n.fieldName].earlyMinutesOrCounts,callback:function(t){e.$set(e.fieldForm[n.fieldName],"earlyMinutesOrCounts",e._n(t))},expression:"fieldForm[data.fieldName].earlyMinutesOrCounts"}},[i("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(1==e.fieldForm.earlyRuleMethod?"分钟":"次"))])]),e._v(" 后不扣款 ")],1):e._e()]):n&&"computeMode"==n.formType?i("div",[i("el-input",{attrs:{placeholder:n.placeholder,clear:"no-number",precision:2,type:"number"},model:{value:e.fieldForm[n.field],callback:function(t){e.$set(e.fieldForm,n.field,e._n(t))},expression:"fieldForm[data.field]"}},[i("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(n.unit))])])],1):e._e()]}}])})})))],1)}),ce=[],ue=[[{isNull:1,isUnique:1,fieldName:"attendanceRuleName",name:"规则名称",formType:"text",stylePercent:50}],[{defaultValue:1,fieldName:"lateRuleMethod",name:"迟到规则",inputTips:"扣款=迟到分钟*N元/分钟",formType:"select",stylePercent:50,setting:[{label:"迟到分钟扣款",value:1},{label:"迟到次数扣款",value:2},{label:"每月固定扣款",value:3}]},{defaultValue:"0.00",isNull:1,unit:"元/分",fieldName:"lateDeductMoney",name:"计算方式",formType:"computeMode",placeholder:"",stylePercent:50}],[{defaultValue:1,fieldName:"earlyRuleMethod",name:"早退规则",inputTips:"扣款=早退分钟*N元/分钟",formType:"select",stylePercent:50,setting:[{label:"按早退分钟扣款",value:1},{label:"按早退次数扣款",value:2},{label:"每月固定扣款",value:3}]},{defaultValue:"0.00",unit:"分/元",isNull:1,fieldName:"earlyDeductMoney",name:"计算方式",formType:"computeMode",placeholder:"",stylePercent:50}],[{defaultValue:1,fieldName:"absenteeismRuleMethod",name:"旷工规则",inputTips:"扣款=旷工天数*N元/天",formType:"select",stylePercent:50,setting:[{label:"按旷工天数扣款",value:1}]},{defaultValue:"0.00",unit:"元/天",isNull:1,fieldName:"absenteeismDeductMoney",name:"计算方式",formType:"computeMode",placeholder:"",stylePercent:50}],[{defaultValue:1,fieldName:"misscardRuleMethod",name:"缺卡规则",inputTips:"扣款=缺卡次数*N元/次",formType:"select",stylePercent:50,setting:[{label:"按缺卡次数扣款",value:1}]},{defaultValue:"0.00",unit:"元/次",isNull:1,fieldName:"misscardDeductMoney",name:"计算方式",formType:"computeMode",placeholder:"",stylePercent:50}],[{name:"",inputTips:"",fieldName:"personalized",formType:"personalized",defaultValue:1,stylePercent:100}]],de={components:{XrCreate:m["a"],WkFormItems:p["default"]},mixins:[I["a"]],props:{id:{type:[String,Number],default:""},action:{type:Object,default:function(){return{id:"",type:"save",data:{}}}}},data:function(){return{loading:!1,fieldList:[],fieldForm:{},fieldRules:{},baseFields:[],personalized:{},setectValueMap:{lateRuleMethod:{1:{inputTips:"扣款=迟到分钟*N元/分钟",unit:"元/分"},2:{inputTips:"扣款=迟到次数*N元/次",unit:"元/次"},3:{inputTips:"当月出现迟到情况即按N元/月扣款",unit:"元/月"},computeMode:"lateDeductMoney"},earlyRuleMethod:{1:{inputTips:"扣款=早退分钟*N元/分钟",unit:"元/分"},2:{inputTips:"扣款=早退次数*N元/次",unit:"元/次"},3:{inputTips:"当月出现早退情况即按N元/月扣款",unit:"元/月"},computeMode:"earlyDeductMoney"}}}},computed:{title:function(){return this.id?"编辑扣款规则":"新建扣款规则"},personalitySetting:function(){var e=this.fieldForm,t=e.lateRuleMethod,i=e.earlyRuleMethod;return 3==t||3==i}},watch:{personalized:{handler:function(e,t){this.fieldForm.personalized=e},immediate:!0,deep:!0},personalitySetting:function(e){e&&this.$set(this.fieldForm,"personalized",{isPersonalization:0,lateMinutesOrCounts:0,earlyMinutesOrCounts:0})}},created:function(){this.getField()},methods:{getField:function(){var e=this,t=[],i=[],n={},a={};ue.forEach((function(r){var s=[];r.forEach((function(i){var r=e.getFormItemDefaultProperty(i);["absenteeismDeductMoney","earlyDeductMoney","lateDeductMoney","misscardDeductMoney"].includes(r.field)?n[r.field]=[{required:!0,trigger:"change",message:"请输入金额"},{pattern:/(^[1-9]([0-9]+)?(\.[0-9]{1,2})?$)|(^(0){1}$)|(^[0-9]\.[0-9]([0-9])?$)/,message:"最多保留两位小数"}]:n[r.field]=e.getRules(i),a[r.field]=e.getItemValue(i,e.action.data,e.action.type),["lateRuleMethod","earlyRuleMethod"].includes(r.fieldName)&&setTimeout((function(){e.setInputTipsAndUnit(r,r.fieldName,a[r.field])})),s.push(r),t.push(i)})),i.push(s)})),this.baseFields=t,this.fieldList=i,this.fieldForm=a,this.fieldRules=n},getItemValue:function(e,t,i){if("personalized"==e.formType){if("update"===i){var n=t.isPersonalization,a=t.lateMinutesOrCounts,r=t.earlyMinutesOrCounts;return{isPersonalization:n,lateMinutesOrCounts:a,earlyMinutesOrCounts:r}}return{isPersonalization:0,lateMinutesOrCounts:"",earlyMinutesOrCounts:""}}return"update"===i?t[e.fieldName]:null===e.defaultValue||void 0===e.defaultValue?"":e.defaultValue},UniquePromise:function(e){e.field;var t=e.value;return Object(c["M"])({attendanceRuleId:this.id,attendanceRuleName:t})},close:function(){this.$emit("close")},saveClick:function(){var e=this;this.loading=!0,this.$refs.form.validate((function(t){if(t){var i=e.getSubmiteParams([].concat.apply([],e.fieldList),e.fieldForm);if(e.id&&(i.attendanceRuleId=e.id),i.isPersonalization&&(!i.lateMinutesOrCounts||!i.earlyMinutesOrCounts))return e.$message.error("请补充完整个性设置"),void(e.loading=!1);Object(c["b"])(i).then((function(t){e.$message.success("操作成功"),e.close(),e.$emit("save-success")})).catch((function(){e.loading=!1}))}else e.loading=!1}))},getSubmiteParams:function(e,t){var i={};return e.forEach((function(e){var n=null;if(n=t[e.fieldName],"computeMode"==e.formType)i[e.fieldName]=Number(n);else if("personalized"==e.formType)for(var a in n)(n[a]||0===n[a])&&(i[a]=n[a]);else i[e.fieldName]=n})),i},formChange:function(e,t,i,n){"lateRuleMethod"!=e.fieldName&&"earlyRuleMethod"!=e.fieldName||this.setInputTipsAndUnit(e,e.fieldName,i)},setInputTipsAndUnit:function(e,t,i){var n=this;e.inputTips=this.setectValueMap[t][i].inputTips,this.fieldList.forEach((function(e){e.forEach((function(e){e.fieldName==n.setectValueMap[t]["computeMode"]&&n.$set(e,"unit",n.setectValueMap[t][i].unit)}))})),this.$forceUpdate()}}},fe=de,he=(i("0178"),Object(C["a"])(fe,le,ce,!1,null,null,null)),me=he.exports,pe={components:{XrHeader:r["a"],Create:me},data:function(){return{tableHeight:document.documentElement.clientHeight-380,currentPage:1,pageSizes:[15,30,60,100],pageSize:15,total:0,list:[],otherParams:{},loading:!1,createAction:{type:"save",id:"",data:{}},fieldList:[{label:"规则名称",prop:"attendanceRuleName"},{label:"迟到",prop:"lateRuleMethod"},{label:"早退",prop:"earlyRuleMethod"},{label:"旷工",prop:"absenteeismRuleMethod"},{label:"缺卡",prop:"misscardRuleMethod"}],createShow:!1,id:"",nameValueMap:{lateRuleMethod:[{name:"迟到分钟扣款",value:1,unit:"元/分钟",computeMode:"lateDeductMoney"},{name:"迟到次数扣款",value:2,unit:"元/次",computeMode:"lateDeductMoney"},{name:"每月固定扣款",value:3,unit:"元/月",computeMode:"lateDeductMoney"}],earlyRuleMethod:[{name:"早退分钟扣款",value:1,unit:"元/分钟",computeMode:"earlyDeductMoney"},{name:"早退次数扣款",value:2,unit:"元/次",computeMode:"earlyDeductMoney"},{name:"每月固定扣款",value:3,unit:"元/月",computeMode:"earlyDeductMoney"}],absenteeismRuleMethod:[{name:"旷工天数扣款",value:1,unit:"元/天",computeMode:"absenteeismDeductMoney"}],misscardRuleMethod:[{name:"缺卡次数扣款",value:1,unit:"元/次",computeMode:"misscardDeductMoney"}]}}},created:function(){var e=this;window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-380},this.getList()},methods:{getList:function(){var e=this;this.loading=!0,Object(c["B"])({limit:this.pageSize,page:this.currentPage}).then((function(t){e.loading=!1,e.list=t.data.list,e.total=t.data.totalRow}))},deleteHandler:function(e){var t=this;this.$confirm("确定删除","提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((function(i){Object(c["g"])({attendanceRuleId:e}).then((function(){t.$message.success("操作成功"),t.handleRefresh()})).catch((function(){}))})).catch((function(){t.$message.info("取消操作")}))},addHandlerClick:function(){this.id="",this.createAction={id:"",type:"save",data:{}},this.createShow=!0},updateHandler:function(e){this.createShow=!0,this.createAction={id:e.attendanceRuleId,type:"update",data:e},this.id=e.attendanceRuleId},saveSuccess:function(){this.handleRefresh()},getRuleName:function(e,t){var i=this.nameValueMap[e].find((function(i){return i.value==t[e]}));return i?{ruleName:i.name,releTimeUnit:t[i.computeMode]+i.unit}:{ruleName:"",releTimeUnit:""}},handleRefresh:function(){this.currentPage=1,this.getList()},isDelShow:function(e){return!e.isDefaultSetting}}},ve=pe,ge=(i("1b1a"),Object(C["a"])(ve,se,oe,!1,null,"4cf02bed",null)),be=ge.exports,ye=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main"},[i("div",{staticClass:"main-title"},[i("span",[e._v("\n      审批设置\n    ")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.saveClick}},[e._v("\n      保存\n    ")])],1),e._v(" "),i("div",{staticClass:"main-body"},[i("div",{staticClass:"tip"},[e._v("如果不设置审批，考勤数据将无法关联审批数据。")]),e._v(" "),i("div",{staticClass:"title"},[e._v("请假审批")]),e._v(" "),i("el-form",{ref:"form",attrs:{model:e.fieldFrom,rules:e.fieldRules}},e._l(e.fieldList,(function(t,n){return i("el-form-item",{key:n,attrs:{label:t.name,prop:t.field}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:function(i){e.selcetChange(i,t.field)}},model:{value:e.fieldFrom[t.field],callback:function(i){e.$set(e.fieldFrom,t.field,i)},expression:"fieldFrom[item.field]"}},e._l(t.setting,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})))],1)})))],1)])},Te=[],Ce=(i("0481"),i("4069"),i("bcbc")),ke=i("ea20"),_e={name:"ExamineSet",components:{},mixins:[I["a"]],data:function(){return{loading:!1,fieldFrom:{},fieldRules:{},examineList:[],associatedFieldList:[]}},computed:{fieldList:function(){return[{name:"关联审批",field:"examineFieldId",formType:"select",setting:this.examineList,stylePercent:100,isNull:1},{name:"请假类型关联字段",field:"typeFieldId",formType:"select",setting:this.associatedFieldList,isNull:1},{name:"请假开始时间关联字段",field:"startTimeFieldId",formType:"select",setting:this.associatedFieldList,isNull:1},{name:"请假结束时间关联字段",field:"endTimeFieldId",formType:"select",setting:this.associatedFieldList,isNull:1},{name:"请假天数关联字段",field:"durationFieldId",formType:"select",setting:this.associatedFieldList,isNull:1},{name:"备注关联字段",field:"remarkFieldId",formType:"select",setting:this.associatedFieldList}]}},created:function(){this.getList(),this.getExamineList()},methods:{getList:function(){var e=this;this.loading=!0,this.getFieldRules(),Object(c["e"])().then((function(t){var i=t.data||{};if(!Object(X["c"])(i)){var n=i.examineFieldId;e.getExamineField(n),e.fieldFrom=i}e.loading=!1})).catch((function(){e.loading=!1}))},getExamineList:function(){var e=this;Object(Ce["j"])().then((function(t){var i=t.data.filter((function(e){return 0!=e.groupId}))||[];e.examineList=i.map((function(e){if(!Object(X["c"])(e.superExamineVOList))return e.superExamineVOList.map((function(e){return{label:e.examineName,value:e.examineId}}))})).flat()}))},getFieldRules:function(){var e=this;this.fieldList.forEach((function(t){t.isNull&&(e.fieldRules[t.field]=e.getRules(t))}))},getExamineField:function(e){var t=this,i=this.fieldFrom.examineFieldId,n=e||i;Object(ke["m"])({categoryId:n,type:1}).then((function(e){var i=e.data.filter((function(e){return e.fieldId}))||[];t.associatedFieldList=i.map((function(e){return{label:e.name,value:e.fieldId}}))}))},saveClick:function(){var e=this;this.loading=!0,this.fieldFrom.remarkFieldId=this.fieldFrom.remarkFieldId||"",this.$refs.form.validate((function(t){t?Object(c["d"])(e.fieldFrom).then((function(t){e.$message.success("保存成功"),e.loading=!1,e.getList()})).catch((function(){e.loading=!1})):(e.loading=!1,e.$message.error("请完善请假审批设置"))}))},selcetChange:function(e,t){"examineFieldId"==t&&(this.fieldFrom={examineFieldId:e},this.getExamineField())}}},Se=_e,we=(i("c5d2"),Object(C["a"])(Se,ye,Te,!1,null,"5b49873a",null)),Ie=we.exports,Ne={components:{XrHeader:r["a"],GroupSet:z,ClassesSet:re,DeductionRules:be,ExamineSet:Ie},data:function(){return{currentPage:1,pageSizes:[15,30,60,100],pageSize:P.a.get(W["i"])||15,total:0,menuList:[{tableName:"考勤组设置",tableId:0,componentName:"GroupSet"},{tableName:"班次设置",tableId:1,componentName:"ClassesSet"},{tableName:"扣款规则",tableId:2,componentName:"DeductionRules"},{tableName:"审批设置",tableId:3,componentName:"ExamineSet"}],menuIndex:0,search:""}},methods:{searchClick:function(e){this.search=e,this.$refs.componentRef.getList()},menuClick:function(e){var t=this;this.menuIndex=e,this.$refs.xrHeader.$data.search="",this.search="",this.$nextTick((function(){t.$refs.componentRef.getList()}))}}},Oe=Ne,xe=(i("02c3"),Object(C["a"])(Oe,n,a,!1,null,"7c7037b2",null));t["default"]=xe.exports},"3b3e":function(e,t,i){"use strict";i("fc34")},4069:function(e,t,i){var n=i("44d2");n("flat")},4118:function(e,t,i){e.exports={colorPrimary:"#0052cc",colorBlack:"#172b4d",colorSuccess:"#36b37e",colorWarning:"#ffab00",colorDanger:"#ff5630",colorN40:"#dfe1e6",axisLineColor:"#dfe1e6",axisLabelFontWeight:"500"}},"4e82":function(e,t,i){"use strict";var n=i("23e7"),a=i("e330"),r=i("59ed"),s=i("7b0b"),o=i("07fa"),l=i("083a"),c=i("577e"),u=i("d039"),d=i("addb"),f=i("a640"),h=i("04d1"),m=i("d998"),p=i("2d00"),v=i("512ce"),g=[],b=a(g.sort),y=a(g.push),T=u((function(){g.sort(void 0)})),C=u((function(){g.sort(null)})),k=f("sort"),_=!u((function(){if(p)return p<70;if(!(h&&h>3)){if(m)return!0;if(v)return v<603;var e,t,i,n,a="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(n=0;n<47;n++)g.push({k:t+n,v:i})}for(g.sort((function(e,t){return t.v-e.v})),n=0;n<g.length;n++)t=g[n].k.charAt(0),a.charAt(a.length-1)!==t&&(a+=t);return"DGBEFHACIJK"!==a}})),S=T||!C||!k||!_,w=function(e){return function(t,i){return void 0===i?-1:void 0===t?1:void 0!==e?+e(t,i)||0:c(t)>c(i)?1:-1}};n({target:"Array",proto:!0,forced:S},{sort:function(e){void 0!==e&&r(e);var t=s(this);if(_)return void 0===e?b(t):b(t,e);var i,n,a=[],c=o(t);for(n=0;n<c;n++)n in t&&y(a,t[n]);d(a,w(e)),i=o(a),n=0;while(n<i)t[n]=a[n++];while(n<c)l(t,n++);return t}})},"5b86":function(e,t,i){},"7f46":function(e,t,i){"use strict";i("1a38")},9373:function(e,t,i){},a2bf:function(e,t,i){"use strict";var n=i("e8b5"),a=i("07fa"),r=i("3511"),s=i("0366"),o=function(e,t,i,l,c,u,d,f){var h,m,p=c,v=0,g=!!d&&s(d,f);while(v<l)v in i&&(h=g?g(i[v],v,t):i[v],u>0&&n(h)?(m=a(h),p=o(e,t,h,m,p,u-1)-1):(r(p+1),e[p]=h),p++),v++;return p};e.exports=o},a447:function(e,t,i){"use strict";i("01b45")},a4a2:function(e,t,i){},aadd:function(e,t,i){"use strict";i("2050")},b900:function(e,t,i){"use strict";i("a4a2")},bcbc:function(e,t,i){"use strict";i.d(t,"j",(function(){return a})),i.d(t,"i",(function(){return r})),i.d(t,"d",(function(){return s})),i.d(t,"h",(function(){return o})),i.d(t,"k",(function(){return l})),i.d(t,"a",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"g",(function(){return d})),i.d(t,"f",(function(){return f})),i.d(t,"e",(function(){return h})),i.d(t,"b",(function(){return m}));var n=i("b775");function a(e){return Object(n["a"])({url:"/examineSuperExamines/applyList",method:"post",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function r(e){return Object(n["a"])({url:"/examineSuperExamine/examine/record/list",method:"post",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function s(e){return Object(n["a"])({url:"/examineRecord/forwardOthers",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(n["a"])({url:"/examineRecord/solicitOthers",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(n["a"])({url:"/examineSuperExamines/useExamineEmailSend",method:"post",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function c(e){return Object(n["a"])({url:"/oaSuperExamine/actionExamine",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(n["a"])({url:"/examineSuperExamines/set/node/optional",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(e){return Object(n["a"])({url:"/oaExamineField/queryUserField/".concat(e.categoryId),method:"post",data:e})}function f(e){return Object(n["a"])({url:"/jxcField/queryUserField/".concat(e.label),method:"post",data:e})}function h(e){return Object(n["a"])({url:"/jxcField/queryFieldList/".concat(e),method:"post"})}function m(e){return Object(n["a"])({url:"/crmField/queryFieldList/".concat(e),method:"post"})}},bd99:function(e,t,i){},c5d2:function(e,t,i){"use strict";i("9373")},cc78:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"el-input__inner range-time-picker"},[i("i",{staticClass:"el-input__icon el-icon-time"}),e._v(" "),i("el-select",{attrs:{disabled:e.disabled,placeholder:"请选择"},on:{change:e.hourChange},model:{value:e.hourNum,callback:function(t){e.hourNum=t},expression:"hourNum"}},e._l(e.hourOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))),e._v(" "),i("span",{staticClass:"division"},[e._v(":")]),e._v(" "),i("el-select",{attrs:{placeholder:"请选择",disabled:e.disabled},on:{change:e.minuteChange},model:{value:e.minuteNum,callback:function(t){e.minuteNum=t},expression:"minuteNum"}},e._l(e.minuteOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1)},a=[],r=(i("99af"),i("14d9"),{name:"RangeTimePicker",components:{},props:{value:String,selectableRange:{type:Array,default:function(){return["00:00","23:59"]}},disabled:{type:Boolean,default:!1}},data:function(){return{hourNum:0,hourOptions:[],minuteNum:0,minuteOptions:[]}},computed:{rangeConfig:function(){var e=(this.selectableRange[0]||"00:00").split(":"),t=(this.selectableRange[1]||"23:59").split(":");return{minHour:isNaN(parseInt(e[0]))?0:parseInt(e[0]),maxHour:isNaN(parseInt(t[0]))?0:parseInt(t[0]),minMinute:isNaN(parseInt(e[1]))?0:parseInt(e[1]),maxMinute:isNaN(parseInt(t[1]))?0:parseInt(t[1])}},currentValue:function(){return"".concat(this.fillZero(this.hourNum),":").concat(this.fillZero(this.minuteNum))}},watch:{selectableRange:{handler:function(){this.initHourOptions(),this.verifyValue(this.hourNum,this.minuteNum)?this.initMinuteOptions():(this.hourNum=this.rangeConfig.minHour,this.minuteNum=this.rangeConfig.minMinute,this.updateValue())},deep:!0},value:{handler:function(){this.compareValue()},immediate:!0},hourNum:{handler:function(){this.initMinuteOptions()},immediate:!0}},created:function(){this.initHourOptions()},mounted:function(){},beforeDestroy:function(){},methods:{compareValue:function(){if(this.value){var e=this.value.split(":"),t=parseInt(e[0]),i=parseInt(e[1]);this.verifyValue(t,i)?this.currentValue!==this.value&&(this.hourNum=t,this.minuteNum=i):(this.verifyValue(this.hourNum,this.minuteNum)||(this.hourNum=this.rangeConfig.minHour,this.minuteNum=this.rangeConfig.minMinute),this.updateValue())}},verifyValue:function(e,t){var i=parseInt("".concat(this.fillZero(e+24)).concat(this.fillZero(t))),n=parseInt("".concat(this.fillZero(this.rangeConfig.minHour+24)).concat(this.fillZero(this.rangeConfig.minMinute))),a=parseInt("".concat(this.fillZero(this.rangeConfig.maxHour+24)).concat(this.fillZero(this.rangeConfig.maxMinute)));return i>=n&&i<=a},hourChange:function(){if(this.hourNum===this.rangeConfig.minHour){var e=this.rangeConfig.minHour===this.rangeConfig.maxHour,t=e?this.rangeConfig.maxMinute:59;(this.minuteNum<this.rangeConfig.minMinute||this.minuteNum>t)&&(this.minuteNum=this.rangeConfig.minMinute)}else this.hourNum===this.rangeConfig.maxHour&&(this.minuteNum<0||this.minuteNum>this.rangeConfig.maxMinute)&&(this.minuteNum=0);this.updateValue(),this.$emit("change",this.currentValue)},minuteChange:function(){this.updateValue(),this.$emit("change",this.currentValue)},updateValue:function(){this.$emit("input",this.currentValue)},initHourOptions:function(){for(var e=[],t=this.rangeConfig.minHour;t<=this.rangeConfig.maxHour;t++)e.push(this.getNumItem(t));this.hourOptions=e},initMinuteOptions:function(){var e=[];if(this.hourNum===this.rangeConfig.minHour)for(var t=this.rangeConfig.minHour===this.rangeConfig.maxHour,i=t?this.rangeConfig.maxMinute:59,n=this.rangeConfig.minMinute;n<=i;n++)e.push(this.getNumItem(n,!1));else if(this.hourNum===this.rangeConfig.maxHour)for(var a=0;a<=this.rangeConfig.maxMinute;a++)e.push(this.getNumItem(a,!1));else for(var r=0;r<=59;r++)e.push(this.getNumItem(r,!1));this.minuteOptions=e},getNumItem:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var i,n=e,a=e;if(e<0)a=24+e,i=a<10?"昨日0".concat(a):"昨日".concat(a);else if(e<10)i="0".concat(a);else if(e>9&&e<=23)i="".concat(a);else if(e>23){var r=e-24;i=r<10?"次日0".concat(r):"次日".concat(r)}return{label:i,value:n}}return e<10?{label:"0".concat(e),value:e}:{label:"".concat(e),value:e}},fillZero:function(e){var t;if(e<0){var i=Math.abs(e);t=e<10?"-0".concat(i):"-".concat(i)}else t=e<10?"0".concat(e):e;return t}}}),s=r,o=(i("7f46"),i("2877")),l=Object(o["a"])(s,n,a,!1,null,"2e72dff3",null);t["a"]=l.exports},cccc:function(e,t,i){"use strict";i.d(t,"p",(function(){return a})),i.d(t,"s",(function(){return r})),i.d(t,"k",(function(){return s})),i.d(t,"o",(function(){return o})),i.d(t,"n",(function(){return l})),i.d(t,"r",(function(){return c})),i.d(t,"q",(function(){return u})),i.d(t,"t",(function(){return d})),i.d(t,"l",(function(){return f})),i.d(t,"m",(function(){return h})),i.d(t,"i",(function(){return m})),i.d(t,"j",(function(){return p})),i.d(t,"D",(function(){return v})),i.d(t,"F",(function(){return g})),i.d(t,"G",(function(){return b})),i.d(t,"E",(function(){return y})),i.d(t,"J",(function(){return T})),i.d(t,"K",(function(){return C})),i.d(t,"H",(function(){return k})),i.d(t,"I",(function(){return _})),i.d(t,"v",(function(){return S})),i.d(t,"w",(function(){return w})),i.d(t,"x",(function(){return I})),i.d(t,"y",(function(){return N})),i.d(t,"z",(function(){return O})),i.d(t,"C",(function(){return x})),i.d(t,"c",(function(){return R})),i.d(t,"h",(function(){return F})),i.d(t,"N",(function(){return j})),i.d(t,"b",(function(){return M})),i.d(t,"B",(function(){return $})),i.d(t,"g",(function(){return A})),i.d(t,"M",(function(){return L})),i.d(t,"A",(function(){return E})),i.d(t,"f",(function(){return P})),i.d(t,"L",(function(){return W})),i.d(t,"a",(function(){return D})),i.d(t,"u",(function(){return H})),i.d(t,"e",(function(){return V})),i.d(t,"d",(function(){return z}));var n=i("b775");function a(e){return Object(n["a"])({url:"hrmConfig/queryRecruitChannelList",method:"post",data:e})}function r(e){return Object(n["a"])({url:"hrmConfig/saveRecruitChannel",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(e){return Object(n["a"])({url:"hrmConfig/deleteRecruitChannel",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(n["a"])({url:"hrmConfig/queryFields",method:"post",data:e})}function l(e){return Object(n["a"])({url:"hrmConfig/queryFieldByLabel/".concat(e),method:"post"})}function c(e){return Object(n["a"])({url:"hrmConfig/saveField",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(n["a"])({url:"hrmConfig/queryRecruitEliminateList",method:"post",data:e})}function d(e){return Object(n["a"])({url:"hrmConfig/saveRecruitEliminate",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(e){return Object(n["a"])({url:"hrmConfig/queryInsuranceSchemePageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function h(e){return Object(n["a"])({url:"hrmConfig/queryInsuranceSchemeById/".concat(e),method:"post"})}function m(e){return Object(n["a"])({url:"hrmConfig/addInsuranceScheme",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function p(e){return Object(n["a"])({url:"hrmConfig/deleteInsuranceScheme/".concat(e),method:"post"})}function v(e){return Object(n["a"])({url:"hrmSalaryGroup/addSalaryGroup",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function g(e){return Object(n["a"])({url:"hrmSalaryGroup/querySalaryGroupPageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function b(e){return Object(n["a"])({url:"hrmSalaryGroup/setSalaryGroup",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function y(e){return Object(n["a"])({url:"hrmSalaryGroup/delete/".concat(e),method:"post"})}function T(e){return Object(n["a"])({url:"hrmSalaryTaxRule/queryTaxRuleList",method:"post",data:e})}function C(e){return Object(n["a"])({url:"hrmSalaryTaxRule/setTaxRule",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function k(e){return Object(n["a"])({url:"hrmSalaryOption/querySalaryOptionDetail",method:"post",data:e})}function _(e){return Object(n["a"])({url:"hrmSalaryOption/setSalaryOption",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function S(){return Object(n["a"])({url:"hrmEmployeeArchives/queryEmployeeArchivesField",method:"post"})}function w(e){return Object(n["a"])({url:"hrmEmployeeArchives/sendWriteArchives",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function I(e){return Object(n["a"])({url:"hrmEmployeeArchives/setEmployeeArchivesField",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function N(e){return Object(n["a"])({url:"hrmEmployeeFieldManage/queryEmployeeManageField",method:"post",data:e})}function O(e){return Object(n["a"])({url:"hrmEmployeeFieldManage/setEmployeeManageField",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function x(e){return Object(n["a"])({url:"hrmAttendanceShift/queryAttendanceShiftPageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function R(e){return Object(n["a"])({url:"hrmAttendanceShift/".concat(e.shiftId?"setAttendanceShift":"addAttendanceShift"),method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function F(e){return Object(n["a"])({url:"hrmAttendanceShift/delete/".concat(e.attendanceShiftId),method:"post",data:e})}function j(e){return Object(n["a"])({url:"hrmAttendanceShift/verifyAttendanceShiftName",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function M(e){return Object(n["a"])({url:"hrmAttendanceRule/".concat(e.attendanceRuleId?"setAttendanceRule":"addAttendanceRule"),method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function $(e){return Object(n["a"])({url:"hrmAttendanceRule/queryAttendanceRulePageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function A(e){return Object(n["a"])({url:"hrmAttendanceRule/delete/".concat(e.attendanceRuleId),method:"post",data:e})}function L(e){return Object(n["a"])({url:"hrmAttendanceRule/verifyAttendanceRuleName",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function E(e){return Object(n["a"])({url:"hrmAttendanceGroup/queryAttendanceGroupPageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function P(e){return Object(n["a"])({url:"hrmAttendanceGroup/delete/".concat(e.attendanceGroupId),method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function W(e){return Object(n["a"])({url:"hrmAttendanceGroup/verifyAttendanceGroupName",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function D(e){return Object(n["a"])({url:"hrmAttendanceGroup/addAttendanceGroup",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function H(e){return Object(n["a"])({url:"hrmAttendanceGroup/setAttendanceGroup",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function V(e){return Object(n["a"])({url:"hrmAttendanceExamine/queryHrmAttendanceExamine",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function z(e){return Object(n["a"])({url:"hrmAttendanceExamine/add",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}},dbb1:function(e,t,i){},e1de:function(e,t,i){"use strict";i("5b86")},fc34:function(e,t,i){}}]);