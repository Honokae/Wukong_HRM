(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1057cac8"],{"0677":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"opacity-fade"}},[a("div",{staticClass:"business-approve-flow-create"},[a("wk-backgroud-tabs",[a("template",{slot:"left"},[a("span",[e._v(e._s(e.title)+"KPI指标模板")])]),e._v(" "),a("template",{slot:"right"},[a("el-button",{attrs:{type:"primary"},on:{click:e.sendClick}},[e._v("保存")]),e._v(" "),a("i",{staticClass:"el-icon-close create-close",on:{click:e.closeClick}})],1)],2),e._v(" "),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"base-info-set",staticStyle:{padding:"0 20px",overflow:"auto"}},[a("create-sections",{staticClass:"form-sections",attrs:{title:"基本信息"}},[a("el-form",{ref:"baseInfoSet",attrs:{model:e.fieldsForm,"label-position":"top",rules:e.fieldsRules}},[a("wk-form-items",{attrs:{"field-from":e.fieldsForm,"field-list":e.fields},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data;return[i&&"radioType"==i.formType?a("el-radio",{attrs:{label:1},model:{value:e.fieldsForm[i.fieldName],callback:function(t){e.$set(e.fieldsForm,i.fieldName,t)},expression:"fieldsForm[data.fieldName]"}},[e._v("\n                加权计算\n                "),a("span",{staticStyle:{"font-size":"12px",color:"#5e6c84"}},[e._v("总分=评分 X 维度权重 X 指标权重，再累加")])]):e._e(),e._v(" "),i&&"integer"==i.formType?a("el-input",{attrs:{placeholder:""},on:{input:function(t){e.fieldsForm[i.fieldName]=e.fieldsForm[i.fieldName].replace(/[^\d]/g,"")}},model:{value:e.fieldsForm[i.fieldName],callback:function(t){e.$set(e.fieldsForm,i.fieldName,t)},expression:"fieldsForm[data.fieldName]"}}):e._e()]}}])})],1)],1),e._v(" "),a("create-sections",{attrs:{title:"考核维度"}},[a("div",{staticClass:"other"},[a("span",[e._v("\n            当前维度权重合计:\n            "),a("span",{style:e.dimensionWeightSum>100?"color:red":"color:#ffb55f"},[e._v("\n              "+e._s(e.dimensionWeightSum)),"--"!=e.dimensionWeightSum?a("span",[e._v("%")]):e._e()])]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.examineShow=!0}}},[e._v("\n            新增考核维度\n          ")])],1),e._v(" "),e.assessmentDimensionList&&e.assessmentDimensionList.length>0?a("assessment-dimension",{ref:"assessmentForm",attrs:{"assessment-dimension-list":e.assessmentDimensionList,"quota-item":e.quotaItem},on:{editAssess:e.editAssess}}):e._e()],1)],1),e._v(" "),e.examineShow?a("el-dialog",{attrs:{title:"create"==e.examineType?"新建考核维度":"编辑考核维度",width:"900",visible:e.examineShow,"append-to-body":"","custom-class":"drawer","before-close":e.close},on:{"update:visible":function(t){e.examineShow=t}}},[a("el-form",{ref:"examineForm",attrs:{model:e.examineFieldsForm,"label-position":"top",rules:e.examineFieldsRules}},[a("wk-form-items",{attrs:{"field-from":e.examineFieldsForm,"field-list":e.examineFields},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data;return[i&&"check"==i.formType?a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.examineFieldsForm[i.fieldName],callback:function(t){e.$set(e.examineFieldsForm,i.fieldName,t)},expression:"examineFieldsForm[data.fieldName]"}},[e._v("允许员工填写 勾选后，员工在制定指标时可以为当前考核维度添加指标")]):e._e()]}}])})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.examineShow=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.examineCreate}},[e._v("确 定")])],1)],1):e._e()],1)])},s=[],n=a("5530"),l=a("2909"),r=(a("d3b7"),a("159b"),a("b64b"),a("14d9"),a("a434"),a("e9c4"),a("4de4"),a("e2cc")),o=a("215e"),m=a("10ff"),u=a("4378"),d=a("05b4"),f=a("0730"),c=a("2046"),p={name:"KpiTemplateCreate",components:{WkBackgroudTabs:u["a"],WkFormItems:o["default"],AssessmentDimension:d["a"],CreateSections:m["a"]},mixins:[f["a"],c["a"]],props:{indicatorTemplate:Object},data:function(){return{loading:!1,height:document.documentElement.clientHeight-100,fields:[],fieldsForm:{},fieldsRules:{},examineFields:[],examineFieldsForm:{},examineFieldsRules:{},examineShow:!1,quoteTypeList:[],assessmentDimensionList:[],quotaItem:{},examineType:"create",examineIndex:void 0}},computed:{dimensionWeightSum:function(){var e=0;return this.assessmentDimensionList&&!this.assessmentDimensionList.length?"--":(this.assessmentDimensionList.forEach((function(t){e+=t.dimensionWeight})),e)},title:function(){return this.fieldsForm.templateId?"编辑":"新建"}},watch:{examineShow:function(e){e||(this.examineFieldsForm={quotaType:1})}},created:function(){this.getTypeList(),this.getField()},methods:{getField:function(){var e=this;if(this.fields=[{name:"考核模板名称",fieldName:"templateName",field:"templateName",formType:"text",isNull:1,stylePercent:100},{name:"考核指标说明",fieldName:"templateIllustrate",field:"templateIllustrate",formType:"textarea",stylePercent:100},{name:"总分计算",fieldName:"scoreCalculation",field:"scoreCalculation",formType:"radioType",value:"1",setting:["加权计算"],isNull:1,stylePercent:100},{name:"评分上限类型",fieldName:"upperLimitType",field:"upperLimitType",formType:"select",setting:[{label:"统一上限",value:1}],isNull:1,value:1,stylePercent:100},{name:"评分上限",fieldName:"upperLimitScore",field:"upperLimitScore",formType:"integer",value:100,min:0,isNull:1,stylePercent:100}],this.examineFields=[{name:"维度名称",fieldName:"dimensionName",field:"dimensionName",formType:"text",isNull:1,stylePercent:50},{name:"指标类型",fieldName:"quotaType",field:"quotaType",formType:"select",isNull:1,setting:this.quoteTypeList,value:1,stylePercent:50},{name:"维度权重",fieldName:"dimensionWeight",field:"dimensionWeight",formType:"percent",isNull:1,max:100,min:0,stylePercent:50},{name:"备注",fieldName:"remarks",field:"remarks",formType:"textarea",maxlength:200,stylePercent:50},{name:"",fieldName:"isAllowEdit",field:"isAllowEdit",formType:"check"}],Object.keys(this.indicatorTemplate).length){this.loading=!0;var t={};for(var a in this.indicatorTemplate)this.fields.forEach((function(i){a==i.fieldName&&(t[i.fieldName]=e.indicatorTemplate[a],t["templateId"]=e.indicatorTemplate.templateId)}));for(var i in this.fieldsForm=t,this.indicatorTemplate["dimensionVOList"].forEach((function(t,a){var i;e.quotaItem["table"+t.templateId+a]=[],e.assessmentDimensionList.push({dimensionName:t.dimensionName,quotaType:t.quotaType,dimensionWeight:t.dimensionWeight,remarks:t.remarks,isAllowEdit:t.isAllowEdit,key:t.templateId+a}),(i=e.quotaItem["table"+t.templateId+a]).push.apply(i,Object(l["a"])(t.achievementsQuotaVOList))})),this.quotaItem)this.quotaItem[i].push({});this.loading=!1}else this.fieldsForm={scoreCalculation:1,upperLimitType:1,upperLimitScore:100},this.examineFieldsForm={quotaType:1};this.fields.forEach((function(t){e.fieldsRules[t.fieldName]=e.getRules(t)})),this.examineFields.forEach((function(t){e.examineFieldsRules[t.fieldName]=e.getRules(t)})),this.fieldsRules.templateIllustrate.push({max:200,message:"最多输入200个字符",trigger:"change"}),this.fieldsRules.templateName.push({max:50,message:"最多输入50个汉字、英文、数字",trigger:["blur","change"]}),this.examineFieldsRules.dimensionName.push({max:50,message:"最多输入50个汉字、英文、数字",trigger:["blur","change"]})},getTypeList:function(){var e=this;Object(r["e"])().then((function(t){t.data.forEach((function(t){e.quoteTypeList.push({label:t.quoteTypeName,value:t.quoteType})}))}))},examineCreate:function(){var e=this;this.$refs.examineForm.validate((function(t){t?"update"==e.examineType?(e.assessmentDimensionList.splice(e.examineIndex,1,JSON.parse(JSON.stringify(e.examineFieldsForm))),e.examineShow=!1,e.examineType="create"):(e.examineFieldsForm.key=+new Date,e.assessmentDimensionList.push(e.examineFieldsForm),e.examineShow=!1):e.$message.error("请完善考核维度信息")}))},close:function(){this.examineShow=!1},editAssess:function(e){this.examineShow=!0,this.examineIndex=e,this.examineType="update",this.examineFieldsForm=JSON.parse(JSON.stringify(this.assessmentDimensionList[e]))},sendClick:function(){var e=this,t=!0,a=!0,i=!0,s=!0;this.$refs.baseInfoSet.validate((function(l){if(e.$refs.assessmentForm&&e.$refs.assessmentForm.$refs.form){for(var r in e.$refs.assessmentForm.tableForm)1==e.$refs.assessmentForm.tableForm[r].length&&(a=!1),e.assessmentDimensionList.forEach((function(t){if(!t.isAllowEdit){var a=0;e.$refs.assessmentForm.tableForm["table"+t.key].forEach((function(e){a+=e.quotaWeight||0})),100!=a&&(i=!1)}}));var o=[];e.$refs.assessmentForm.$refs.form.forEach((function(n){n.validate((function(n){if(!(n&&l&&a&&i)&&(s=!1,t)){var r=a?i?"请完善信息":"指标权重总和需等于100%":"至少添加一条指标项";e.$message.error(r),t=!1}}))})),l&&a&&i&&s&&(e.assessmentDimensionList.forEach((function(t,a){o.push(Object(n["a"])(Object(n["a"])({},t),{},{achievementsPointBOList:e.$refs.assessmentForm.tableForm["table"+t.key].filter((function(e){return Object.keys(e).length}))}))})),e.submiteRequest(Object(n["a"])(Object(n["a"])({},e.fieldsForm),{achievementsDimensionBOList:o})))}else l?e.submiteRequest(Object(n["a"])({},e.fieldsForm)):e.$message.error("请完善信息")}))},submiteRequest:function(e){var t=this;this.loading=!0;var a=e.templateId?r["f"]:r["a"],i=e.templateId?"修改成功":"创建成功";a(e).then((function(e){t.loading=!1,t.$message.success(i),t.closeClick(),t.$emit("createEditSuccess")})).catch((function(){t.loading=!1}))},closeClick:function(){this.$emit("close")}}},g=p,h=(a("c834"),a("2877")),b=Object(h["a"])(g,i,s,!1,null,"5af2fa22",null);t["a"]=b.exports},4378:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flexbox",{staticClass:"wk-backgroud-tabs",staticStyle:{width:"auto"},attrs:{justify:"space-between",align:"center"}},[a("flexbox",{staticStyle:{"z-index":"1",width:"auto"},attrs:{align:"center"}},[e._t("left")],2),e._v(" "),a("div",{staticClass:"wk-tabs__wrap"},[a("div",{staticClass:"wk-tabs"},e._l(e.options,(function(t,i){return a("div",{key:i,staticClass:"wk-tabs__item",class:{active:t.value===e.value},on:{click:function(a){e.tabsClick(t,i)}}},[e._v("\n        "+e._s(t.label)),t.helpType?a("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":t.helpType,"data-id":t.helpId},on:{click:function(e){e.stopPropagation()}}}):e._e()])})))]),e._v(" "),a("flexbox",{staticStyle:{"z-index":"1",width:"auto"},attrs:{align:"center"}},[e._t("right")],2)],1)},s=[],n=(a("a9e3"),{name:"WkBackgroudTabs",components:{},props:{value:[String,Number],options:Array},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{tabsClick:function(e,t){this.$emit("input",e.value),this.$emit("tab-click",e,t)}}}),l=n,r=(a("a548"),a("2877")),o=Object(r["a"])(l,i,s,!1,null,"8ec15ab4",null);t["a"]=o.exports},"8b13":function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"g",(function(){return b})),a.d(t,"a",(function(){return T})),a.d(t,"f",(function(){return k})),a.d(t,"d",(function(){return $})),a.d(t,"e",(function(){return R})),a.d(t,"b",(function(){return J}));a("b64b"),a("d81d"),a("d9e2"),a("14d9"),a("99af");var i=a("ed08"),s=a("6bfe"),n=a("7078"),l=a("0f4c");function r(e){var t=Object.keys(e);return t.map((function(t){return{label:e[t],value:parseInt(t)}}))}var o=[{name:"学历",field:"education",formType:"select",setting:[{label:"小学",value:1},{label:"初中",value:2},{label:"中专",value:3},{label:"中职",value:4},{label:"中技",value:5},{label:"高中",value:6},{label:"大专",value:7},{label:"本科",value:8},{label:"硕士",value:9},{label:"博士",value:10},{label:"博士后",value:11},{label:"其他",value:12}]},{name:"毕业院校",field:"graduateSchool",formType:"text",setting:[]},{name:"专业",field:"major",formType:"text",setting:[]},{name:"入学时间",field:"admissionTime",formType:"date",setting:[]},{name:"毕业时间",field:"graduationTime",formType:"date",setting:[]},{name:"教学方式",field:"teachingMethods",formType:"select",setting:[{label:"全日制",value:1},{label:"成人教育",value:2},{label:"远程教育",value:3},{label:"自学考试",value:4},{label:"其他",value:5}]},{name:"是否第一学历",field:"isFirstDegree",formType:"radio",setting:[{label:"否",value:0},{label:"是",value:1}]}],m={1:"小学",2:"初中",3:"中专",4:"中职",5:"中技",6:"高中",7:"大专",8:"本科",9:"硕士",10:"博士",11:"博士后",12:"其他"},u={1:"全日制",2:"成人教育",3:"远程教育",4:"自学考试",5:"其他"},d={1:"是",0:"否"},f={education:[{required:!0,message:"请选择",trigger:["blur","change"]}],graduateSchool:[{required:!0,message:"请输入",trigger:["blur","change"]}],major:[{required:!0,message:"请输入",trigger:["blur","change"]}],isFirstDegree:[{required:!0,message:"请选择",trigger:["blur","change"]}]},c={fields:o,rules:f,educationValue:m,teachingMethodsValue:u,isFirstDegreeValue:d},p=[{name:"工作单位",field:"workUnit",formType:"text",setting:[]},{name:"职务",field:"post",formType:"text",setting:[]},{name:"工作开始时间",field:"workStartTime",formType:"date",setting:[]},{name:"工作结束时间",field:"workEndTime",formType:"date",setting:[]},{name:"离职原因",field:"leavingReason",formType:"text",setting:[]},{name:"证明人",field:"witness",formType:"text",setting:[]},{name:"证明人电话",field:"witnessPhone",formType:"mobile",setting:[]},{name:"工作备注",field:"workRemarks",formType:"text",setting:[]}],g=function(e,t,a){Object(s["c"])(t)||Object(i["B"])(t)?a():a(new Error("手机格式有误"))},h={workUnit:[{required:!0,message:"请输入",trigger:["blur","change"]}],post:[{required:!0,message:"请输入",trigger:["blur","change"]}],witnessPhone:[{validator:g,trigger:["blur","change"]}]},b={fields:p,rules:h},v=[{name:"证书名称",field:"certificateName",formType:"text",setting:[]},{name:"证书级别",field:"certificateLevel",formType:"text",setting:[]},{name:"证书/证件编号",field:"certificateNum",formType:"text",setting:[]},{name:"有效期起始日期",field:"startTime",formType:"date",setting:[]},{name:"有效期到期日",field:"endTime",formType:"date",setting:[]},{name:"发证机构",field:"issuingAuthority",formType:"text",setting:[]},{name:"发证日期",field:"issuingTime",formType:"date",setting:[]},{name:"证件备注",field:"remarks",formType:"text",setting:[]}],y={certificateName:[{required:!0,message:"请输入",trigger:["blur","change"]}]},T={fields:v,rules:y},x=[{name:"培训课程",field:"trainingCourse",formType:"text",setting:[]},{name:"培训机构名称",field:"trainingOrganName",formType:"text",setting:[]},{name:"培训开始时间",field:"startTime",formType:"date",setting:[]},{name:"培训结束时间",field:"endTime",formType:"date",setting:[]},{name:"培训时长",field:"trainingDuration",formType:"number",setting:[]},{name:"培训成绩",field:"trainingResults",formType:"text",setting:[]},{name:"培训证书名称",field:"trainingCertificateName",formType:"text",setting:[]},{name:"培训备注",field:"remarks",formType:"textarea",setting:[]}],F={trainingCourse:[{required:!0,message:"请输入",trigger:["blur","change"]}]},k={fields:x,rules:F},w={1:"男",2:"女"},N={1:"阳历",2:"农历"},_=[{label:"男",value:1},{label:"女",value:2}],S={1:"身份证",2:"港澳通行证",3:"台湾通行证",4:"护照",5:"其他"},q=[{label:"身份证",value:1},{label:"港澳通行证",value:2},{label:"台湾通行证",value:3},{label:"护照",value:4},{label:"其他",value:5}],L={1:"正式",2:"非正式"},C=[{label:"正式",value:1},{label:"非正式",value:2}],O={0:"无试用期",1:"1个月",2:"2个月",3:"3个月",4:"4个月",5:"5个月",6:"6个月"},j=[{label:"无试用期",value:0},{label:"1个月",value:1},{label:"2个月",value:2},{label:"3个月",value:3},{label:"4个月",value:4},{label:"5个月",value:5},{label:"6个月",value:6}],I=[{label:"实习",value:3},{label:"兼职",value:4},{label:"劳务",value:5},{label:"顾问",value:6},{label:"返聘",value:7},{label:"外包",value:8}],A={1:"正式",2:"试用",3:"实习",4:"兼职",5:"劳务",6:"顾问",7:"返聘",8:"外包",11:"在职",12:"全职",13:"待入职",14:"待离职",15:"已离职"},D={1:"正式",2:"试用",3:"实习",4:"兼职",5:"劳务",6:"顾问",7:"返聘",8:"外包"},$={sexValue:w,birthdayTypeValue:N,idTypeValue:S,employmentFormsValue:L,probationValue:O,statusValue:A,validStatusValue:D,getValueList:r,sexSetting:_,idTypeSetting:q,employmentFormsSetting:C,probationSetting:j,statusSetting:I},E=[{name:"部门",field:"newDept",formType:"structure",props:{dataType:"hrm"},request:l["e"],setting:[]},{name:"岗位",field:"newPost",formType:"text",setting:[]},{name:"直属上级",field:"newParentId",formType:"user",props:{label:"employeeName",value:"employeeId",isList:!0},request:n["F"],setting:[]},{name:"计划转正日期",field:"becomeTime",formType:"text",disabled:!0,setting:[]},{name:"实际转正日期",field:"effectTime",formType:"date",setting:[]},{name:"备注",field:"remarks",formType:"textarea",setting:[]}],P={effectTime:[{required:!0,message:"请选择",trigger:["blur","change"]}]},R={fields:E,rules:P};function W(e,t){var a=[{label:"调岗",value:5},{label:"晋升",value:6},{label:"降级",value:7}];3!=t&&4!=t||a.push({label:"转为全职员工",value:8});var i=[];i=7==e?[{label:"违规违纪",value:4},{label:"绩效不达标",value:5},{label:"个人身体原因",value:6},{label:"不适应当前岗位",value:7}]:[{label:"组织架构调整",value:1},{label:"个人申请",value:2},{label:"工作安排",value:3}];var s=[{name:"异动类型",field:"changeType",formType:"select",setting:a},{name:"异动原因",field:"changeReason",formType:"select",setting:i}];return 8==e&&(s=s.concat([{name:"入职日期",field:"entryTime",formType:"date",disabled:!0,setting:[]},{name:"试用期",field:"probation",formType:"select",setting:[{label:"无试用期",value:0},{label:"1个月",value:1},{label:"2个月",value:2},{label:"3个月",value:3},{label:"4个月",value:4},{label:"5个月",value:5},{label:"6个月",value:6}]}])),s.concat([{name:"原部门",field:"oldDept",formType:"structure",disabled:!0,props:{dataType:"hrm"},request:l["e"],setting:[]},{name:"变更为",field:"newDept",formType:"structure",props:{dataType:"hrm"},request:l["e"],setting:[]},{name:"原岗位",field:"oldPost",formType:"text",disabled:!0,setting:[]},{name:"变更为",field:"newPost",formType:"text",setting:[]},{name:"原岗位职级",field:"oldPostLevel",disabled:!0,formType:"text",setting:[]},{name:"变更为",field:"newPostLevel",formType:"text",setting:[]},{name:"原工作地点",field:"oldWorkAddress",formType:"text",disabled:!0,setting:[]},{name:"变更为",field:"newWorkAddress",formType:"text",setting:[]},{name:"生效日期",field:"effectTime",formType:"date",setting:[]},{name:"备注",field:"remarks",formType:"textarea",setting:[]}])}var V={effectTime:[{required:!0,message:"请选择",trigger:["blur","change"]}]},J={fieldsFunc:W,rules:V}},a548:function(e,t,a){"use strict";a("c5f1")},c408:function(e,t,a){},c5f1:function(e,t,a){},c834:function(e,t,a){"use strict";a("c408")},e2cc:function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return n})),a.d(t,"f",(function(){return l})),a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return m}));var i=a("b775");function s(e){return Object(i["a"])({url:"hrmAchievementsAssessmentTemplate/queryPageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function n(e){return Object(i["a"])({url:"hrmAchievementsAssessmentTemplate/saveTemplate",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(i["a"])({url:"/hrmAchievementsAssessmentTemplate/updateTemplate",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(e){return Object(i["a"])({url:"/hrmAchievementsAssessmentTemplate/delTemplate",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(i["a"])({url:"hrmAchievementsAssessmentTemplate/quoteTypeList",method:"post",data:e})}function m(e){return Object(i["a"])({url:"/hrmAchievementsAssessmentTemplate/information/".concat(e),method:"post",data:e})}}}]);